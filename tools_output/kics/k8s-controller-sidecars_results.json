{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 63,
	"files_parsed": 1,
	"lines_parsed": 57,
	"lines_ignored": 6,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 0,
		"INFO": 0,
		"LOW": 0,
		"MEDIUM": 2,
		"TRACE": 0
	},
	"total_counter": 2,
	"total_bom_resources": 0,
	"start": "2024-06-26T03:33:18.480238+02:00",
	"end": "2024-06-26T03:33:20.534386+02:00",
	"paths": [
		"templates/k8s-controller-sidecars_template.yaml",
		"/usr/local/opt/kics/share/kics/assets/queries"
	],
	"queries": [
		{
			"query_name": "RBAC Roles with Exec Permission",
			"query_id": "c589f42c-7924-4871-aee2-1cede9bc7cbc",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Roles or ClusterRoles with RBAC permissions to run commands in containers via 'kubectl exec' could be abused by attackers to execute malicious code in case of compromise. To prevent this, the 'pods/exec' verb should not be used in production environments",
			"description_id": "c589f42c",
			"files": [
				{
					"file_name": "templates/k8s-controller-sidecars_template.yaml",
					"similarity_id": "f0452e13e6be54ded44a24138da955b252034043d001eda18c32455d3aa63e11",
					"line": 47,
					"resource_type": "ClusterRole",
					"resource_name": "sidecar-job-controller-exec",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{sidecar-job-controller-exec}}.rules",
					"search_line": 47,
					"search_value": "",
					"expected_value": "metadata.name={{sidecar-job-controller-exec}}.rules[0].resources should not include the 'pods/exec' resource",
					"actual_value": "metadata.name={{sidecar-job-controller-exec}}.rules[0].resources includes the 'pods/exec' resource"
				}
			]
		},
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/k8s-controller-sidecars_template.yaml",
					"similarity_id": "e6a9e891f82a3a30854338285f78ed67736b2e6c2577a1a48744c56dc24d66d4",
					"line": 28,
					"resource_type": "ServiceAccount",
					"resource_name": "sidecar-job-controller",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{sidecar-job-controller}}",
					"search_line": 28,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				}
			]
		}
	]
}
