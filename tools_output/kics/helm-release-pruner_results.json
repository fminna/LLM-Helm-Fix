{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 131,
	"files_parsed": 1,
	"lines_parsed": 125,
	"lines_ignored": 6,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 5,
		"INFO": 0,
		"LOW": 6,
		"MEDIUM": 7,
		"TRACE": 0
	},
	"total_counter": 18,
	"total_bom_resources": 0,
	"start": "2024-06-26T00:30:26.145648+02:00",
	"end": "2024-06-26T00:30:28.088408+02:00",
	"paths": [
		"/usr/local/opt/kics/share/kics/assets/queries",
		"templates/helm-release-pruner_template.yaml"
	],
	"queries": [
		{
			"query_name": "Tiller (Helm v2) Is Deployed",
			"query_id": "6d173be7-545a-46c6-a81d-2ae52ed1605d",
			"query_url": "https://kubernetes.io/docs/concepts/containers/images/",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Check if Tiller is deployed.",
			"description_id": "b0a009b5",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "1ae766aaa6ec655e6be0679b53a3c09c45abe782b84b7a3a217ebc4944e3b5f6",
					"line": 42,
					"resource_type": "Role",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'metadata' of Role should not refer to any Tiller resource",
					"actual_value": "'metadata' of Role refers to a Tiller resource"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "1ae766aaa6ec655e6be0679b53a3c09c45abe782b84b7a3a217ebc4944e3b5f6",
					"line": 42,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'metadata' of RoleBinding should not refer to any Tiller resource",
					"actual_value": "'metadata' of RoleBinding refers to a Tiller resource"
				}
			]
		},
		{
			"query_name": "Tiller Service Is Not Deleted",
			"query_id": "8b862ca9-0fbd-4959-ad72-b6609bdaa22d",
			"query_url": "https://kubernetes.io/docs/concepts/services-networking/service",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Check if there is any Tiller Service present",
			"description_id": "4e704117",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "09e5236feb130fc8544453c3b8281bcd243ac1ee04a1182e8ebceb35141f13bf",
					"line": 42,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name of RoleBinding should not contain 'tiller'",
					"actual_value": "metadata.name of RoleBinding contains 'tiller'"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "09e5236feb130fc8544453c3b8281bcd243ac1ee04a1182e8ebceb35141f13bf",
					"line": 42,
					"resource_type": "Role",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name of Role should not contain 'tiller'",
					"actual_value": "metadata.name of Role contains 'tiller'"
				}
			]
		},
		{
			"query_name": "Volume Mount With OS Directory Write Permissions",
			"query_id": "b7652612-de4e-4466-a0bf-1cd81f0c6063",
			"query_url": "https://kubernetes.io/docs/concepts/storage/volumes/",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries.",
			"description_id": "e42b7901",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "db44bdbebb08cd66391a0c971939d277d60842d6fac3e0672ddfeb3e6d3dc5d6",
					"line": 106,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.volumeMounts.name={{config}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.volumeMounts.name={{config}}.readOnly should be defined and set to true",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.volumeMounts.name={{config}}.readOnly is undefined"
				}
			]
		},
		{
			"query_name": "RBAC Roles with Port-Forwarding Permission",
			"query_id": "38fa11ef-dbcc-4da8-9680-7e1fd855b6fb",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Roles or ClusterRoles with RBAC permissions to port-forward into pods can open socket-level communication channels to containers. In case of compromise, attackers may abuse this for direct communication that bypasses network security restrictions",
			"description_id": "38fa11ef",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "38fdd0bebb91a51155aa66e2dab1fb00fe8a8238138142ce0062317566502716",
					"line": 47,
					"resource_type": "Role",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}.rules",
					"search_line": 47,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.rules[0].resources should not include the 'pods/portforward' resource",
					"actual_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.rules[0].resources includes the 'pods/portforward' resource"
				}
			]
		},
		{
			"query_name": "Seccomp Profile Is Not Configured",
			"query_id": "f377b83e-bd07-4f48-a591-60c82b14a78b",
			"query_url": "https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls",
			"description_id": "d943c7e7",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "12f6f24c38e754cc5cbd6cea58078677932a8163842fe53e22bc963a4077d9c1",
					"line": 111,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.containers.name={{helm-release-pruner}}.securityContext.seccompProfile.type is undefined"
				}
			]
		},
		{
			"query_name": "Service Account Token Automount Not Disabled",
			"query_id": "48471392-d4d0-47c0-b135-cdec95eb3eef",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Defaults",
			"experimental": false,
			"description": "Service Account Tokens are automatically mounted even if not necessary",
			"description_id": "51cade0f",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "b3cabda17d8b3e0678cae751cf9c3fa4c80530a8e88cc19d0352d311088749aa",
					"line": 96,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.spec.automountServiceAccountToken is undefined"
				}
			]
		},
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "6da7878077dc4c1a53976921c39692ae6269c99a07fabc1063f065ed87e09ef9",
					"line": 43,
					"resource_type": "Role",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}.namespace",
					"search_line": 43,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to kube-system"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "ad94ad5301741eda78bcab39a70e1a7cb2617544e1acbdc63c7f060feb581df9",
					"line": 77,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{CronJob}}.metadata.name={{release-name-helm-release-pruner}}",
					"search_line": 77,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "400f6dc4cd112714683ac627622b291d4028cdc32d425be30428e558e006056f",
					"line": 6,
					"resource_type": "ConfigMap",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ConfigMap}}.metadata.name={{release-name-helm-release-pruner}}",
					"search_line": 6,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "929066354a87a485dd81723a61437ba3434df5cf452c6cee32ccd8a94b83c671",
					"line": 63,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-helm-release-pruner-tiller}}.namespace",
					"search_line": 63,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to kube-system"
				}
			]
		},
		{
			"query_name": "Missing AppArmor Profile",
			"query_id": "8b36775e-183d-4d46-b0f7-96a6f34a723f",
			"query_url": "https://kubernetes.io/docs/tutorials/clusters/apparmor/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources",
			"description_id": "59c17c0a",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "798dd02fdaba9e2e94ab3990829683992bcb98b4711a9bbdd5b0eb4cdc7c8c5a",
					"line": 91,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.metadata.annotations should specify an AppArmor profile for container {{helm-release-pruner}}",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}}.spec.jobTemplate.spec.template.metadata.annotations does not specify an AppArmor profile for container {{helm-release-pruner}}"
				}
			]
		},
		{
			"query_name": "Object Is Using A Deprecated API Version",
			"query_id": "94b76ea5-e074-4ca2-8a03-c5a606e30645",
			"query_url": "https://kubernetes.io/docs/reference/using-api/deprecation-guide/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions.",
			"description_id": "d5c30c5b",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "c69257817fdb9096385d701f83643e51d02642142d855e971bbb8cda49b1fbc5",
					"line": 74,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{batch/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}}.apiVersion of CronJob should be {{batch/v1}}",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}}.apiVersion of CronJob  is deprecated and is {{batch/v1beta1}}"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 39,
					"resource_type": "Role",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.apiVersion of Role should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.apiVersion of Role  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 39,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-helm-release-pruner-tiller",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.apiVersion of RoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{release-name-helm-release-pruner-tiller}}.apiVersion of RoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				}
			]
		},
		{
			"query_name": "Pod or Container Without LimitRange",
			"query_id": "4a20ebac-1060-4c81-95d1-1f7f620e983b",
			"query_url": "https://kubernetes.io/docs/concepts/policy/limit-range/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries",
			"description_id": "142ed21f",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "198c7852a394f84344d47c63772a0244114b554b58c2c293b6fb5359fa2f32cf",
					"line": 6,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}} does not have a 'LimitRange' policy associated"
				}
			]
		},
		{
			"query_name": "Pod or Container Without ResourceQuota",
			"query_id": "48a5beba-e4c0-4584-a2aa-e6894e4cf424",
			"query_url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume",
			"description_id": "86499ed5",
			"files": [
				{
					"file_name": "templates/helm-release-pruner_template.yaml",
					"similarity_id": "52ef3d7b49f5921263856fdd860a35930af0e692796c106385f4b981fffe459c",
					"line": 6,
					"resource_type": "CronJob",
					"resource_name": "release-name-helm-release-pruner",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-helm-release-pruner}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-helm-release-pruner}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{release-name-helm-release-pruner}} does not have a 'ResourceQuota' policy associated"
				}
			]
		}
	]
}
