{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 443,
	"files_parsed": 1,
	"lines_parsed": 435,
	"lines_ignored": 8,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 0,
		"INFO": 0,
		"LOW": 0,
		"MEDIUM": 4,
		"TRACE": 0
	},
	"total_counter": 4,
	"total_bom_resources": 0,
	"start": "2024-05-17T23:42:38.665493+02:00",
	"end": "2024-05-17T23:42:40.591487+02:00",
	"paths": [
		"templates/cluster_setup_template.yaml",
		"/usr/local/opt/kics/share/kics/assets/queries"
	],
	"queries": [
		{
			"query_name": "Permissive Access to Create Pods",
			"query_id": "592ad21d-ad9b-46c6-8d2d-fad09d62a942",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "The permission to create pods in a cluster should be restricted because it allows privilege escalation.",
			"description_id": "c78cb1a7",
			"files": [
				{
					"file_name": "templates/cluster_setup_template.yaml",
					"similarity_id": "720a58b8bd372577b94f305dc0f2f3648fc2e57af9012c2d878b43be3514e711",
					"line": 83,
					"resource_type": "ClusterRole",
					"resource_name": "admin-without-secrets",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{admin-without-secrets}}.rules.verbs.create",
					"search_line": 83,
					"search_value": "",
					"expected_value": "metadata.name=admin-without-secrets.rules.verbs should not contain the value 'create' when metadata.name=admin-without-secrets.rules.resources contains the value 'pods'",
					"actual_value": "metadata.name=admin-without-secrets.rules.verbs contains the value 'create' and metadata.name=admin-without-secrets.rules.resources contains the value 'pods'"
				}
			]
		},
		{
			"query_name": "RBAC Roles with Attach Permission",
			"query_id": "d45330fd-f58d-45fb-a682-6481477a0f84",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Roles or ClusterRoles with RBAC permissions to attach to containers via 'kubectl attach' could be abused by attackers to read log output (stdout, stderr) and send input data (stdin) to running processes. Additionally, it would allow a malicious user to attach to a privileged container resulting in a privilege escalation attack. To prevent this, the 'pods/attach' verb should not be used in production environments",
			"description_id": "d45330fd",
			"files": [
				{
					"file_name": "templates/cluster_setup_template.yaml",
					"similarity_id": "fe87be9a33769c5048b91a98604d6b0c3ed81fa4c37874162922424deb8cfd5b",
					"line": 91,
					"resource_type": "ClusterRole",
					"resource_name": "admin-without-secrets",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{admin-without-secrets}}.rules",
					"search_line": 91,
					"search_value": "",
					"expected_value": "metadata.name={{admin-without-secrets}}.rules[8].resources should not include the 'pods/attach' resource",
					"actual_value": "metadata.name={{admin-without-secrets}}.rules[8].resources includes the 'pods/attach' resource"
				}
			]
		},
		{
			"query_name": "RBAC Roles with Exec Permission",
			"query_id": "c589f42c-7924-4871-aee2-1cede9bc7cbc",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Roles or ClusterRoles with RBAC permissions to run commands in containers via 'kubectl exec' could be abused by attackers to execute malicious code in case of compromise. To prevent this, the 'pods/exec' verb should not be used in production environments",
			"description_id": "c589f42c",
			"files": [
				{
					"file_name": "templates/cluster_setup_template.yaml",
					"similarity_id": "f5a9bd9b2a7b2ff8d0eb0c7abc803d11485fa0f339a38136b7b474c91398939b",
					"line": 91,
					"resource_type": "ClusterRole",
					"resource_name": "admin-without-secrets",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{admin-without-secrets}}.rules",
					"search_line": 91,
					"search_value": "",
					"expected_value": "metadata.name={{admin-without-secrets}}.rules[8].resources should not include the 'pods/exec' resource",
					"actual_value": "metadata.name={{admin-without-secrets}}.rules[8].resources includes the 'pods/exec' resource"
				}
			]
		},
		{
			"query_name": "RBAC Roles with Port-Forwarding Permission",
			"query_id": "38fa11ef-dbcc-4da8-9680-7e1fd855b6fb",
			"query_url": "https://kubernetes.io/docs/reference/access-authn-authz/rbac/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Roles or ClusterRoles with RBAC permissions to port-forward into pods can open socket-level communication channels to containers. In case of compromise, attackers may abuse this for direct communication that bypasses network security restrictions",
			"description_id": "38fa11ef",
			"files": [
				{
					"file_name": "templates/cluster_setup_template.yaml",
					"similarity_id": "1bf4867390dbc5ec9cb15b078be3e92b8cc2c1342afb2cba69eee292a99ebbc1",
					"line": 91,
					"resource_type": "ClusterRole",
					"resource_name": "admin-without-secrets",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{admin-without-secrets}}.rules",
					"search_line": 91,
					"search_value": "",
					"expected_value": "metadata.name={{admin-without-secrets}}.rules[8].resources should not include the 'pods/portforward' resource",
					"actual_value": "metadata.name={{admin-without-secrets}}.rules[8].resources includes the 'pods/portforward' resource"
				}
			]
		}
	]
}
