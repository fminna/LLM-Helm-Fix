{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 701,
	"files_parsed": 1,
	"lines_parsed": 684,
	"lines_ignored": 17,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 8,
		"INFO": 0,
		"LOW": 37,
		"MEDIUM": 45,
		"TRACE": 0
	},
	"total_counter": 90,
	"total_bom_resources": 0,
	"start": "2024-06-26T03:00:55.39204+02:00",
	"end": "2024-06-26T03:00:57.705683+02:00",
	"paths": [
		"/usr/local/opt/kics/share/kics/assets/queries",
		"templates/uptrace_template.yaml"
	],
	"queries": [
		{
			"query_name": "Privilege Escalation Allowed",
			"query_id": "5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process",
			"description_id": "525fccf4",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "392ca4ea7ea62409effd1e73bff6966952af2ed5969c0361ce58eb67a76163ad",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "1647605460fb69cfbeba60814afca7ba0896e141336e73ad57af042b29a4cf84",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 434,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "e5316e5373d10aa3abe1456fa4bbadca0d176f96053da394db78d5fd79e24765",
					"line": 599,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 599,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "177a88171132d9e69c52efdc69448babade728e53f6610646ba8daf01cb4d1c6",
					"line": 504,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 504,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.allowPrivilegeEscalation is undefined"
				}
			]
		},
		{
			"query_name": "Volume Mount With OS Directory Write Permissions",
			"query_id": "b7652612-de4e-4466-a0bf-1cd81f0c6063",
			"query_url": "https://kubernetes.io/docs/concepts/storage/volumes/",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries.",
			"description_id": "e42b7901",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "26584b116cc633fca088c1e9be321b150d5596f1e168bda40f8a9bd06a129303",
					"line": 442,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-clickhouse-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-clickhouse-data}}.readOnly should be defined and set to true",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-clickhouse-data}}.readOnly is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "4fc785e231c6f9b072aa1ba9079d499a07c72a394251cab4b1fab453035bdd57",
					"line": 520,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-postgresql-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-postgresql-data}}.readOnly should be defined and set to true",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{uptrace-postgresql-data}}.readOnly is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "8aae3aca1a743b992575ddbf0be8a4a0befe6f6cb3ef816bcd9f02d7f0fe5f5a",
					"line": 604,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{config}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{config}}.readOnly should be defined and set to true",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.volumeMounts.name={{config}}.readOnly is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "09d17708fe634781930daa4072cc4aeb86d4be2bb29e5ba11af3a994ed3b7bc8",
					"line": 389,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.volumeMounts.name={{config}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.volumeMounts.name={{config}}.readOnly should be defined and set to true",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.volumeMounts.name={{config}}.readOnly is undefined"
				}
			]
		},
		{
			"query_name": "Container Running As Root",
			"query_id": "cf34805e-3872-4c08-bf92-6ff7bb0cfadb",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise",
			"description_id": "9d5b1d16",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "c8ce0b8888c71a83fd434f6c166e37ca0343cb444ea7a485e491d411844e4032",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 434,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "68c3d296de4e578def9b078c2aaac62089057d32c5c91880dfc7b9300107d9f0",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "6ac7d7bef7388624ee148c6be7b169124afec6d041939c83bf787d534e7c52ff",
					"line": 504,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 504,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "e637a32042d2cc894ae89ef94c7a0c62dad9376edc37f3429f65f51c110d9330",
					"line": 599,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 599,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				}
			]
		},
		{
			"query_name": "Container Running With Low UID",
			"query_id": "02323c00-cdc3-4fdc-a310-4f2b3e7a1660",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Check if containers are running with low UID, which might cause conflicts with the host's user table.",
			"description_id": "fc2c11f9",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "71e42b8993cb073db11f307ced5163ac2c7c751539fa571af2c8d39171a8a116",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "406aa3947badefcd9199ca0e3a54445c9a60be81c8f58940f1a5d71e666c3230",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "d870dd6772f7f2a522ee5c2d9fceb414b48a98d72afefc5780758e0db3027e82",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "32392847af0c6e744626aad34eaafd0d9a8c369d64ad0d5a0b4d54474208ee02",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.runAsUser is undefined"
				}
			]
		},
		{
			"query_name": "Memory Limits Not Defined",
			"query_id": "b14d1bc4-a208-45db-92f0-e21f8e2588e9",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
			"description_id": "e0ba95cc",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "48bc025f9d790c22591bdb2c019638a81c23335fa81d6de77ea5c168dcbbf3b0",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "4a0c97ab6a3eba1fb5ec0123f3ea49925cc54f41b065eba4a20445d1d1e9c964",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "683d4974c8aded0b7acf0f6a4f1a129b408779c2dcceeda30c7ca974d4c65f10",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "556ce35bc00c910ae9c680c451cbc28fdb97b32d370c03d6629222d35a1e9a73",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources.limits.memory is undefined"
				}
			]
		},
		{
			"query_name": "Memory Requests Not Defined",
			"query_id": "229588ef-8fde-40c8-8756-f4f2b5825ded",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes",
			"description_id": "3dcbd683",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0e42a98d536e10c4f7d12ded8c7d07824fa20a2a4d13eaeaae41131933bf8f85",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "8e2b45fae6ac2a23f7a4d3bc02658b0bb9f88c265e025ed22264812874ef930f",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "9270e54437c33af14e041f6296a5333a8a1a95643acc3d24e216e9292b2a6033",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "050b1372e4321fb782d9bf68da9c25e428048dde41e9c116983ef7282f4d2a5f",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources.requests.memory is undefined"
				}
			]
		},
		{
			"query_name": "NET_RAW Capabilities Not Being Dropped",
			"query_id": "dbbc6705-d541-43b0-b166-dd4be8208b54",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should drop 'ALL' or at least 'NET_RAW' capabilities",
			"description_id": "e9790956",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0550d85a2605146611c734169e4f4f61a7883745bb1e2a9ebe2fd472b2ddbbd0",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "f76bcf8fa4797be596705cf0772153848aa7f676101200a0dea97eee01091851",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "3a750a2a1cdfbc68cd9a45b7543998e528e289a69e2b361fc9b409941e8df0f5",
					"line": 433,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "18b7bbd96f2e5fdf7ba0d3e0387f90dbf5b9273c9b1ae7efe3731151653c35ad",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.capabilities.drop is undefined"
				}
			]
		},
		{
			"query_name": "Readiness Probe Is Not Configured",
			"query_id": "a659f3b5-9bf0-438a-bd9a-7d3a6427f1e3",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-readiness-probes",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Availability",
			"experimental": false,
			"description": "Check if Readiness Probe is not configured.",
			"description_id": "28c0498a",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "ac1939227ec48c0c67963322ab4934f8647d492d74b42664d04a629f4d49b7e2",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.readinessProbe should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.readinessProbe is undefined"
				}
			]
		},
		{
			"query_name": "Seccomp Profile Is Not Configured",
			"query_id": "f377b83e-bd07-4f48-a591-60c82b14a78b",
			"query_url": "https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls",
			"description_id": "d943c7e7",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "39538506ff8e755541b41606b40c0191b472c0de4ed4c1e9b47f54088f258042",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "f354d68acaf159aac2c769892c0ca0eb8bb7e6b232befffe4f18b52cd32eb155",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "a1ae87f62801511b80ae5a57046e46a0ba375616324ec7a76a05b598912713de",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "1b27c665d0535c22ec117e925dc957fdc14a4b51c31adce1e7018d4c68b14ef3",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.seccompProfile.type is undefined"
				}
			]
		},
		{
			"query_name": "Service Account Token Automount Not Disabled",
			"query_id": "48471392-d4d0-47c0-b135-cdec95eb3eef",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Defaults",
			"experimental": false,
			"description": "Service Account Tokens are automatically mounted even if not necessary",
			"description_id": "51cade0f",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "61261a11023ba0f6c71e7693d911d31d0914ac933b1ad93d7930a49356263850",
					"line": 382,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "b3b08e7f07f2c64f34cf6623c0e899515d2935892e423308d635be8adb302687",
					"line": 382,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0e40efd0a6d5984e58cb54ff322eac2d8f51246680e8e6cf866f9c947e7e11b3",
					"line": 382,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "be31d9a993848a92579094a6b334bb5062bc408f11877c6fc064bb3803962fa1",
					"line": 382,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.automountServiceAccountToken is undefined"
				}
			]
		},
		{
			"query_name": "Shared Service Account",
			"query_id": "c1032cf7-3628-44e2-bd53-38c17cf31b6b",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Secret Management",
			"experimental": false,
			"description": "A Service Account token is shared between workloads",
			"description_id": "f1c94544",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "b8d8a37403909f000d606523fba0071fe145527e1517e38cbd015eca2f453b64",
					"line": 383,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "79e661fbbe8f3268ee697edfb8b62b89f15c0e7adcac53da32d1d467f81b5e11",
					"line": 383,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "9aa2a4d0bbd08fa3305f5dc07b01e672b5a26bce7a62c314e0a609b926d1dd2e",
					"line": 383,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				}
			]
		},
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0b3648fc623c55e8f2b5c25c2ff91b198604c19785d583140331fe8c25ba442f",
					"line": 568,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{StatefulSet}}.metadata.name={{release-name-uptrace}}",
					"search_line": 568,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "281e972b043f8898441189d887b4c8d836e96c9d2cbc6ec76da5f3e2f2708e73",
					"line": 13,
					"resource_type": "ServiceAccount",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{otelcontribcol}}",
					"search_line": 13,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "fd3b7afd157d4532561cf995a7d723691e96f31f8acf53d702ec461bdc420a78",
					"line": 96,
					"resource_type": "ConfigMap",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ConfigMap}}.metadata.name={{release-name-uptrace}}",
					"search_line": 96,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "6c949637ae1bcedc80607b9ab1969ab87067a7d507a54d12f25b993cb54ae914",
					"line": 19,
					"resource_type": "ServiceAccount",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{release-name-uptrace}}",
					"search_line": 19,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "2cf9b4c99cd48f5ec1be608e6dba6917e8fb0fb1187c971b864280b4eefe77a6",
					"line": 279,
					"resource_type": "Service",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{uptrace-clickhouse}}",
					"search_line": 279,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "e1a33cc27372421cf386326a5e3cbdcc8b788a3aca2e0238a8338ac2ec414d9c",
					"line": 406,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{StatefulSet}}.metadata.name={{uptrace-clickhouse}}",
					"search_line": 406,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "d7d0d0da0fdaf32a1e09f1b19b8fa96bab291b3ace77b69d2f91d60f51aad8ec",
					"line": 41,
					"resource_type": "ConfigMap",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ConfigMap}}.metadata.name={{otelcontribcol}}",
					"search_line": 41,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "c315f1fc035bdf6e155686afa0ebe2b19806f6989292d2699bdb133c88f7d1ab",
					"line": 331,
					"resource_type": "Service",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{release-name-uptrace}}",
					"search_line": 331,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0b1290d713a6c76b31dced09269caaf8b9d273c4b9f1b0d5b3e94211c153221d",
					"line": 476,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{StatefulSet}}.metadata.name={{uptrace-postgresql}}",
					"search_line": 476,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "4fdbc479ea22b426ae27c198933ad4a5701cc0f10932f405ea7c300d76b76cdd",
					"line": 640,
					"resource_type": "Ingress",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Ingress}}.metadata.name={{release-name-uptrace}}",
					"search_line": 640,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "d03c0662572a1cce031dd4025ac2e6cac25fec2461abbbfbcf71ed02c0c16de0",
					"line": 361,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{otelcontribcol}}",
					"search_line": 361,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "7278944b176b490b161fb8a592c97c8f527b563a0c904273420da01b8c7a691e",
					"line": 307,
					"resource_type": "Service",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{uptrace-postgresql}}",
					"search_line": 307,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "c836eafa757524be611073638754ce6b64d2a536d12242ef75e8918b48112a68",
					"line": 31,
					"resource_type": "Secret",
					"resource_name": "uptrace-postgresql-secret",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Secret}}.metadata.name={{uptrace-postgresql-secret}}",
					"search_line": 31,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				}
			]
		},
		{
			"query_name": "CPU Limits Not Set",
			"query_id": "4ac0e2b7-d2d2-4af7-8799-e8de6721ccda",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests",
			"description_id": "9a2ef763",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "641eee98890c0a42e31a8b1f146188b235e925e93b212e10ebfb838dd54a6915",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name=otelcontribcol",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=otelcontribcol has resources defined",
					"actual_value": "spec.template.spec.containers.name=otelcontribcol doesn't have resources defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "c26d750968a049c79f58593c08564504b9783bee6a60947ed0dd6d6fb6b6f92d",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace has limits defined",
					"actual_value": "spec.template.spec.containers.name=uptrace doesn't have limits defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "f4af09744c166245c02630a0433997b8f6a2b31f4a9f02ef764f048445926e41",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace has limits defined",
					"actual_value": "spec.template.spec.containers.name=uptrace doesn't have limits defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "333c8a074ed52beccc3cdb8835c10dff328d100eedcac3ded99462d5c086f188",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace has limits defined",
					"actual_value": "spec.template.spec.containers.name=uptrace doesn't have limits defined"
				}
			]
		},
		{
			"query_name": "CPU Requests Not Set",
			"query_id": "ca469dd4-c736-448f-8ac1-30a642705e0a",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node",
			"description_id": "ac7ad5df",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "6f724a8cc64b915a06e2fe001377d7712c7276a5b8611b6d10ac8f56a526b366",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace.resources should have requests defined",
					"actual_value": "spec.template.spec.containers.name=uptrace.resources doesn't have requests defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "10285347be7b425b8366281dc624c1007a365a84b8859c9ec4f4bf92b30cfcaf",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace.resources should have requests defined",
					"actual_value": "spec.template.spec.containers.name=uptrace.resources doesn't have requests defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "30bb0a8f29a72eb0cc62f40bcda76e37a0cbf07f3b6ecd8abdd6000e2a2d8464",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name=otelcontribcol",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=otelcontribcol should have resources defined",
					"actual_value": "spec.template.spec.containers.name=otelcontribcol doesn't have resources defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "846092c18f77509686b7d548ca99c0ddbfb154bcbcd1eec2f5a277537bc08c65",
					"line": 459,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=uptrace.resources should have requests defined",
					"actual_value": "spec.template.spec.containers.name=uptrace.resources doesn't have requests defined"
				}
			]
		},
		{
			"query_name": "Image Pull Policy Of The Container Is Not Set To Always",
			"query_id": "caa3479d-885d-4882-9aac-95e5e78ef5c2",
			"query_url": "https://kubernetes.io/docs/concepts/containers/images/#updating-images",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Image Pull Policy of the container must be defined and set to Always",
			"description_id": "201e3c8d",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "00c1efd91c836ed151dd874ca42fcd513215a874a07f33bf698261bd66530fb2",
					"line": 437,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy should be set to 'Always'",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy relies on mutable images in cache"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "a3e8d28201409c6e1ed074b773f51d9a821bdf68ac9c1f981a6dde20534a13d6",
					"line": 437,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy should be set to 'Always'",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy relies on mutable images in cache"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "890ef76784255fa563065b9c788e8b74d622148782f2ccfab4028d8cbec3b65e",
					"line": 437,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy should be set to 'Always'",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.imagePullPolicy relies on mutable images in cache"
				}
			]
		},
		{
			"query_name": "Invalid Image Tag",
			"query_id": "583053b7-e632-46f0-b989-f81ff8045385",
			"query_url": "https://kubernetes.io/docs/concepts/containers/images/#updating-images",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Supply-Chain",
			"experimental": false,
			"description": "Image tag must be defined and not be empty or equal to latest.",
			"description_id": "30154626",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "0787e6fb8ef36a8538f57a68107dfb521817a4c8313852677e2fc144de8162b9",
					"line": 386,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.image",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.image tag is provided and not latest",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.image tag is not provided or latest"
				}
			]
		},
		{
			"query_name": "Missing AppArmor Profile",
			"query_id": "8b36775e-183d-4d46-b0f7-96a6f34a723f",
			"query_url": "https://kubernetes.io/docs/tutorials/clusters/apparmor/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources",
			"description_id": "59c17c0a",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "fb2523e0f67a63b6d0ea8a9feabc2b0fc1affdeaee3358a351fd9af716f9fe41",
					"line": 586,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.metadata",
					"search_line": 586,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{uptrace}}",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{uptrace}}"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "2a29f5de06cf00c996c963dc6be399b1c4be415c31bfefa65a814a3740b5b935",
					"line": 377,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{otelcontribcol}}",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{otelcontribcol}}"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "d15b3c2c04bf27f6b2f793f7c81df6abe199e0ed047dd4f57e89b3275692a0f6",
					"line": 377,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{uptrace}}",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{uptrace}}"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "f560659ee40a1c793a005dc1c49cd3b6ed5a9beb3bd9db55381b0070d2753a4d",
					"line": 377,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{uptrace}}",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{uptrace}}"
				}
			]
		},
		{
			"query_name": "No Drop Capabilities for Containers",
			"query_id": "268ca686-7fb7-4ae9-b129-955a2a89064e",
			"query_url": "https://kubernetes.io/docs/concepts/workloads/pods/init-containers/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Sees if Kubernetes Drop Capabilities exists to ensure containers security context",
			"description_id": "9d3ca6db",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "3838b1e173161fe022cc85a7d78424a3b7fbacd2f21bca77c62fcb12d56be7a4",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.containers.name={{uptrace}}.securityContext.capabilities should be set",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.containers.name={{uptrace}}.securityContext.capabilities is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "376351cc92dc54756dffa4d9116744320bbd51dfec865f794c99b200dcd23afd",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.containers.name=otelcontribcol",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.containers.name=otelcontribcol.securityContext should be set",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.containers.name=otelcontribcol.securityContext is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "eda4ef0e5a01dd19374ef0e3bd51b65da7aea9e2d7ce2e4741d9f5875a44d8b2",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.containers.name={{uptrace}}.securityContext.capabilities should be set",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.containers.name={{uptrace}}.securityContext.capabilities is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "2558482483b74705c9bc2fa0eadf465e22d71902e2ce7fc9e276f5f221e16d1d",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.containers.name={{uptrace}}.securityContext",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.containers.name={{uptrace}}.securityContext.capabilities should be set",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.containers.name={{uptrace}}.securityContext.capabilities is undefined"
				}
			]
		},
		{
			"query_name": "Pod or Container Without LimitRange",
			"query_id": "4a20ebac-1060-4c81-95d1-1f7f620e983b",
			"query_url": "https://kubernetes.io/docs/concepts/policy/limit-range/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries",
			"description_id": "142ed21f",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "2c8968fb375273947fe9ad73914a40a27f9ee1234f2c2585eb50410ae0e91ef1",
					"line": 19,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{release-name-uptrace}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "b19e07d7dd4c0d6ceec515517922aa7ba845826547d7312e8ad0f7ee829a8823",
					"line": 307,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{uptrace-postgresql}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "7ba91195c55bb00340bcde37485fe5e405495f97115a7a10dea56906e9c4295b",
					"line": 279,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{uptrace-clickhouse}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "eb198f3be6463fa459a4cbed443acc4e62a720662e320f1af1cd1e52d73bfc6a",
					"line": 13,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{otelcontribcol}} does not have a 'LimitRange' policy associated"
				}
			]
		},
		{
			"query_name": "Pod or Container Without ResourceQuota",
			"query_id": "48a5beba-e4c0-4584-a2aa-e6894e4cf424",
			"query_url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume",
			"description_id": "86499ed5",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "3336edd81d91008846cf0cf6f332be9f43d0c3fd73ea4cae200289815bed6beb",
					"line": 307,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{uptrace-postgresql}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "daff6adab655cb9fdb32ba7f458fb60d82e9a96246c9d096e892f1449f124286",
					"line": 19,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{release-name-uptrace}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "d3f78b1cf841a13e5d36429c572cbcf24cb7e4e6019e6f9a27f753e93c269ec8",
					"line": 13,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{otelcontribcol}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "162828154a3bcc60a5754e69812cb2b7ca9ea105ed95a87c4601c9911aab0aa1",
					"line": 279,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{uptrace-clickhouse}} does not have a 'ResourceQuota' policy associated"
				}
			]
		},
		{
			"query_name": "Pod or Container Without Security Context",
			"query_id": "a97a340a-0063-418e-b3a1-3028941d0995",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "A security context defines privilege and access control settings for a Pod or Container",
			"description_id": "68a1650b",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "9feaaea79db32812516cbffd2fe5f26e56aa1d54f86f19f03119b3183e610b24",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name=otelcontribcol",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=otelcontribcol has a security context",
					"actual_value": "spec.template.spec.containers.name=otelcontribcol does not have a security context"
				}
			]
		},
		{
			"query_name": "Root Container Not Mounted Read-only",
			"query_id": "a9c2f49d-0671-4fc9-9ece-f4e261e128d0",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Build Process",
			"experimental": false,
			"description": "Check if the root container filesystem is not being mounted read-only.",
			"description_id": "0d2df1e5",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "69894047d48ce6ba7457f52069b0d2315661666cee13511804ac1f3699a04a91",
					"line": 504,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 504,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "53a5b82fea19078cb58fade08cacad25a8b7e4b891af68565709d8f5f7476cc5",
					"line": 599,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-uptrace",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 599,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{release-name-uptrace}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "184481845bca6ddbb4fe0707850c6b45c52b429820a92b23729f31dba2a8171b",
					"line": 434,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}",
					"search_line": 434,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.template.spec.containers.name={{uptrace}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "abac71ad32ba241dee7a2d715d5e86abd6f28055b2bad1b3bca52c55e1f2b761",
					"line": 385,
					"resource_type": "Deployment",
					"resource_name": "otelcontribcol",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{otelcontribcol}}.spec.template.spec.containers.name={{otelcontribcol}}.securityContext.readOnlyRootFilesystem is undefined"
				}
			]
		},
		{
			"query_name": "Secrets As Environment Variables",
			"query_id": "3d658f8b-d988-41a0-a841-40043121de1e",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Secret Management",
			"experimental": false,
			"description": "Container should not use secrets as environment variables",
			"description_id": "99365a7d",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "a2d8f5a12d65cf7f9fea8094abae0cde843c6f1e6bac5c73c696da64da3f28fc",
					"line": 511,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.env.name={{POSTGRES_USER}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{uptrace}}.env.name={{POSTGRES_USER}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{uptrace}}.env.name={{POSTGRES_USER}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "4603ba64838a872edc0ce096c6f5a377a0a3bff15514c20de3d3d21e0e50b6c7",
					"line": 516,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.template.spec.containers.env.name={{POSTGRES_PASSWORD}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{uptrace}}.env.name={{POSTGRES_PASSWORD}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{uptrace}}.env.name={{POSTGRES_PASSWORD}}.valueFrom.secretKeyRef' is defined"
				}
			]
		},
		{
			"query_name": "StatefulSet Requests Storage",
			"query_id": "8cf4671a-cf3d-46fc-8389-21e7405063a2",
			"query_url": "https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Build Process",
			"experimental": false,
			"description": "A StatefulSet requests volume storage.",
			"description_id": "6210afe6",
			"files": [
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "73a5adcb27d2835183446f14cae6197a57cbb1a88b15173a80e5b7ad48051ec2",
					"line": 470,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-clickhouse",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-clickhouse}}.spec.volumeClaimTemplates.spec.resources.requests.storage=8Gi",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-clickhouse}}.spec.volumeClaimTemplates.spec.resources.requests.storage should not be set",
					"actual_value": "metadata.name={{uptrace-clickhouse}}.spec.volumeClaimTemplates.spec.resources.requests.storage is set to 8Gi"
				},
				{
					"file_name": "templates/uptrace_template.yaml",
					"similarity_id": "2e2ee3d8f17a6b8516ffeb43744140a15ca24d3fddec45d4a6b84fcfb38c1100",
					"line": 470,
					"resource_type": "StatefulSet",
					"resource_name": "uptrace-postgresql",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{uptrace-postgresql}}.spec.volumeClaimTemplates.spec.resources.requests.storage=8Gi",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{uptrace-postgresql}}.spec.volumeClaimTemplates.spec.resources.requests.storage should not be set",
					"actual_value": "metadata.name={{uptrace-postgresql}}.spec.volumeClaimTemplates.spec.resources.requests.storage is set to 8Gi"
				}
			]
		}
	]
}
