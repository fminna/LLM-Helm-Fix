{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 105,
	"files_parsed": 1,
	"lines_parsed": 100,
	"lines_ignored": 5,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 1,
		"INFO": 0,
		"LOW": 3,
		"MEDIUM": 8,
		"TRACE": 0
	},
	"total_counter": 12,
	"total_bom_resources": 0,
	"start": "2024-05-17T22:42:30.648232+02:00",
	"end": "2024-05-17T22:42:32.556367+02:00",
	"paths": [
		"templates/prometheus-darksky-exporter_template.yaml",
		"/usr/local/opt/kics/share/kics/assets/queries"
	],
	"queries": [
		{
			"query_name": "PSP With Unrestricted Access to Host Path",
			"query_id": "de4421f1-4e35-43b4-9783-737dd4e4a47e",
			"query_url": "https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "PodSecurityPolicy should set 'readOnly' to true in every host path allowed",
			"description_id": "fc4b7215",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "4d376c3202776fef785eb4cf5e3b8d643f5abe7b3f9a9c2b4cc067a9245079c4",
					"line": 17,
					"resource_type": "PodSecurityPolicy",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.allowedHostPaths' should be defined and not null",
					"actual_value": "'spec.allowedHostPaths' is undefined or null"
				}
			]
		},
		{
			"query_name": "Root Containers Admitted",
			"query_id": "e3aa0612-4351-4a0d-983f-aefea25cf203",
			"query_url": "https://kubernetes.io/docs/concepts/policy/pod-security-policy/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Containers must not be allowed to run with root privileges, which means the attributes 'privileged','allowPrivilegeEscalation' and 'readOnlyRootFilesystem' must be set to false, 'runAsUser.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden",
			"description_id": "2fe54446",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "cb261f7d0dbf8cd4e113b02d32e43f8f11142725414e3709417d62e0ae93eba4",
					"line": 38,
					"resource_type": "PodSecurityPolicy",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.fsGroup.rule",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.fsGroup limits its ranges",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.fsGroup does not limit its ranges"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "9a83eb0126f56a421fada49401272f372ab8f9c25556e7ff1ef4dfb74cf43fe5",
					"line": 32,
					"resource_type": "PodSecurityPolicy",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.runAsUser.rule",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.runAsUser.rule is equal to 'MustRunAsNonRoot'",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.runAsUser.rule is not equal to 'MustRunAsNonRoot'"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "b992e79c148bd06630dbdcfe6cb5cf9a3dbf85a746d8dcef454236886c7b5759",
					"line": 36,
					"resource_type": "PodSecurityPolicy",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.supplementalGroups.rule",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.supplementalGroups limits its ranges",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.supplementalGroups does not limit its ranges"
				}
			]
		},
		{
			"query_name": "Seccomp Profile Is Not Configured",
			"query_id": "f377b83e-bd07-4f48-a591-60c82b14a78b",
			"query_url": "https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls",
			"description_id": "d943c7e7",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "8c616ab85e2ccf67fe10133022a891f51cbe9c1de65436b67b2c40b6e34d8571",
					"line": 64,
					"resource_type": "PodSecurityPolicy",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.annotations.seccomp.security.alpha.kubernetes.io/defaultProfileName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.annotations.seccomp.security.alpha.kubernetes.io/defaultProfileName is 'runtime/default'",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.annotations.seccomp.security.alpha.kubernetes.io/defaultProfileName is 'docker/default'"
				}
			]
		},
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "b981e200d0349480c47e09ace6009816f97ba69776f9eff7aa1919fc47724f2c",
					"line": 56,
					"resource_type": "Role",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Role}}.metadata.name={{release-name-prometheus-darksky-exporter}}",
					"search_line": 56,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "13dd733df14a877fee100030648ead2c23c77e3c24fa47da75b6752efddbe960",
					"line": 72,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{RoleBinding}}.metadata.name={{release-name-prometheus-darksky-exporter}}",
					"search_line": 72,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "1e2fecfabd03cc171a80882de84ca792c2a9dc5b7a6f0d167b5b466735a2e02c",
					"line": 45,
					"resource_type": "ServiceAccount",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{release-name-prometheus-darksky-exporter}}",
					"search_line": 45,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "44120660c40faf1c62892b2fa7dbe255674cb302a7a2382764168049b591e44b",
					"line": 90,
					"resource_type": "Service",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{release-name-prometheus-darksky-exporter}}",
					"search_line": 90,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				}
			]
		},
		{
			"query_name": "Object Is Using A Deprecated API Version",
			"query_id": "94b76ea5-e074-4ca2-8a03-c5a606e30645",
			"query_url": "https://kubernetes.io/docs/reference/using-api/deprecation-guide/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions.",
			"description_id": "d5c30c5b",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 53,
					"resource_type": "RoleBinding",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.apiVersion of RoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.apiVersion of RoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 53,
					"resource_type": "Role",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.apiVersion of Role should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.apiVersion of Role  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				}
			]
		},
		{
			"query_name": "Service Does Not Target Pod",
			"query_id": "3ca03a61-3249-4c16-8427-6f8e47dda729",
			"query_url": "https://kubernetes.io/docs/concepts/services-networking/service/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Service should Target a Pod",
			"description_id": "e7c26645",
			"files": [
				{
					"file_name": "templates/prometheus-darksky-exporter_template.yaml",
					"similarity_id": "330738da749cefd856175690748bdc88504dbed7b7a9a2551c14b845aa77343f",
					"line": 102,
					"resource_type": "Service",
					"resource_name": "release-name-prometheus-darksky-exporter",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.selector",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.selector label refers to a Pod label",
					"actual_value": "metadata.name={{release-name-prometheus-darksky-exporter}}.spec.selector label does not match with any Pod label"
				}
			]
		}
	]
}
