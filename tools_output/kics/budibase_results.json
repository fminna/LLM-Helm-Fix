{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 1211,
	"files_parsed": 1,
	"lines_parsed": 1186,
	"lines_ignored": 25,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 9,
		"INFO": 0,
		"LOW": 104,
		"MEDIUM": 94,
		"TRACE": 0
	},
	"total_counter": 207,
	"total_bom_resources": 0,
	"start": "2024-05-18T00:03:57.333372+02:00",
	"end": "2024-05-18T00:04:00.192245+02:00",
	"paths": [
		"templates/budibase_template.yaml",
		"/usr/local/opt/kics/share/kics/assets/queries"
	],
	"queries": [
		{
			"query_name": "Privilege Escalation Allowed",
			"query_id": "5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "HIGH",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process",
			"description_id": "525fccf4",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1de5426735bcc1407e63c81ef2b7b372a69e0717a3b12b03f1ab706dd0c2a914",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "f918980758772d1c0dfbf52a5c1d6bd2339490774ae45267bf6bcc93655d4bf0",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "40c4035800942aebd0228aa54fb476fbad9eb10ba66a70e13f31fd304c85de5a",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "21d26d432a9d9b69d5edd4e242a02e05f5b20bc5371d52a07af6d0e78d3e1c9e",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "94a1893004b720482195fb6787fba2c9525822a9741230075e6efbd31dd28603",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "e10a21f991fe65d596651cecd610c96e07b1c3dcd91f04b62d9075696adfa2bc",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "153261275e92f1396bb4600c90b00715ceb1c182b6fcb8f3c0f37e366417cc04",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "dbf64c6bfd7260be0187eee75d96f3892ca55240896fdc80045d9b44b8fc3998",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.allowPrivilegeEscalation is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2585be0c4c5ed7d39ad1cc5799eeea117b0cc2a6d43cf92dde408da6cac0452e",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.allowPrivilegeEscalation should be set and should be set to false",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.allowPrivilegeEscalation is undefined"
				}
			]
		},
		{
			"query_name": "Container Running As Root",
			"query_id": "cf34805e-3872-4c08-bf92-6ff7bb0cfadb",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise",
			"description_id": "9d5b1d16",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "66f44e46b5152bae6e863ef1f7b375a2d22c4a74300e3105bb9fca2eeec2b609",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "4d56ec3ae860dd001464c73576de14ddd13d3299e5b9c3ad36973c38fb095638",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8c8d4f0e4a2fe851ac1ef88342c9e18076ebc49d2c0cdf158cc09dc14e738ff1",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2010d3e8a0fa35c243984b043f97e6d7ef76f24984ddda1c5d2468197cced29e",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c4f5bef9f15a9520fbd61a217bcbf4baaba5b66e7b04e17b9a60743bf340d60f",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ed59b148a4647f790c968ac3c249fa7947a1462bdb602e01252f6730042115e8",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "6507ac50afdc4c0bc4a8babe78bfdee1bc4ba23f3597f1b65038572752bc4635",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "eda6ae9d85a1521f465b192d044b22d3ff8205ae048c0d2608e40a5273f18b15",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "f483bb67a6417125c6f5adddf2388f9483bcc9e5559c2b1db27f7f76aede86f5",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.runAsUser is higher than 0 and/or 'runAsNonRoot' is true",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.runAsUser is 0 and 'runAsNonRoot' is false"
				}
			]
		},
		{
			"query_name": "Container Running With Low UID",
			"query_id": "02323c00-cdc3-4fdc-a310-4f2b3e7a1660",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Check if containers are running with low UID, which might cause conflicts with the host's user table.",
			"description_id": "fc2c11f9",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ff61c359668ede5c34cff10a86c24874afcdbb873b25242b8d186ae362c8f56f",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "06be20d76f6a19852ba2355b266c4a771c28d152a18d78533e0aff0ac512aa13",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "37cfd544476f927eeb348704f5d94012d88715553b92a36360b320b22c80abfb",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "4ef5a0a233c632b54690f8f320de60d8151807cae73458bd5012a069fd6cdd17",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1a8b794ede6ac91e7a3d43347e5c74b18ac76711fe83342dc8c6674043957e52",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a981e76ee1d68d1cbeab7a8648742cf523101ab0156212292fc54e248324841f",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ee54e2189f6962376d5fe8241cc3692ae6ec6d5c12f8a333c4282957ec1f09ff",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "00dd3ae6fcf871633155d4eae82499e33b55fcfa37b51ada5cd39facb4554e30",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.runAsUser is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "5d8a24709c72a4cb5fa22a2055f41c983322db5892dcfebc2b34ce43c0425902",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.runAsUser should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.runAsUser is undefined"
				}
			]
		},
		{
			"query_name": "Memory Limits Not Defined",
			"query_id": "b14d1bc4-a208-45db-92f0-e21f8e2588e9",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
			"description_id": "e0ba95cc",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "6765749c0754b7a915ff870af1565ff5d1ad74fb814044d5ddad4eec74327b5d",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a4c83dda583a90092f0e69d70702700115922d446076a8c5c51e3c190a4fc387",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8e11f29bbaa9024a7d8ec3d19e87abe83ce098904d7c05620493a07bee3aefd8",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "11efd06677710b612d0809e9cbe694e1958be161823033dd44fff96a824c0244",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "9244aab2c7bdb08418651570c6144a61e984f6ca74109300f7a998cc6cb87e33",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "aa7e64efc2abbb1240175c346ea1450bf43e4a5c0579c4b6ff99a20dced8b52f",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0cd378131e6177113a2bf04e14f40eec36d2f1d6e18e1e4cc58f6ade3ed002e0",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "56aaaaf4c998f580b4f72ea8ea7be671eb79eb40f4cb104b403b3d5a92a1ee0e",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.resources.limits.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "471986845b9e85a0564edc49f29ef2214894c1807ad336171a509994443d6aa2",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.resources.limits.memory should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.resources.limits.memory is undefined"
				}
			]
		},
		{
			"query_name": "Memory Requests Not Defined",
			"query_id": "229588ef-8fde-40c8-8756-f4f2b5825ded",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes",
			"description_id": "3dcbd683",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d105ca4cc435951740a2cbc0aeba0ff61df6942dda34db20478434a076a6db3d",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "12facb331591fa070827c92e3b19c9d8a0d712eebca9905baa8c6ee9ff99ab8b",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "f4ad002daf403f848029d09f0512bafd4c2b3081eb2e30d9430a158dfbf96688",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "923a8239c4aeffd6f64e181841a85247bd2a77be4eddde05a7079661ca5f7b0e",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d720c365c6ef3d6318ebf232db545d7e408c871afbd1f076af63c2e8d22c54ba",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "dbf264713776e9d2db516adff9c613d46d3dce830bd96fb9768af855255c4355",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bffe29d5bbcd96c4fccb65c3ec84a832aea2d19e18daa7b3887cb7b1956ec739",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "32dfe768d388d77f7801e662929d0d53b91f9eb1d30a59a82d278ca621404ee3",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.resources.requests.memory is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c9c776e097e2353c4aa6bfb16458f54e735efa833ac66f5f40d3b5e1c23a39ca",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.resources.requests.memory should be defined",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.resources.requests.memory is undefined"
				}
			]
		},
		{
			"query_name": "NET_RAW Capabilities Not Being Dropped",
			"query_id": "dbbc6705-d541-43b0-b166-dd4be8208b54",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should drop 'ALL' or at least 'NET_RAW' capabilities",
			"description_id": "e9790956",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "7515790adad7c3f75905057317316b69c67815c5d2de77686892b93003ca45b4",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "5e8db289545a9675903889dbb236e8b61aaa55c915c09ab4bf37e6f896c29160",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "3df90a59ac8093754c9219ca21ca2a6cb9c0d520f5f573a89235b021d101cce7",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2a9b2fa6ccb7c1bba076f3155b5138f180d9bcb14549aff4aa1679464550e64e",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "41c85a287c0fc9c01bac9fd5d5101e5c8aae6b40f2652cf7e80dc8da4357c185",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c69d1121f39c23899e7ba6c4144560f43ff75d33cb71f24592b97f601bf2013d",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "05dacc9a6df668b6db6db501940a02bb7c387a58bf548c3e7a221b8b78cbf492",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "3132fa1a25e1b628c5147fa6577a5ea42c1e424724fae44a038599de88e844a0",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.capabilities.drop is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b27c2727faafc6e3f2324e8bb8a67fda1713e1ef90915a0335bab8a711fa8f7f",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.capabilities.drop should be defined",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.capabilities.drop is undefined"
				}
			]
		},
		{
			"query_name": "Readiness Probe Is Not Configured",
			"query_id": "a659f3b5-9bf0-438a-bd9a-7d3a6427f1e3",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-readiness-probes",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Availability",
			"experimental": false,
			"description": "Check if Readiness Probe is not configured.",
			"description_id": "28c0498a",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d25e296580e3199827d67a00c440fcfb7e9aa4f24d98c6380a57216de465e5f1",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.readinessProbe should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.readinessProbe is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "cda4d7611deab5e2b5fdb2ccacff74fd89d66c135abf5217d7b4f28728833365",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.readinessProbe should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.readinessProbe is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "41631be9579692158560fb575c67cbf1ca45e8bdffaa5a68f9bfbcb0d6e5fd54",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.readinessProbe should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.readinessProbe is undefined"
				}
			]
		},
		{
			"query_name": "Seccomp Profile Is Not Configured",
			"query_id": "f377b83e-bd07-4f48-a591-60c82b14a78b",
			"query_url": "https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls",
			"description_id": "d943c7e7",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0be83863d0e2bb711a77abc5dd056979638f790ebbee4b57b20445348d23f6bc",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bb3043ce7be372b94bca164354b7f04d3798a8a6a4fa5b2ac4aaab8d65c01c0e",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bcf9302226a129da1e2fef224aece2f82bf8ed303f45b535cdb78180c11c86c0",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "06b9e14ebc40cdcba1392c2d23266d8caac93c8d83f5dada2857f394a2a9ba71",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "eecac61bb27fe50abcc2a9394d5d586e7da58efd2dd5a1493d58a389b1003b2c",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1b862ebe1fd95eacb202db20df5368fd053200137513365634d0b941cf6a8e62",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d7e706100e56be585192d82e3a65de964aad2cc824034bc1c73bc9e5d621cf3b",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "6cbb089659a55a4158bfcc79d595a9c638db0954d32171477491333418aea2dc",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.seccompProfile.type is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "34b8dad05b9ce7f6d8af241da32c6605e761cfa1c07ca6952ec9e1c88ba27f04",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.seccompProfile.type should be defined",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.seccompProfile.type is undefined"
				}
			]
		},
		{
			"query_name": "Service Account Name Undefined Or Empty",
			"query_id": "591ade62-d6b0-4580-b1ae-209f80ba1cd9",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Defaults",
			"experimental": false,
			"description": "A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'serviceAccountName' should be defined and not empty.",
			"description_id": "2940f843",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ed917e2a40f579315ced7873a5918f2f2aa0834adaa48d25320cffccfb5ed615",
					"line": 1204,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name=release-name-budibase-test-connection.spec.serviceAccountName should be defined",
					"actual_value": "metadata.name=release-name-budibase-test-connection.spec.serviceAccountName is undefined"
				}
			]
		},
		{
			"query_name": "Service Account Token Automount Not Disabled",
			"query_id": "48471392-d4d0-47c0-b135-cdec95eb3eef",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Defaults",
			"experimental": false,
			"description": "Service Account Tokens are automatically mounted even if not necessary",
			"description_id": "51cade0f",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0f64391354d7c9d3bea53def0fe5ae7b2186425d6d7d82b15e3ebf35f0c62650",
					"line": 319,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "51d87fe6426e7ae47669e7ce1e0e5c7d717771228dec59f76884c75d6299de49",
					"line": 319,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a0b585ab5df26d4502972012e2289a0a8d8338e78a99e53eb3c2a0cf3036b62d",
					"line": 507,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "5224dd3626b11a3c28c0d3d3266f8db2f19efbad4a0aeb586699d69f6da40494",
					"line": 319,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b159705ed086e403160956240882d4296bafebec098297b7b6ee2d0654a4ee18",
					"line": 319,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "385486472626f1f314b995f1b465e8ff408cf06a58958f1b919a45da9f2797d2",
					"line": 319,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "809fc215fe67ba91762f2433ce0f520299581e14cd3010bc19d58a11c0e70027",
					"line": 319,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.automountServiceAccountToken is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c7e0991259b70bdf5d935bca0810c092d5dc534225a968d7f9f7729da0979678",
					"line": 1204,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.automountServiceAccountToken should be defined and set to false",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.automountServiceAccountToken is undefined"
				}
			]
		},
		{
			"query_name": "Shared Service Account",
			"query_id": "c1032cf7-3628-44e2-bd53-38c17cf31b6b",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Secret Management",
			"experimental": false,
			"description": "A Service Account token is shared between workloads",
			"description_id": "f1c94544",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ed79269b6b83a7f78989f9651ab8f4617e79b4e6d3b026bfcadbd932a427e55b",
					"line": 478,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "835d440746917848b0e7fd9697a9fe5f9842a14845ef2f68b120df77d8e473ff",
					"line": 478,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b863601260209ecc34bd95cd2226038d1eb0cd684449d025ad2023c50e5bc681",
					"line": 667,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "66e2c2ff428b4f5e5ec3c3469cb4ef888c00e68b5ff103bbad1e795e194f1b09",
					"line": 478,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "75ffedd14a5395dd2cf93fb82860eb4f752bd61853e61ebcfee4cba7b3bf5c7b",
					"line": 478,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "97ba0453f345c9f5f83eb79737372ed2e24065d098a46c9d3d29db2ad2c58292",
					"line": 478,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.serviceAccountName",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.serviceAccountName' should not be shared with other workloads",
					"actual_value": "'spec.template.spec.serviceAccountName' is shared with other workloads"
				}
			]
		},
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a5ac0f727c1216d105b6a08455452170ca0009e014d434cea946b7e4acb8d60d",
					"line": 78,
					"resource_type": "Secret",
					"resource_name": "release-name-budibase",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Secret}}.metadata.name={{release-name-budibase}}",
					"search_line": 78,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "cd402a83337efc83a6de8bbad092529a6fe503e60223e85c16e88a1678bcacdc",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{proxy-service}}",
					"search_line": 746,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "4a1170b6214be32cf2e643ac9edd09c1a7cfb84731e2abedd6c5b7fc9789d626",
					"line": 872,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{worker-service}}",
					"search_line": 872,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "be1e691567e8224e57203781774773ceef1ff0ecc9563f16f096e4073f34a33a",
					"line": 95,
					"resource_type": "ConfigMap",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ConfigMap}}.metadata.name={{release-name-couchdb}}",
					"search_line": 95,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "25a6a1fed101443ecff1035261ab3f02a45fac8b2490ebeb563357b432ee2510",
					"line": 260,
					"resource_type": "Service",
					"resource_name": "release-name-budibase",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{release-name-budibase}}",
					"search_line": 260,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2b1f0ebe8b68f99c7e8138a1cd3a281a998fd241c26ff6b5fa50beb868a3cbf2",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{minio-service}}",
					"search_line": 678,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1db5c9fc313a79beadf55bfbabec0d21dd97d5e8820b4050b9cdb90220b86713",
					"line": 284,
					"resource_type": "Service",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{worker-service}}",
					"search_line": 284,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b4c2c3ce7fc40a28c7992baa542035f71647f8128d9a27b1c51192a45721646d",
					"line": 211,
					"resource_type": "Service",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{minio-service}}",
					"search_line": 211,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0002eb84b28057f0201525b1cb224dbe3241b7a5e78a73b5b16d640df3097c97",
					"line": 1058,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{StatefulSet}}.metadata.name={{release-name-couchdb}}",
					"search_line": 1058,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "86c620897147748ef82be4ed3f509e5809f77d026b4654fad27c722bcea7a2f5",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{redis-service}}",
					"search_line": 823,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "03c77468279404dbc8a76ccaf09c005914ded15c992ce55eb3b775b1972c5cff",
					"line": 492,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{automation-worker-service}}",
					"search_line": 492,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0f369133f0db9f9250578bcd8187c997fb1b5f84bfa90e2c7c74da573f351095",
					"line": 172,
					"resource_type": "Service",
					"resource_name": "release-name-svc-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{release-name-svc-couchdb}}",
					"search_line": 172,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "287301c5b4f341f15341ecb2b56be29eca16b954976fa3f6621913508c42f9be",
					"line": 1171,
					"resource_type": "Ingress",
					"resource_name": "release-name-budibase",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Ingress}}.metadata.name={{release-name-budibase}}",
					"search_line": 1171,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "cbb1ba1c990a734355429e2b7cfb0ba35a353000dcddc23ccb38ad2d821eb1a4",
					"line": 245,
					"resource_type": "Service",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{redis-service}}",
					"search_line": 245,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "883bbf6a608e59789d3c59d7e486f6b76653c703db73c00687f43de42331d08c",
					"line": 152,
					"resource_type": "Service",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{release-name-couchdb}}",
					"search_line": 152,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "04e193de94fce8c2430111ed7bc30ad6f3873f858eb2a06a90b3e06f4ba6e3e7",
					"line": 194,
					"resource_type": "Service",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{app-service}}",
					"search_line": 194,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ba95e16cc9b71b9d33f1ba5a817b7dc0636b317c187e81911c57e0f115bb07fb",
					"line": 61,
					"resource_type": "Secret",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Secret}}.metadata.name={{release-name-couchdb}}",
					"search_line": 61,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "dd237f5745eb3edf3c3d74f8addb44e226ed905062fa9ecc472eee3915ff39d6",
					"line": 38,
					"resource_type": "ServiceAccount",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{release-name-couchdb}}",
					"search_line": 38,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "31b60c6c2585d8da647b21c3c856fdd121161c6cd8d33476a674f5530afa1bbb",
					"line": 304,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Deployment}}.metadata.name={{app-service}}",
					"search_line": 304,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "78522dbf7f808fdd9c9ed46811b8537b67204b803607ac3b44983cd06d30868d",
					"line": 228,
					"resource_type": "Service",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{proxy-service}}",
					"search_line": 228,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "6feb64159adfaa35819a55c3918f57b6da70382d77117cb187b05d3cbe3125a5",
					"line": 49,
					"resource_type": "ServiceAccount",
					"resource_name": "release-name-budibase",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{ServiceAccount}}.metadata.name={{release-name-budibase}}",
					"search_line": 49,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "46daf1c7b1500669794065859230c91ec531c9aeffd10e5bbc36faaaeb1e92e1",
					"line": 1195,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Pod}}.metadata.name={{release-name-budibase-test-connection}}",
					"search_line": 1195,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				}
			]
		},
		{
			"query_name": "CPU Limits Not Set",
			"query_id": "4ac0e2b7-d2d2-4af7-8799-e8de6721ccda",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests",
			"description_id": "9a2ef763",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "40e1824904b38288cdda1d3c1566547f94f7a91d87184e951e7396e2f515b870",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name=bbapps",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbapps has resources defined",
					"actual_value": "spec.template.spec.containers.name=bbapps doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0d59a75c736b07660f31997320cc33d7c37e8d2cc8d3df8f6c48a32527a7e574",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name=redis-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=redis-service has resources defined",
					"actual_value": "spec.template.spec.containers.name=redis-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b67b39ec174185e0138f37b52624578b18ace7b350b72edcb09e4014e3f3f3b4",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name=init-copy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.initContainers.name=init-copy has resources defined",
					"actual_value": "spec.template.spec.initContainers.name=init-copy doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "3502f489f8b3465d946f3b6a73d30ee30e924eeb92efaa1b0b131febc90d62f2",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name=bbautomationworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbautomationworker has resources defined",
					"actual_value": "spec.template.spec.containers.name=bbautomationworker doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "fe3938d7dad8491990233df266bf607d43a0d54d8b46792d25ef7d6799b609df",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name=proxy-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=proxy-service has resources defined",
					"actual_value": "spec.template.spec.containers.name=proxy-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "9eaf732d7693a822756c62fd1f80966df1f352de69e223d03394eee3ee9c0296",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name=minio-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=minio-service has resources defined",
					"actual_value": "spec.template.spec.containers.name=minio-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ae2146b6a0674f09b7b53c414415c731ee4ae706245150e2127cde71b6033bc2",
					"line": 1146,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=couchdb has limits defined",
					"actual_value": "spec.template.spec.containers.name=couchdb doesn't have limits defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ba0839b925b889443c4bd6192657bb37579f528c6d654265ebcdd74d81545d10",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.containers.name=wget has resources defined",
					"actual_value": "spec.containers.name=wget doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "e3e180e868ef4f45f906fd0f7f29fc203f04661c576af6eaabd3abf4afbe2c4c",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name=bbworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbworker has resources defined",
					"actual_value": "spec.template.spec.containers.name=bbworker doesn't have resources defined"
				}
			]
		},
		{
			"query_name": "CPU Requests Not Set",
			"query_id": "ca469dd4-c736-448f-8ac1-30a642705e0a",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Resource Management",
			"experimental": false,
			"description": "CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node",
			"description_id": "ac7ad5df",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "6347a55bc84b142d176f85a83f009d670945a20a9f742da60a257ff73dc72f2d",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name=minio-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=minio-service should have resources defined",
					"actual_value": "spec.template.spec.containers.name=minio-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "63206a6cdfb00623e8c835566bf3dc8a090a115412bfdd67bb0207f6ab88ceec",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name=init-copy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.initContainers.name=init-copy should have resources defined",
					"actual_value": "spec.template.spec.initContainers.name=init-copy doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "f67c784a2f9e5cdc6dd05753577c6c85ccfe7cc6fe1b74f4a5b7a89ecf5cd1a3",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name=bbworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbworker should have resources defined",
					"actual_value": "spec.template.spec.containers.name=bbworker doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0c79178f64e4e4451ef9efc90b67125c832a8abbc644e7dbe96fbafb5320a52e",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name=bbapps",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbapps should have resources defined",
					"actual_value": "spec.template.spec.containers.name=bbapps doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c236234a0851dd2890303c065fc64c2d303152b1ac94c54f472eb08594090933",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name=proxy-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=proxy-service should have resources defined",
					"actual_value": "spec.template.spec.containers.name=proxy-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8964b15572fc101bd8385d9e8770ae060ee1d03a014afa88fa3212413f35ae98",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name=redis-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=redis-service should have resources defined",
					"actual_value": "spec.template.spec.containers.name=redis-service doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "80dd4fae781166cc29313a0f12b5d5537926031e0ad2ab9bec7006c744f2c1cd",
					"line": 1146,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.resources",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=couchdb.resources should have requests defined",
					"actual_value": "spec.template.spec.containers.name=couchdb.resources doesn't have requests defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8a7651eb8773003deb14183c57e10a13d1830e7f2d9f09df0e0e5e162fe9506e",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.containers.name=wget should have resources defined",
					"actual_value": "spec.containers.name=wget doesn't have resources defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2c2debc9b6b1dbabe06fb117383080af715fad28047fe0d3fd8838b9b7312ece",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name=bbautomationworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbautomationworker should have resources defined",
					"actual_value": "spec.template.spec.containers.name=bbautomationworker doesn't have resources defined"
				}
			]
		},
		{
			"query_name": "Invalid Image Tag",
			"query_id": "583053b7-e632-46f0-b989-f81ff8045385",
			"query_url": "https://kubernetes.io/docs/concepts/containers/images/#updating-images",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Supply-Chain",
			"experimental": false,
			"description": "Image tag must be defined and not be empty or equal to latest.",
			"description_id": "30154626",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1fcc9970a66f3a81e63e483eb0040e9027900347759f6a0614ec7346ff7e8070",
					"line": 841,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.image",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.image tag is provided and not latest",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.image tag is not provided or latest"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d99a945e0052f42c4f7a064db565d76a0df97575d5b9c603bfd90ec17dd8ba2e",
					"line": 1084,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.image",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.image tag is provided and not latest",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.image tag is not provided or latest"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "83a8527a74724068d70fbc47e07a4274ed0013e03a1a0bd94242c9a2fda49b30",
					"line": 709,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.image",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.image tag is provided and not latest",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.image tag is not provided or latest"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "5e133f51b9ba6a28532bfa53ac68795395d01e0d4aad50a1629f90ee90898fbd",
					"line": 1207,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.image",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.image tag is provided and not latest",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.image tag is not provided or latest"
				}
			]
		},
		{
			"query_name": "Missing AppArmor Profile",
			"query_id": "8b36775e-183d-4d46-b0f7-96a6f34a723f",
			"query_url": "https://kubernetes.io/docs/tutorials/clusters/apparmor/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Access Control",
			"experimental": false,
			"description": "Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources",
			"description_id": "59c17c0a",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b4868f308e36a9d02a9cff7051db62a7d302f612870a6558a68d734181e4c138",
					"line": 757,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.metadata",
					"search_line": 757,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{proxy-service}}",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{proxy-service}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "fc428a77ca5e7ce9d9a6da53c5202c09cae9bf9d5a6ebc290581d1a9b71f7321",
					"line": 882,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.metadata",
					"search_line": 882,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{bbworker}}",
					"actual_value": "metadata.name={{worker-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{bbworker}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ebf87ae9521cf8b1ae3fd9b92659ed18d6b31f230c747ec0f9af58018645e498",
					"line": 313,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{minio-service}}",
					"actual_value": "metadata.name={{minio-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{minio-service}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b0cbb87db2f768368beb1408e6a21316ada7c1ea8e332eb4e771f00bf3e832f2",
					"line": 1195,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.annotations should specify an AppArmor profile for container {{wget}}",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.annotations does not specify an AppArmor profile for container {{wget}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b5d53eb2261023d9384b7d940f4854f9b43ee0709c5e087af31c7902e9fb02dd",
					"line": 313,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.metadata",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{redis-service}}",
					"actual_value": "metadata.name={{redis-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{redis-service}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2bb23792d4b488eb58648f64320403557c6ced39c98110aad582739e0aa8248d",
					"line": 314,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.metadata",
					"search_line": 314,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{bbapps}}",
					"actual_value": "metadata.name={{app-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{bbapps}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0367179244613b441e44a39c05847591fa2f970148f58d2dd3cc770bae5c6f28",
					"line": 1077,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.metadata",
					"search_line": 1077,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{init-copy}}",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{init-copy}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d81819920c679df5e84778c22d665b9df8ff9de7499426671076c991fd77dddd",
					"line": 502,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.metadata",
					"search_line": 502,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{bbautomationworker}}",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{bbautomationworker}}"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0367179244613b441e44a39c05847591fa2f970148f58d2dd3cc770bae5c6f28",
					"line": 1077,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.metadata",
					"search_line": 1077,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.metadata.annotations should specify an AppArmor profile for container {{couchdb}}",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.metadata.annotations does not specify an AppArmor profile for container {{couchdb}}"
				}
			]
		},
		{
			"query_name": "No Drop Capabilities for Containers",
			"query_id": "268ca686-7fb7-4ae9-b129-955a2a89064e",
			"query_url": "https://kubernetes.io/docs/concepts/workloads/pods/init-containers/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Sees if Kubernetes Drop Capabilities exists to ensure containers security context",
			"description_id": "9d3ca6db",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "385cd96558ff7d94ba5cc4082de1b7cae6c4874ab80a16c5d28220213bf3b4ae",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.containers.name=bbautomationworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.containers.name=bbautomationworker.securityContext should be set",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.containers.name=bbautomationworker.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "dd51d8fae9c869d39595ae9f4bbcb11599b2908e70c7a6ce81b0ab257c6a6014",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.containers.name=minio-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.containers.name=minio-service.securityContext should be set",
					"actual_value": "metadata.name={{minio-service}}.spec.containers.name=minio-service.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "79510e42a058dc5577a3b7c483f6b1953375ad2a3c013cdcef851fe28c371cd6",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.containers.name=redis-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.containers.name=redis-service.securityContext should be set",
					"actual_value": "metadata.name={{redis-service}}.spec.containers.name=redis-service.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8a4500081437900bc89a8f1c45c55dec1395d389dbe16707d1fabd909f383339",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.containers.name=proxy-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.containers.name=proxy-service.securityContext should be set",
					"actual_value": "metadata.name={{proxy-service}}.spec.containers.name=proxy-service.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "267cad8f18a2f8fb1f113c4448e28d331f6a70d7847b7ab690914cbbd2d7c1b8",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.containers.name=couchdb",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.containers.name=couchdb.securityContext should be set",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.containers.name=couchdb.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "54016404a8700a00ead039bf1445d5f1f542a7dd8fbdeb7e4bcbe82859ddfd98",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget.securityContext should be set",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "9a4d67e280010c32250f1f2d683a540a2ab3175c1f590435d7df2ededf2d6023",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.initContainers.name=init-copy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.initContainers.name=init-copy.securityContext should be set",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.initContainers.name=init-copy.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2093ef3d40d8d95747badd46d773e85f8e076b00c1ce0493587c046712e35da6",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.containers.name=bbapps",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.containers.name=bbapps.securityContext should be set",
					"actual_value": "metadata.name={{app-service}}.spec.containers.name=bbapps.securityContext is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "714019833adbcc4ab7e9f23e7dae1efe7d8477564bbf8997279adc0ec5d42667",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.containers.name=bbworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.containers.name=bbworker.securityContext should be set",
					"actual_value": "metadata.name={{worker-service}}.spec.containers.name=bbworker.securityContext is undefined"
				}
			]
		},
		{
			"query_name": "Pod or Container Without LimitRange",
			"query_id": "4a20ebac-1060-4c81-95d1-1f7f620e983b",
			"query_url": "https://kubernetes.io/docs/concepts/policy/limit-range/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries",
			"description_id": "142ed21f",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b2016ed59ad216e9d7b7a2c48603a05440aeac2d0bb58fe3cb90f338e75a5335",
					"line": 194,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{app-service}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "992e23fe34636a3b841cc77d2a9b9b20779db1dee92489b31750c60e76be34bb",
					"line": 1195,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2ff7824fec2b08af496785e36eb10b681c7aa724717cc3a2b5bc85ec856b2eff",
					"line": 284,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{worker-service}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "dfecb500143c723660f699b5b0edfe657f8c4238a565733760eb91b9530dcf1e",
					"line": 138,
					"resource_type": "PersistentVolumeClaim",
					"resource_name": "redis-data",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-data}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{redis-data}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0e3a519e31b3537d2a734ce14931acee860703f869313db6ade9274fa3457e61",
					"line": 211,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{minio-service}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "d48bc0a8b946525f33096a36a1370b5b5a1f6a09ad4373481f1c67357c35f442",
					"line": 122,
					"resource_type": "PersistentVolumeClaim",
					"resource_name": "minio-data",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-data}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{minio-data}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ee723c982245a7748fe38ff82886a6f8fd001a68c91742f4cb94c50af889c9aa",
					"line": 245,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{redis-service}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "375c7008d968c874b1ef5963509af0d300156ccd30d5fb1e468fee9dba0080e0",
					"line": 6,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{release-name-couchdb}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "cafd8d46ea50d169c37a6ece0f4b121f648286d9575e5f7d13c43898725f350b",
					"line": 492,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{automation-worker-service}} does not have a 'LimitRange' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "1f4146b755875dd53a0062f94b419ce8f97080f82de1d405ea2235cdf406b071",
					"line": 228,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}} has a 'LimitRange' policy associated",
					"actual_value": "metadata.name={{proxy-service}} does not have a 'LimitRange' policy associated"
				}
			]
		},
		{
			"query_name": "Pod or Container Without ResourceQuota",
			"query_id": "48a5beba-e4c0-4584-a2aa-e6894e4cf424",
			"query_url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume",
			"description_id": "86499ed5",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "fbd1036c5fada931292ad782cd8eeec3e2d90d4140b9b8b740c90b1a259252f4",
					"line": 122,
					"resource_type": "PersistentVolumeClaim",
					"resource_name": "minio-data",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-data}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{minio-data}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "4a4ab427fbe843351730d29f2946ea838a92cb07a1f426e38891250fe0e09177",
					"line": 1195,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "c29d9fc8e021c72b8aebcd9b1384b9817ff4304426b1c382e754cd9707cf103e",
					"line": 228,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{proxy-service}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "abc9bfb07cfe70f557f06d0ae4575a20a5dd6e905c9d2027450ee073ac861d26",
					"line": 194,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{app-service}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "3eda7ecb1d7362b9243c80112628d6229e5b9d79edf65cb254a533a9292f07ca",
					"line": 492,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{automation-worker-service}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "080b846870971acecd023c2d0ba503cd70e05796d70a688c97059e7dd6da3ba1",
					"line": 138,
					"resource_type": "PersistentVolumeClaim",
					"resource_name": "redis-data",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-data}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-data}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{redis-data}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8a4e3e7edf75cc1f582ab365b79eccebf48975251535e20f85d1f27067cdc595",
					"line": 284,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{worker-service}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "da569f9da222b4b2a559f7d076b4b2fa61e775f5def9ec85308b138c6af93b50",
					"line": 6,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{release-name-couchdb}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a9ec0599b339a04908a21bd8fdbcdcade8c62f3b7788d56f261573573af3610e",
					"line": 211,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{minio-service}} does not have a 'ResourceQuota' policy associated"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "aa04ab8058043f9200fa7151f2c7a2954363e019ed066ea0d909a50abc6b5ac8",
					"line": 245,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}} has a 'ResourceQuota' policy associated",
					"actual_value": "metadata.name={{redis-service}} does not have a 'ResourceQuota' policy associated"
				}
			]
		},
		{
			"query_name": "Pod or Container Without Security Context",
			"query_id": "a97a340a-0063-418e-b3a1-3028941d0995",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "A security context defines privilege and access control settings for a Pod or Container",
			"description_id": "68a1650b",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ad41bd09b1e446eb33828b71b1085ee9e2aceff7fa8a91a22c04602c3ea33a41",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name=bbautomationworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbautomationworker has a security context",
					"actual_value": "spec.template.spec.containers.name=bbautomationworker does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "09e9d9b35045c6f848303ebb3615c12eda780b6cbcb48e562bc4653c15600675",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name=proxy-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=proxy-service has a security context",
					"actual_value": "spec.template.spec.containers.name=proxy-service does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "76fd5f80df8a90400d1c5fbe912d801244d174fe88c78f42055ab76b69cd7401",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name=couchdb",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=couchdb has a security context",
					"actual_value": "spec.template.spec.containers.name=couchdb does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "9885b1cca1cc22219f4d5dfd548b97a7ddc9a946d97ad6f320f2f1caaf50b115",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name=wget",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.containers.name=wget has a security context",
					"actual_value": "spec.containers.name=wget does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "4b613638c95ca0a21d48cd159a49a7a0c13610e5e99f6f4f271a8eb4968db217",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name=bbworker",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbworker has a security context",
					"actual_value": "spec.template.spec.containers.name=bbworker does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "656c82bd378e8312db98fd3a0e6dbab95223db7430bf539cadea8a59d5290fec",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name=redis-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=redis-service has a security context",
					"actual_value": "spec.template.spec.containers.name=redis-service does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "e63021587b9885303e137ae9faa9e8a5bf899d46dc2b9997ad73de4177b6bf7d",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name=init-copy",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.initContainers.name=init-copy has a security context",
					"actual_value": "spec.template.spec.initContainers.name=init-copy does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a2bb2fb9150de50529bf5cc553a9bc112581b1d3391e71ecfee643e73324be51",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name=minio-service",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=minio-service has a security context",
					"actual_value": "spec.template.spec.containers.name=minio-service does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bf8b1f6116b95aedef5ff8930e547e205fa8ead4422ce76c4f98b8d6d4dd6843",
					"line": 1204,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec has a security context",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec does not have a security context"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "cee6720d3d899dd2c6ce7437093f5ae390b6f73f4eada110d03687c57e249a8f",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name=bbapps",
					"search_line": -1,
					"search_value": "",
					"expected_value": "spec.template.spec.containers.name=bbapps has a security context",
					"actual_value": "spec.template.spec.containers.name=bbapps does not have a security context"
				}
			]
		},
		{
			"query_name": "Root Container Not Mounted Read-only",
			"query_id": "a9c2f49d-0671-4fc9-9ece-f4e261e128d0",
			"query_url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Build Process",
			"experimental": false,
			"description": "Check if the root container filesystem is not being mounted read-only.",
			"description_id": "0d2df1e5",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2e8879239eae58504be01a28b977cd1e7808b3e2247426740b492d467b3747cf",
					"line": 1096,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.name={{couchdb}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2dadcf025c386b2c29edc2f9bfb531a689cba41c43636e2ff5c4670d9e08f8be",
					"line": 1039,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{worker-service}}.spec.template.spec.containers.name={{bbworker}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "001a5e62bf7c5689e57abefa714d1841177a17c362e422d514cfe3a62beef10d",
					"line": 823,
					"resource_type": "Deployment",
					"resource_name": "redis-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{redis-service}}.spec.template.spec.containers.name={{redis-service}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a4b4a2d470a690648b5bd2f7e72474f7499b95244dc2e9cd2839873b7490089f",
					"line": 1206,
					"resource_type": "Pod",
					"resource_name": "release-name-budibase-test-connection",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{release-name-budibase-test-connection}}.spec.containers.name={{wget}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "7b8c587fa5ddfd1ddb8cb7c0f48cab88b3c86efeb9fbf7ab6fe6fbf34bd90d3f",
					"line": 657,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.name={{bbautomationworker}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2e504e94e453148b5ed095bfecaf9cb1092b62a73790d695a76465d6bcc604df",
					"line": 1083,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{release-name-couchdb}}.spec.template.spec.initContainers.name={{init-copy}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "216d3e96c3222dea2e19138f922fb469176973292db065742088805eab076ab0",
					"line": 746,
					"resource_type": "Deployment",
					"resource_name": "proxy-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{proxy-service}}.spec.template.spec.containers.name={{proxy-service}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "41bf8b40b5771fea58fe934a3d4239ccb040b2b3903d54f2fe4d040502340211",
					"line": 678,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{minio-service}}.spec.template.spec.containers.name={{minio-service}}.securityContext.readOnlyRootFilesystem is undefined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "5f87c86e0f54dd0bf6816002b8a83260d26cd855d742832295c5f4b4eaa6f6bb",
					"line": 468,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "MissingAttribute",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.readOnlyRootFilesystem should be set to true",
					"actual_value": "metadata.name={{app-service}}.spec.template.spec.containers.name={{bbapps}}.securityContext.readOnlyRootFilesystem is undefined"
				}
			]
		},
		{
			"query_name": "Secrets As Environment Variables",
			"query_id": "3d658f8b-d988-41a0-a841-40043121de1e",
			"query_url": "https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Secret Management",
			"experimental": false,
			"description": "Container should not use secrets as environment variables",
			"description_id": "99365a7d",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ff1fdeaaf082c9f142bdb96314995e5695ed6a53bdfeb00ae0eebe3dcf5076ca",
					"line": 1108,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.env.name={{COUCHDB_USER}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_USER}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_USER}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "817d8a4c0502bae8a13cdf637739442168bf753de39c6b86b29c3ab9964ff816",
					"line": 357,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0c7bf5aa7bb36ed332ee6f25269039e56b50d13716212d2900aa4f9f9097de28",
					"line": 526,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bbe8d5479e83dca11a388ec2d4d371d01dc93cf257ade8782f537580362747d9",
					"line": 338,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "55bbf95163c6a6c10773d0ef6dfe98cf55b1030423f5b693e83ff540ae4ae748",
					"line": 367,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "519567f29bad33dcc6520f9fd558cfa02a8fc7b13bca4f11ce0ab5d5e04c65e8",
					"line": 338,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{COUCH_DB_PASSWORD}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "7d949a34c11d49a894f9d1eeeee0a0e208f70ec7a27e2b6290b64a1de68eb6f2",
					"line": 1118,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.env.name={{COUCHDB_SECRET}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_SECRET}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_SECRET}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "3b8769ba6d1f4990d9a86b407678d07b9d8a591ff5638fc568aa15a7dd981170",
					"line": 372,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bec3c8501562d1222bb757afacda77d41d74205b1ae4fc45368f143946fbdd21",
					"line": 538,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "f0077c61f4da6ce241db4eb72bb5dcc2b4e7d890449d1a9a143665bcab74688c",
					"line": 350,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "af1273cf7c7a1964528df6834bcb05395f3727a821789e2407802f8890fa1a07",
					"line": 372,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{minio-service}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{minio-service}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "68d27eef43c1009e83f1f9e3ca21b1a346cb2ae1fea386db26ac450c1ab21f34",
					"line": 350,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{INTERNAL_API_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "21f0a84d8ad60c76dad136e0109dadc5cfde1b9911c308783963b3dab9342744",
					"line": 372,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "0c7b197e683545d10d0e4d7d31749b551b4c36ba3ff8f01f4f65de4eafc678db",
					"line": 545,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "bde38c991683cf0b7b39dde32fc85def50bc12cae9d11befc8dd9613dc089e18",
					"line": 560,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{MINIO_SECRET_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "ca6adc0e2919acbfbc856d4971c4c270c42b2d645e1d407c670292855c520b7f",
					"line": 333,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "de62872f374e619f8b6a4c975443f991947c5d2e8846123ebc23b734c6601589",
					"line": 367,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "8fbb8ae28a3ac9db7416e2a3867ee77acf51c381a98edd8aae59a5a829f23815",
					"line": 1123,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.env.name={{COUCHDB_ERLANG_COOKIE}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_ERLANG_COOKIE}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_ERLANG_COOKIE}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2e483fad58add2ab5249d91b339f966efbbc73960480fbc8fcbe5dd3df3064a6",
					"line": 333,
					"resource_type": "Deployment",
					"resource_name": "app-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{app-service}}.spec.template.spec.containers.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbapps}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "b9f9e1b4d9fa8fc3a0ca5e2498f7007a4a794233ddb9b8fbe5115ca7f60e0f92",
					"line": 367,
					"resource_type": "Deployment",
					"resource_name": "minio-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{minio-service}}.spec.template.spec.containers.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{minio-service}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{minio-service}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "29f545424b34ab88fb3ef226e474419c5d20808d88fc4ac1e52f7731c6f0f39b",
					"line": 357,
					"resource_type": "Deployment",
					"resource_name": "worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{worker-service}}.spec.template.spec.containers.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbworker}}.env.name={{JWT_SECRET}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "a93fe98f444712c055206b1f38bd665c30f67936ad4774523fa908bd3a0b7279",
					"line": 1113,
					"resource_type": "StatefulSet",
					"resource_name": "release-name-couchdb",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-couchdb}}.spec.template.spec.containers.env.name={{COUCHDB_PASSWORD}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_PASSWORD}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{couchdb}}.env.name={{COUCHDB_PASSWORD}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "2ad6e3df100a214cfccbcc068063aa649773666092c2d8a242a37b4f4312d942",
					"line": 521,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{COUCH_DB_USER}}.valueFrom.secretKeyRef' is defined"
				},
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "eaf5ac6b92d0f6bef91c461271a5b6c879df08dcabdba4c8f2c07abd382865a9",
					"line": 555,
					"resource_type": "Deployment",
					"resource_name": "automation-worker-service",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{automation-worker-service}}.spec.template.spec.containers.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' should be undefined",
					"actual_value": "'spec.template.spec.containers.name={{bbautomationworker}}.env.name={{MINIO_ACCESS_KEY}}.valueFrom.secretKeyRef' is defined"
				}
			]
		},
		{
			"query_name": "Service Does Not Target Pod",
			"query_id": "3ca03a61-3249-4c16-8427-6f8e47dda729",
			"query_url": "https://kubernetes.io/docs/concepts/services-networking/service/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Service should Target a Pod",
			"description_id": "e7c26645",
			"files": [
				{
					"file_name": "templates/budibase_template.yaml",
					"similarity_id": "abeed7138bd3a6511f21c9572872029e85be2f1e9a44c127e57e0a3e389abe59",
					"line": 232,
					"resource_type": "Service",
					"resource_name": "release-name-budibase",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{release-name-budibase}}.spec.ports.port={{10000}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{release-name-budibase}}.spec.ports.port={{10000}} has a Pod port",
					"actual_value": "metadata.name={{release-name-budibase}}.spec.ports.port={{10000}} does not have a Pod port"
				}
			]
		}
	]
}
