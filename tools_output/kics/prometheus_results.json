{
	"kics_version": "2.0.0",
	"files_scanned": 1,
	"lines_scanned": 824,
	"files_parsed": 1,
	"lines_parsed": 810,
	"lines_ignored": 14,
	"files_failed_to_scan": 0,
	"queries_total": 134,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 0,
		"INFO": 0,
		"LOW": 9,
		"MEDIUM": 9,
		"TRACE": 0
	},
	"total_counter": 18,
	"total_bom_resources": 0,
	"start": "2024-05-18T00:08:49.858326+02:00",
	"end": "2024-05-18T00:08:51.931241+02:00",
	"paths": [
		"/usr/local/opt/kics/share/kics/assets/queries",
		"templates/prometheus_template.yaml"
	],
	"queries": [
		{
			"query_name": "Using Unrecommended Namespace",
			"query_id": "611ab018-c4aa-4ba2-b0f6-a448337509a6",
			"query_url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/",
			"severity": "MEDIUM",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Namespaces like 'default', 'kube-system' or 'kube-public' should not be used",
			"description_id": "29549ea9",
			"files": [
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "725596a2bf7af1d64e706681c6e405b67d51f7a06c3e1a378bccd289057567e7",
					"line": 621,
					"resource_type": "Role",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-k8s}}.namespace",
					"search_line": 621,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "aadb40dba7b6c49ff91ada6731430db33318ff1844323fd51090f3ddd1eba69e",
					"line": 738,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-default-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-default-k8s}}.namespace",
					"search_line": 738,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "edae24986bc99de9a1613ba9ca199d707f92b2c0e26a630f6cd7f6e838c1f226",
					"line": 692,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-k8s}}.namespace",
					"search_line": 692,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "a86661581dcd583df968966d2f5f01b5c52f1b213d64784cb15c86c251f5e262",
					"line": 715,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-kube-system-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-kube-system-k8s}}.namespace",
					"search_line": 715,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to kube-system"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "ae39f36648d43751bad7788fc6a01a43c05455bf6381d9dcb1e2a714ffde071d",
					"line": 670,
					"resource_type": "Role",
					"resource_name": "monitoring-default-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-default-k8s}}.namespace",
					"search_line": 670,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "c4f5532e87f8140c669bcfb76eecdcc6a891c163116374e6e7c9a28559b8393e",
					"line": 22,
					"resource_type": "ConfigMap",
					"resource_name": "monitoring-k8s-rules",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-k8s-rules}}.namespace",
					"search_line": 22,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "5ae83dcf535c89690081ddeffdb80b990173fcbfc1eea6b58f242a18a614672b",
					"line": 762,
					"resource_type": "Service",
					"resource_name": "prometheus-k8s",
					"issue_type": "MissingAttribute",
					"search_key": "kind={{Service}}.metadata.name={{prometheus-k8s}}",
					"search_line": 762,
					"search_value": "",
					"expected_value": "metadata.namespace should be defined and not null",
					"actual_value": "metadata.namespace is undefined or null"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "7aa8a3f1e0bbcbdd43571cee85fc18084676dc84524cf3c563e5ee0a067861d5",
					"line": 648,
					"resource_type": "Role",
					"resource_name": "monitoring-kube-system-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-kube-system-k8s}}.namespace",
					"search_line": 648,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to kube-system"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "8e1990abd57522304df4a851d0f9f0e0a2b0824b2e0a5def642be0e1dea35442",
					"line": 15,
					"resource_type": "ServiceAccount",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{monitoring-k8s}}.namespace",
					"search_line": 15,
					"search_value": "",
					"expected_value": "'metadata.namespace' should not be set to default, kube-system or kube-public",
					"actual_value": "'metadata.namespace' is set to default"
				}
			]
		},
		{
			"query_name": "Object Is Using A Deprecated API Version",
			"query_id": "94b76ea5-e074-4ca2-8a03-c5a606e30645",
			"query_url": "https://kubernetes.io/docs/reference/using-api/deprecation-guide/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Best Practices",
			"experimental": false,
			"description": "Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions.",
			"description_id": "d5c30c5b",
			"files": [
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-kube-system-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-kube-system-k8s}}.apiVersion of RoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-kube-system-k8s}}.apiVersion of RoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "Role",
					"resource_name": "monitoring-kube-system-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-kube-system-k8s}}.apiVersion of Role should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-kube-system-k8s}}.apiVersion of Role  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "Role",
					"resource_name": "monitoring-default-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-default-k8s}}.apiVersion of Role should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-default-k8s}}.apiVersion of Role  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "Role",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-k8s}}.apiVersion of Role should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-k8s}}.apiVersion of Role  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "ClusterRole",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-k8s}}.apiVersion of ClusterRole should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-k8s}}.apiVersion of ClusterRole  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "ClusterRoleBinding",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-k8s}}.apiVersion of ClusterRoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-k8s}}.apiVersion of ClusterRoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-default-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-default-k8s}}.apiVersion of RoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-default-k8s}}.apiVersion of RoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				},
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "6e0642ec58c4f7cf07ed3afd8858165fd14d5b0b3934e26e0a743e200b102736",
					"line": 555,
					"resource_type": "RoleBinding",
					"resource_name": "monitoring-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "apiVersion={{rbac.authorization.k8s.io/v1beta1}}",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{monitoring-k8s}}.apiVersion of RoleBinding should be {{rbac.authorization.k8s.io/v1}}",
					"actual_value": "metadata.name={{monitoring-k8s}}.apiVersion of RoleBinding  is deprecated and is {{rbac.authorization.k8s.io/v1beta1}}"
				}
			]
		},
		{
			"query_name": "Service Does Not Target Pod",
			"query_id": "3ca03a61-3249-4c16-8427-6f8e47dda729",
			"query_url": "https://kubernetes.io/docs/concepts/services-networking/service/",
			"severity": "LOW",
			"platform": "Kubernetes",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "Service should Target a Pod",
			"description_id": "e7c26645",
			"files": [
				{
					"file_name": "templates/prometheus_template.yaml",
					"similarity_id": "acd32a20ada60b15cd0d76cac73c9f9f789c7bccd7dcb1777231686f531aea22",
					"line": 769,
					"resource_type": "Service",
					"resource_name": "prometheus-k8s",
					"issue_type": "IncorrectValue",
					"search_key": "metadata.name={{prometheus-k8s}}.spec.selector",
					"search_line": -1,
					"search_value": "",
					"expected_value": "metadata.name={{prometheus-k8s}}.spec.selector label refers to a Pod label",
					"actual_value": "metadata.name={{prometheus-k8s}}.spec.selector label does not match with any Pod label"
				}
			]
		}
	]
}
