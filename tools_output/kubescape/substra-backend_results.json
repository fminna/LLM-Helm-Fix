{"generationTime":"0001-01-01T00:00:00Z","clusterAPIServerInfo":null,"clusterCloudProvider":"","customerGUID":"","clusterName":"","reportGUID":"","jobID":"","summaryDetails":{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":25,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":4,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":33.333332,"complianceScore":66.66667,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"passed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":9,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":75,"complianceScore":25,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":12,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0030":{"statusInfo":{"status":"failed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":11,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":78.57143,"complianceScore":21.428572,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0031":{"statusInfo":{"status":"passed"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0034":{"statusInfo":{"status":"failed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":2,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":11.111111,"complianceScore":88.88889,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0042":{"statusInfo":{"status":"passed"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0053","name":"Access container service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":9,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":75,"complianceScore":25,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0063":{"statusInfo":{"status":"passed"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0187":{"statusInfo":{"status":"passed"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"failed"},"controlID":"C-0260","name":"Missing network policy","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":15,"failedResources":11,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":42.307693,"complianceScore":57.692307,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":8.333333,"complianceScore":91.66667,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":8.333333,"complianceScore":91.66667,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"status":"failed","frameworks":[{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":25,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":4,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":33.333332,"complianceScore":66.66667,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0015":{"statusInfo":{"status":"passed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0063":{"statusInfo":{"status":"passed"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0187":{"statusInfo":{"status":"passed"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"failed"},"controlID":"C-0260","name":"Missing network policy","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":15,"failedResources":11,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":42.307693,"complianceScore":57.692307,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}}},"name":"ClusterScan","status":"failed","version":"","ResourceCounters":{"passedResources":19,"failedResources":15,"skippedResources":0,"excludedResources":0},"score":13.655914,"complianceScore":93.2906},{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":25,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"passed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0031":{"statusInfo":{"status":"passed"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0042":{"statusInfo":{"status":"passed"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0053","name":"Access container service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}}},"name":"MITRE","status":"failed","version":"","ResourceCounters":{"passedResources":23,"failedResources":6,"skippedResources":0,"excludedResources":0},"score":7.111111,"complianceScore":98.52941},{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":25,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":4,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":33.333332,"complianceScore":66.66667,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":9,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":75,"complianceScore":25,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":12,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0030":{"statusInfo":{"status":"failed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":11,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":78.57143,"complianceScore":21.428572,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0034":{"statusInfo":{"status":"failed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":2,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":11.111111,"complianceScore":88.88889,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":4,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":3,"failedResources":9,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":75,"complianceScore":25,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":12,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":8.333333,"complianceScore":91.66667,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":8.333333,"complianceScore":91.66667,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"name":"NSA","status":"failed","version":"","ResourceCounters":{"passedResources":20,"failedResources":16,"skippedResources":0,"excludedResources":0},"score":23.47267,"complianceScore":78.17461}],"resourcesSeverityCounters":{"criticalSeverity":0,"highSeverity":8,"mediumSeverity":46,"lowSeverity":12},"controlsSeverityCounters":{"criticalSeverity":0,"highSeverity":3,"mediumSeverity":6,"lowSeverity":1},"ResourceCounters":{"passedResources":25,"failedResources":16,"skippedResources":0,"excludedResources":0},"score":19.139547,"complianceScore":86.55912},"resources":[{"resourceID":"path=3714959222/api=/v1//ServiceAccount/release-name-substra-backend-event","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-event"},"sourcePath":"templates/substra-backend_template.yaml:6"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-api-events","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-api-events"},"sourcePath":"templates/substra-backend_template.yaml:51","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-api-events"}},"template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-redis":"264b5affa56b5e88eed5ddc20e36253edbba046a4631250fd0addf3c962a9f84","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-api-events","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"api-event-app","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","python manage.py consume"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"}],"resources":{"limits":{"cpu":"500m","memory":"400Mi"},"requests":{"cpu":"100m","memory":"50Mi"}},"readinessProbe":{"exec":{"command":["cat","/tmp/ready"]},"initialDelaySeconds":5,"periodSeconds":20},"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","until pg_isready --host=release-name-postgresql.default --port=5432; do echo \"Waiting for postgresql service\"; sleep 2; done;"],"env":[{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"postgres"},{"name":"PGDATABASE","value":"substra"}],"image":"postgres","name":"wait-postgresql"},{"command":["bash","/usr/src/app/wait-init-migration.sh"],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"backend.settings.prod"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"image":"ghcr.io/substra/substra-backend:0.45.0","name":"wait-init-migrations","volumeMounts":[{"mountPath":"/usr/src/app/wait-init-migration.sh","name":"volume-wait-init-migrations","subPath":"wait-init-migration.sh"}]}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"serviceAccountName":"release-name-substra-backend-api-event","volumes":[{"configMap":{"name":"release-name-substra-backend-wait-init-migrations"},"name":"volume-wait-init-migrations"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=1691896264/api=/v1/default/ConfigMap/release-name-docker-registry-config","object":{"apiVersion":"v1","data":{"config.yml":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"docker-registry","chart":"docker-registry-2.2.2","heritage":"Helm","release":"release-name"},"name":"release-name-docker-registry-config","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:17"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3520803830/api=/v1/default/ConfigMap/release-name-redis-scripts","object":{"apiVersion":"v1","data":{"start-master.sh":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis-scripts","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:20"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3554359068/api=/v1//ConfigMap/release-name-substra-backend-server-uwsgi","object":{"apiVersion":"v1","data":{"uwsgi.ini":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-server-uwsgi"},"sourcePath":"templates/substra-backend_template.yaml:26"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3765292079/api=networking.k8s.io/v1//NetworkPolicy/release-name-substra-backend-deny-ingress","object":{"apiVersion":"networking.k8s.io/v1","kind":"NetworkPolicy","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-deny-ingress"},"sourcePath":"templates/substra-backend_template.yaml:1","spec":{"podSelector":{"matchLabels":{"substra.ai/pod-type":"compute-task"}},"policyTypes":["Ingress","Egress"]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3571283782/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-builder","object":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-builder"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-builder"},"sourcePath":"templates/substra-backend_template.yaml:37","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-builder"}]},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3739059972/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-api-event","object":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-api-event"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-api-event"},"sourcePath":"templates/substra-backend_template.yaml:39","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-api-event"}]},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3587075663/api=apps/v1/default/StatefulSet/release-name-postgresql","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app.kubernetes.io/component":"primary","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"postgresql","app.kubernetes.io/version":"16.0.0","helm.sh/chart":"postgresql-13.1.2"},"name":"release-name-postgresql","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:56","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/component":"primary","app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"postgresql"}},"serviceName":"release-name-postgresql-hl","template":{"metadata":{"labels":{"app.kubernetes.io/component":"primary","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"postgresql","app.kubernetes.io/version":"16.0.0","helm.sh/chart":"postgresql-13.1.2"},"name":"release-name-postgresql"},"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app.kubernetes.io/component":"primary","app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"postgresql"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"containers":[{"name":"postgresql","image":"docker.io/bitnami/postgresql:16.0.0-debian-11-r10","ports":[{"name":"tcp-postgresql","containerPort":5432}],"env":[{"name":"BITNAMI_DEBUG","value":"XXXXXX"},{"name":"POSTGRESQL_PORT_NUMBER","value":"XXXXXX"},{"name":"POSTGRESQL_VOLUME_DIR","value":"XXXXXX"},{"name":"PGDATA","value":"XXXXXX"},{"name":"POSTGRES_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-postgresql","key":"postgres-password"}}},{"name":"POSTGRES_DATABASE","value":"XXXXXX"},{"name":"POSTGRESQL_ENABLE_LDAP","value":"XXXXXX"},{"name":"POSTGRESQL_ENABLE_TLS","value":"XXXXXX"},{"name":"POSTGRESQL_LOG_HOSTNAME","value":"XXXXXX"},{"name":"POSTGRESQL_LOG_CONNECTIONS","value":"XXXXXX"},{"name":"POSTGRESQL_LOG_DISCONNECTIONS","value":"XXXXXX"},{"name":"POSTGRESQL_PGAUDIT_LOG_CATALOG","value":"XXXXXX"},{"name":"POSTGRESQL_CLIENT_MIN_MESSAGES","value":"XXXXXX"},{"name":"POSTGRESQL_SHARED_PRELOAD_LIBRARIES","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"4Gi"},"requests":{"cpu":"50m","memory":"256Mi"}},"volumeMounts":[{"name":"dshm","mountPath":"/dev/shm"},{"name":"data","mountPath":"/bitnami/postgresql"}],"livenessProbe":{"exec":{"command":["/bin/sh","-c","exec pg_isready -U \"postgres\" -d \"dbname=substra\" -h 127.0.0.1 -p 5432"]},"initialDelaySeconds":30,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"readinessProbe":{"exec":{"command":["/bin/sh","-c","-e","exec pg_isready -U \"postgres\" -d \"dbname=substra\" -h 127.0.0.1 -p 5432\n[ -f /opt/bitnami/postgresql/tmp/.initialized ] || [ -f /bitnami/postgresql/.initialized ]\n"]},"initialDelaySeconds":5,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["ALL"]},"runAsUser":1001,"runAsGroup":0,"runAsNonRoot":true,"allowPrivilegeEscalation":false,"seccompProfile":{"type":"RuntimeDefault"}}}],"hostIPC":false,"hostNetwork":false,"securityContext":{"fsGroup":1001,"runAsNonRoot":true,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"default","volumes":[{"emptyDir":{"medium":"Memory"},"name":"dshm"}]}},"updateStrategy":{"rollingUpdate":{},"type":"RollingUpdate"},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"name":"data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"8Gi"}}}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3655024782/api=/v1//ConfigMap/release-name-substra-backend-wait-init-migrations","object":{"apiVersion":"v1","data":{"wait-init-migration.sh":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-wait-init-migrations"},"sourcePath":"templates/substra-backend_template.yaml:28"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3504026211/api=/v1//ConfigMap/release-name-substra-backend-orchestrator","object":{"apiVersion":"v1","data":{"CHANNELS":"XXXXXX","MSP_ID":"XXXXXX","ORCHESTRATOR_HOST":"XXXXXX","ORCHESTRATOR_MTLS_ENABLED":"XXXXXX","ORCHESTRATOR_PORT":"XXXXXX","ORCHESTRATOR_TLS_CLIENT_CERT_PATH":"XXXXXX","ORCHESTRATOR_TLS_CLIENT_KEY_PATH":"XXXXXX","ORCHESTRATOR_TLS_ENABLED":"XXXXXX","ORCHESTRATOR_TLS_SERVER_CACERT_PATH":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-orchestrator"},"sourcePath":"templates/substra-backend_template.yaml:23"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3698181603/api=/v1//ServiceAccount/release-name-substra-backend-builder","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-builder"},"sourcePath":"templates/substra-backend_template.yaml:5"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3731736841/api=/v1//ServiceAccount/release-name-substra-backend-api-event","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-api-event"},"sourcePath":"templates/substra-backend_template.yaml:7"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=1658341026/api=/v1/default/ConfigMap/release-name-redis-health","object":{"apiVersion":"v1","data":{"ping_liveness_local.sh":"XXXXXX","ping_liveness_local_and_master.sh":"XXXXXX","ping_liveness_master.sh":"XXXXXX","ping_readiness_local.sh":"XXXXXX","ping_readiness_local_and_master.sh":"XXXXXX","ping_readiness_master.sh":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis-health","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:19"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-scheduler-worker","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-scheduler-worker"},"sourcePath":"templates/substra-backend_template.yaml:52","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-scheduler-worker"}},"template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-redis":"264b5affa56b5e88eed5ddc20e36253edbba046a4631250fd0addf3c962a9f84","checksum-cm-registry":"0a84c216ae57353e86de39a9fa289078c50f82f64f945f9f7b672c8c123e8236","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-scheduler-worker","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"scheduler-worker","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","celery -A backend worker -l info -n owkin -Q owkin,scheduler,celery --hostname owkin.scheduler"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"configMapRef":{"name":"release-name-substra-backend-registry"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"NODE_NAME","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"spec.nodeName"}}},{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"}],"resources":{"limits":{"cpu":"250m","memory":"400Mi"},"requests":{"cpu":"50m","memory":"50Mi"}},"imagePullPolicy":"IfNotPresent"}],"initContainers":null,"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"volumes":null}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{"helm.sh/hook":"post-install,post-upgrade","helm.sh/hook-delete-policy":"before-hook-creation"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"release-name-substra-backend-migrations","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-migrations"},"sourcePath":"templates/substra-backend_template.yaml:60","spec":{"template":{"metadata":{"name":"release-name-substra-backend-migrations"},"spec":{"automountServiceAccountToken":false,"containers":[{"name":"db-migrations","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash","-c"],"args":["set -euo pipefail\n./manage.py migrate\n\n## Users\nwhile read -r user_password_channel; do\n    read user password channel \u003c\u003c\u003c \"$user_password_channel\"\n    ./manage.py add_user \"$user\" \"$password\" \"$channel\"\ndone \u003c /accounts/users\n\n## IncomingOrganization\nwhile read -r user_password; do\n    read user password \u003c\u003c\u003c \"$user_password\"\n    ./manage.py create_incoming_organization \"$user\" \"$password\"\ndone \u003c /accounts/incoming_organizations\n\n## OutgoingOrganization\nwhile read -r user_password; do\n    read user password \u003c\u003c\u003c \"$user_password\"\n    ./manage.py create_outgoing_organization \"$user\" \"$password\"\ndone \u003c /accounts/outgoing_organizations\n"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"}],"resources":{},"volumeMounts":[{"name":"accounts","readOnly":true,"mountPath":"/accounts"}],"imagePullPolicy":"IfNotPresent"}],"restartPolicy":"OnFailure","securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"volumes":[{"name":"accounts","secret":{"secretName":"release-name-substra-backend-add-account"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-scheduler","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-scheduler"},"sourcePath":"templates/substra-backend_template.yaml:53","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-scheduler"}},"template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-redis":"264b5affa56b5e88eed5ddc20e36253edbba046a4631250fd0addf3c962a9f84","checksum-cm-registry":"0a84c216ae57353e86de39a9fa289078c50f82f64f945f9f7b672c8c123e8236","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-scheduler","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"scheduler","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","celery -A backend beat -l debug --schedule /var/substra/runtime-db/celerybeat-scheduler"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"configMapRef":{"name":"release-name-substra-backend-registry"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"NODE_NAME","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"spec.nodeName"}}},{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"}],"resources":{"limits":{"cpu":"250m","memory":"400Mi"},"requests":{"cpu":"50m","memory":"50Mi"}},"volumeMounts":[{"name":"runtime-db","mountPath":"/var/substra/runtime-db"}],"imagePullPolicy":"IfNotPresent"}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"volumes":[{"emptyDir":{},"name":"runtime-db"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3681403984/api=/v1//ServiceAccount/release-name-substra-backend-worker","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker"},"sourcePath":"templates/substra-backend_template.yaml:4"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"//ServiceAccount/release-name-substra-backend-event/path=3554506163/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-worker-event/path=3755837591/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker-event","object":{"kind":"ServiceAccount","name":"release-name-substra-backend-event","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker-event"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-worker-event"},"sourcePath":"templates/substra-backend_template.yaml:38","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-event"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker-event"},"rules":[{"apiGroups":["apps"],"resources":["statefulsets/scale"],"verbs":["get"]}],"sourcePath":"templates/substra-backend_template.yaml:34"}]}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-builder","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-builder"},"sourcePath":"templates/substra-backend_template.yaml:58","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-builder"}},"serviceName":"release-name-substra-backend-builder","template":{"metadata":{"annotations":{"checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-objectstore":"6d97165cffab02b7858e66effcd5f9366495029d5e605ffe3ed4b8ba40a2e612","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/component":"substra-builder","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-builder","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"builder","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash","-c"],"args":["celery -A backend worker -E -l info -Q owkin.builder,owkin.builder-${HOSTNAME##*-},owkin.broadcast --hostname owkin.builder-${HOSTNAME##*-}"],"ports":[{"name":"http","containerPort":8000,"protocol":"TCP"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"configMapRef":{"name":"release-name-substra-backend-registry"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"secretRef":{"name":"release-name-substra-backend-objectstore"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"HOST_IP","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"status.hostIP"}}},{"name":"POD_IP","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"status.podIP"}}},{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"},{"name":"DEFAULT_DOMAIN","value":"XXXXXX"},{"name":"CELERY_WORKER_CONCURRENCY","value":"XXXXXX"},{"name":"WORKER_PVC_DOCKER_CACHE","value":"XXXXXX"},{"name":"WORKER_PVC_SUBTUPLE","value":"XXXXXX"},{"name":"PRIVATE_CA_ENABLED","value":"XXXXXX"},{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"NODE_NAME","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"spec.nodeName"}}},{"name":"KANIKO_DOCKER_CONFIG_SECRET_NAME","value":"XXXXXX"},{"name":"OBJECTSTORE_URL","value":"XXXXXX"},{"name":"KANIKO_RESOURCES","value":"XXXXXX"}],"resources":{"limits":{"cpu":"2","memory":"8Gi"},"requests":{"cpu":"200m","memory":"512Mi"}},"volumeMounts":[{"name":"subtuple","mountPath":"/var/substra/medias/subtuple"}],"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","until pg_isready --host=release-name-postgresql.default --port=5432; do echo \"Waiting for postgresql service\"; sleep 2; done;"],"env":[{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"postgres"},{"name":"PGDATABASE","value":"substra"}],"image":"postgres","name":"wait-postgresql"},{"command":["dockerize","-wait","tcp://release-name-minio:9000","-timeout","15s"],"image":"jwilder/dockerize:0.6.1","name":"wait-minio"}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"serviceAccountName":"release-name-substra-backend-builder","volumes":null}},"volumeClaimTemplates":[{"metadata":{"name":"subtuple"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}}},{"metadata":{"name":"docker-cache"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3487248592/api=/v1//ConfigMap/release-name-substra-backend-oidc","object":{"apiVersion":"v1","data":{"OIDC_ENABLED":"XXXXXX","OIDC_OP_AUTHORIZATION_ENDPOINT":"XXXXXX","OIDC_OP_DISPLAY_NAME":"XXXXXX","OIDC_OP_JWKS_URI":"XXXXXX","OIDC_OP_TOKEN_ENDPOINT":"XXXXXX","OIDC_OP_URL":"XXXXXX","OIDC_OP_USER_ENDPOINT":"XXXXXX","OIDC_RP_SIGN_ALGO":"XXXXXX","OIDC_USERS_APPEND_DOMAIN":"XXXXXX","OIDC_USERS_DEFAULT_CHANNEL":"XXXXXX","OIDC_USERS_LOGIN_VALIDITY_DURATION":"XXXXXX","OIDC_USERS_MUST_BE_APPROVED":"XXXXXX","OIDC_USERS_USE_REFRESH_TOKEN":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-oidc"},"sourcePath":"templates/substra-backend_template.yaml:22"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3782069698/api=/v1/default/ServiceAccount/release-name-minio","object":{"apiVersion":"v1","automountServiceAccountToken":true,"kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"minio","app.kubernetes.io/version":"2023.9.30","helm.sh/chart":"minio-12.8.12"},"name":"release-name-minio","namespace":"default"},"secrets":[{"name":"release-name-minio"}],"sourcePath":"templates/substra-backend_template.yaml:2"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3588061401/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker","object":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-worker"},"sourcePath":"templates/substra-backend_template.yaml:36","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-worker"}]},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3755837591/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker-event","object":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker-event"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-worker-event"},"sourcePath":"templates/substra-backend_template.yaml:38","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-event"}]},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"//ServiceAccount/release-name-substra-backend-builder/path=3571283782/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-builder/path=3638394258/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-builder","object":{"kind":"ServiceAccount","name":"release-name-substra-backend-builder","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-builder"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-builder"},"sourcePath":"templates/substra-backend_template.yaml:37","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-builder"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-builder"},"rules":[{"apiGroups":[""],"resources":["pods/log","pods/status"],"verbs":["get","list","watch"]},{"apiGroups":[""],"resources":["pods","pods/exec","secrets"],"verbs":["get","list","watch","create","update","patch","delete"]},{"apiGroups":[""],"resources":["services"],"verbs":["get"]}],"sourcePath":"templates/substra-backend_template.yaml:33"}]}},{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis-master","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:57","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"redis"}},"serviceName":"release-name-redis-headless","template":{"metadata":{"annotations":{"checksum/configmap":"6b43007e91db6e015984e1074078f28383a277b606e80be84314fd73e558922d","checksum/health":"aff24913d801436ea469d8d374b2ddb3ec4c43ee7ab24663d5f8ff1a1b6991a9","checksum/scripts":"560c33ff34d845009b51830c332aa05fa211444d1877d3526d3599be7543aaa5","checksum/secret":"5c1a2f40d70b5c07f99cb8cbb9d9c99fa0b5aa688b89c0a608a6564626f447f7"},"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"}},"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"redis"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"automountServiceAccountToken":false,"containers":[{"name":"redis","image":"docker.io/bitnami/redis:7.2.4-debian-12-r9","command":["/bin/bash"],"args":["-c","/opt/bitnami/scripts/start-scripts/start-master.sh"],"ports":[{"name":"redis","containerPort":6379}],"env":[{"name":"BITNAMI_DEBUG","value":"XXXXXX"},{"name":"REDIS_REPLICATION_MODE","value":"XXXXXX"},{"name":"ALLOW_EMPTY_PASSWORD","value":"XXXXXX"},{"name":"REDIS_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-redis","key":"redis-password"}}},{"name":"REDIS_TLS_ENABLED","value":"XXXXXX"},{"name":"REDIS_PORT","value":"XXXXXX"}],"resources":{"limits":{"cpu":"500m","memory":"1Gi"},"requests":{"cpu":"50m","memory":"256Mi"}},"volumeMounts":[{"name":"start-scripts","mountPath":"/opt/bitnami/scripts/start-scripts"},{"name":"health","mountPath":"/health"},{"name":"redis-data","mountPath":"/data"},{"name":"config","mountPath":"/opt/bitnami/redis/mounted-etc"},{"name":"empty-dir","mountPath":"/opt/bitnami/redis/etc/","subPath":"app-conf-dir"},{"name":"empty-dir","mountPath":"/tmp","subPath":"tmp-dir"}],"livenessProbe":{"exec":{"command":["sh","-c","/health/ping_liveness_local.sh 5"]},"initialDelaySeconds":20,"timeoutSeconds":6,"periodSeconds":5,"successThreshold":1,"failureThreshold":5},"readinessProbe":{"exec":{"command":["sh","-c","/health/ping_readiness_local.sh 1"]},"initialDelaySeconds":20,"timeoutSeconds":2,"periodSeconds":5,"successThreshold":1,"failureThreshold":5},"imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["ALL"]},"runAsUser":1001,"runAsGroup":0,"runAsNonRoot":true,"readOnlyRootFilesystem":false,"allowPrivilegeEscalation":false,"seccompProfile":{"type":"RuntimeDefault"}}}],"enableServiceLinks":true,"securityContext":{"fsGroup":1001,"fsGroupChangePolicy":"Always","supplementalGroups":[],"sysctls":[]},"serviceAccountName":"release-name-redis-master","terminationGracePeriodSeconds":30,"volumes":[{"configMap":{"defaultMode":493,"name":"release-name-redis-scripts"},"name":"start-scripts"},{"configMap":{"defaultMode":493,"name":"release-name-redis-health"},"name":"health"},{"configMap":{"name":"release-name-redis-configuration"},"name":"config"},{"emptyDir":{},"name":"empty-dir"}]}},"updateStrategy":{"type":"RollingUpdate"},"volumeClaimTemplates":[{"apiVersion":"v1","kind":"PersistentVolumeClaim","metadata":{"labels":{"app.kubernetes.io/component":"master","app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"redis"},"name":"redis-data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"8Gi"}}}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"/default/Deployment/release-name-docker-registry","object":{"kind":"Deployment","name":"release-name-docker-registry","namespace":"default","relatedObjects":{"apiVersion":"v1","kind":"Service","metadata":{"labels":{"app":"docker-registry","chart":"docker-registry-2.2.2","heritage":"Helm","release":"release-name"},"name":"release-name-docker-registry","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:40","spec":{"ports":[{"name":"http-5000","port":5000,"protocol":"TCP","targetPort":5000}],"selector":{"app":"docker-registry","release":"release-name"},"type":"NodePort"}}}},{"resourceID":"//ServiceAccount/release-name-substra-backend-api-event/path=3537728544/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-api-event/path=3739059972/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-api-event","object":{"kind":"ServiceAccount","name":"release-name-substra-backend-api-event","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-api-event"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-api-event"},"sourcePath":"templates/substra-backend_template.yaml:39","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-api-event"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-api-event"},"rules":[{"apiGroups":["apps"],"resources":["statefulsets/scale"],"verbs":["get"]}],"sourcePath":"templates/substra-backend_template.yaml:35"}]}},{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-server","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-server"},"sourcePath":"templates/substra-backend_template.yaml:54","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-server"}},"template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-objectstore":"6d97165cffab02b7858e66effcd5f9366495029d5e605ffe3ed4b8ba40a2e612"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-server","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"server","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","uwsgi --ini uwsgi.ini"],"ports":[{"name":"http","containerPort":8000,"protocol":"TCP"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"secretRef":{"name":"release-name-substra-backend-objectstore"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"secretRef":{"name":"release-name-substra-backend-database"}},{"secretRef":{"name":"release-name-substra-backend-server-key"}},{"configMapRef":{"name":"release-name-substra-backend-oidc"}}],"env":[{"name":"HOST_IP","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"status.hostIP"}}},{"name":"POD_IP","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"status.podIP"}}}],"resources":{"limits":{"cpu":"2","memory":"12Gi"},"requests":{"cpu":"200m","memory":"512Mi"}},"volumeMounts":[{"name":"data-servermedias","mountPath":"/var/substra/servermedias"},{"name":"statics","mountPath":"/usr/src/app/backend/statics"},{"name":"uwsgi","readOnly":true,"mountPath":"/usr/src/app/uwsgi.ini","subPath":"uwsgi.ini"},{"name":"runtime-secrets","mountPath":"/var/substra/runtime-secrets"}],"livenessProbe":{"httpGet":{"path":"/liveness","port":"http"},"initialDelaySeconds":60,"timeoutSeconds":5,"periodSeconds":45,"successThreshold":1,"failureThreshold":6},"readinessProbe":{"httpGet":{"path":"/readiness","port":"http"},"initialDelaySeconds":5,"timeoutSeconds":2,"periodSeconds":30,"successThreshold":1,"failureThreshold":3},"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["python","manage.py","collectstatic","--noinput"],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"backend.settings.prod"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}}],"image":"ghcr.io/substra/substra-backend:0.45.0","name":"init-collectstatic","volumeMounts":[{"mountPath":"/usr/src/app/backend/statics","name":"statics"}]},{"command":["sh","-c","until pg_isready --host=release-name-postgresql.default --port=5432; do echo \"Waiting for postgresql service\"; sleep 2; done;"],"env":[{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"postgres"},{"name":"PGDATABASE","value":"substra"}],"image":"postgres","name":"wait-postgresql"},{"command":["python","manage.py","migrate"],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"backend.settings.prod"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"secretRef":{"name":"release-name-substra-backend-objectstore"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"image":"ghcr.io/substra/substra-backend:0.45.0","name":"init-migrate"},{"command":["dockerize","-wait","tcp://release-name-minio:9000","-timeout","15s"],"image":"jwilder/dockerize:0.6.1","name":"wait-minio"}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"volumes":[{"name":"data-servermedias","persistentVolumeClaim":{"claimName":"release-name-substra-backend-servermedias"}},{"emptyDir":{},"name":"statics"},{"emptyDir":{},"name":"runtime-secrets"},{"configMap":{"name":"release-name-substra-backend-server-uwsgi"},"name":"uwsgi"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3587914306/api=/v1//ConfigMap/release-name-substra-backend-redis","object":{"apiVersion":"v1","data":{"CELERY_BROKER_HOST":"XXXXXX","CELERY_BROKER_PORT":"XXXXXX","CELERY_BROKER_USER":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-redis"},"sourcePath":"templates/substra-backend_template.yaml:24"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=1675118645/api=/v1/default/ConfigMap/release-name-redis-configuration","object":{"apiVersion":"v1","data":{"master.conf":"XXXXXX","redis.conf":"XXXXXX","replica.conf":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis-configuration","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:18"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-worker-events","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker-events"},"sourcePath":"templates/substra-backend_template.yaml:55","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-worker-events"}},"template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-redis":"264b5affa56b5e88eed5ddc20e36253edbba046a4631250fd0addf3c962a9f84","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-worker-events","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"worker-event-app","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","python manage.py consume"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"}],"resources":{"limits":{"cpu":"500m","memory":"400Mi"},"requests":{"cpu":"100m","memory":"50Mi"}},"readinessProbe":{"exec":{"command":["cat","/tmp/ready"]},"initialDelaySeconds":5,"periodSeconds":20},"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","until pg_isready --host=release-name-postgresql.default --port=5432; do echo \"Waiting for postgresql service\"; sleep 2; done;"],"env":[{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"postgres"},{"name":"PGDATABASE","value":"substra"}],"image":"postgres","name":"wait-postgresql"},{"command":["bash","/usr/src/app/wait-init-migration.sh"],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"backend.settings.prod"}],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"image":"ghcr.io/substra/substra-backend:0.45.0","name":"wait-init-migrations","volumeMounts":[{"mountPath":"/usr/src/app/wait-init-migration.sh","name":"volume-wait-init-migrations","subPath":"wait-init-migration.sh"}]}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"serviceAccountName":"release-name-substra-backend-event","volumes":[{"configMap":{"name":"release-name-substra-backend-wait-init-migrations"},"name":"volume-wait-init-migrations"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3748514460/api=networking.k8s.io/v1/default/NetworkPolicy/release-name-redis","object":{"apiVersion":"networking.k8s.io/v1","kind":"NetworkPolicy","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:0","spec":{"egress":[{}],"ingress":[{"ports":[{"port":6379}]}],"podSelector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"redis"}},"policyTypes":["Ingress","Egress"]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3798847317/api=/v1/default/ServiceAccount/release-name-redis-master","object":{"apiVersion":"v1","automountServiceAccountToken":false,"kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"redis","app.kubernetes.io/version":"7.2.4","helm.sh/chart":"redis-18.17.0"},"name":"release-name-redis-master","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:3"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3537581449/api=/v1//ConfigMap/release-name-substra-backend-database","object":{"apiVersion":"v1","data":{"DATABASE_DATABASE":"XXXXXX","DATABASE_HOSTNAME":"XXXXXX","DATABASE_PORT":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-database"},"sourcePath":"templates/substra-backend_template.yaml:21"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3604691925/api=/v1//ConfigMap/release-name-substra-backend-registry","object":{"apiVersion":"v1","data":{"REGISTRY":"XXXXXX","REGISTRY_IS_LOCAL":"XXXXXX","REGISTRY_PULL_DOMAIN":"XXXXXX","REGISTRY_SCHEME":"XXXXXX","REGISTRY_SERVICE_NAME":"XXXXXX","USER_IMAGE_REPOSITORY":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-registry"},"sourcePath":"templates/substra-backend_template.yaml:25"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-worker","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker"},"sourcePath":"templates/substra-backend_template.yaml:59","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"substra-backend-worker"}},"serviceName":"release-name-substra-backend-worker","template":{"metadata":{"annotations":{"checksum-cm-db":"33c676bec9db656cba3d03e10ea865cc06cc0c014f15ffbd818e5437d2b36cf8","checksum-cm-orchestrator":"7fb58d3e25fbd6ea6acbb5588dbffc9a5706f7bbc4f299c048d580f34893d7f8","checksum-cm-redis":"264b5affa56b5e88eed5ddc20e36253edbba046a4631250fd0addf3c962a9f84","checksum-cm-registry":"0a84c216ae57353e86de39a9fa289078c50f82f64f945f9f7b672c8c123e8236","checksum-cm-settings":"1f882f1a5e1e5b5fb543b21fe957c242de5971fd5692637bf5380133e2bc8558","checksum-secret-database":"240d15002756a2f3814b00b45a923d1a3d38e2f161bd09b400bf1ca275fdea81","checksum-secret-objectstore":"6d97165cffab02b7858e66effcd5f9366495029d5e605ffe3ed4b8ba40a2e612","checksum-secret-redis":"e9f2847d2e2a087f31f994f2aed36bef1958307dd134c7854cf9da3756cc519c"},"labels":{"app.kubernetes.io/component":"substra-worker","app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend-worker","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"}},"spec":{"containers":[{"name":"worker","image":"ghcr.io/substra/substra-backend:0.45.0","command":["/bin/bash"],"args":["-c","celery -A backend worker -E -l info -Q owkin.worker,owkin.worker-${HOSTNAME##*-},owkin.broadcast,celery --hostname owkin.worker-${HOSTNAME##*-}"],"envFrom":[{"configMapRef":{"name":"release-name-substra-backend-orchestrator"}},{"configMapRef":{"name":"release-name-substra-backend-settings"}},{"configMapRef":{"name":"release-name-substra-backend-database"}},{"configMapRef":{"name":"release-name-substra-backend-redis"}},{"configMapRef":{"name":"release-name-substra-backend-registry"}},{"secretRef":{"name":"release-name-substra-backend-objectstore"}},{"secretRef":{"name":"release-name-substra-backend-redis"}},{"secretRef":{"name":"release-name-substra-backend-database"}}],"env":[{"name":"DJANGO_SETTINGS_MODULE","value":"XXXXXX"},{"name":"DEFAULT_DOMAIN","value":"XXXXXX"},{"name":"CELERY_WORKER_CONCURRENCY","value":"XXXXXX"},{"name":"WORKER_PVC_SUBTUPLE","value":"XXXXXX"},{"name":"NAMESPACE","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}},{"name":"NODE_NAME","value":"XXXXXX","valueFrom":{"fieldRef":{"fieldPath":"spec.nodeName"}}},{"name":"COMPUTE_POD_RESOURCES","value":"XXXXXX"},{"name":"COMPUTE_POD_MAX_STARTUP_WAIT_SECONDS","value":"XXXXXX"},{"name":"OBJECTSTORE_URL","value":"XXXXXX"},{"name":"ENABLE_DATASAMPLE_STORAGE_IN_SERVERMEDIAS","value":"XXXXXX"}],"resources":{"limits":{"cpu":"2","memory":"8Gi"},"requests":{"cpu":"200m","memory":"512Mi"}},"volumeMounts":[{"name":"subtuple","mountPath":"/var/substra/medias/subtuple"}],"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","until pg_isready --host=release-name-postgresql.default --port=5432; do echo \"Waiting for postgresql service\"; sleep 2; done;"],"env":[{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"postgres"},{"name":"PGDATABASE","value":"substra"}],"image":"postgres","name":"wait-postgresql"},{"command":["dockerize","-wait","tcp://release-name-minio:9000","-timeout","15s"],"image":"jwilder/dockerize:0.6.1","name":"wait-minio"}],"securityContext":{"fsGroup":1001,"runAsGroup":1001,"runAsUser":1001},"serviceAccountName":"release-name-substra-backend-worker","volumes":null}},"volumeClaimTemplates":[{"metadata":{"name":"subtuple"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"docker-registry","chart":"docker-registry-2.2.2","heritage":"Helm","release":"release-name"},"name":"release-name-docker-registry","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:49","spec":{"minReadySeconds":5,"replicas":1,"selector":{"matchLabels":{"app":"docker-registry","release":"release-name"}},"template":{"metadata":{"annotations":{"checksum/config":"9e4f80a4e5b81e5962c947178afa733ac81915e76dd15841779195bc6f404b5c","checksum/secret":"413c31a99873ec1df5bcce097927aff65e79eb1c350de7683dba55de66508542"},"labels":{"app":"docker-registry","release":"release-name"}},"spec":{"containers":[{"name":"docker-registry","image":"registry:2.8.1","command":["/bin/registry","serve","/etc/docker/registry/config.yml"],"ports":[{"containerPort":5000}],"env":[{"name":"REGISTRY_HTTP_SECRET","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-docker-registry-secret","key":"haSharedSecret"}}},{"name":"REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY","value":"XXXXXX"},{"name":"REGISTRY_STORAGE_DELETE_ENABLED","value":"XXXXXX"}],"resources":{"limits":{"cpu":"500m","memory":"64Gi"},"requests":{"cpu":"100m","memory":"256Mi"}},"volumeMounts":[{"name":"release-name-docker-registry-config","mountPath":"/etc/docker/registry"},{"name":"data","mountPath":"/var/lib/registry/"}],"livenessProbe":{"httpGet":{"path":"/","port":5000}},"readinessProbe":{"httpGet":{"path":"/","port":5000}},"imagePullPolicy":"IfNotPresent"}],"securityContext":{"fsGroup":1000,"runAsUser":1000},"volumes":[{"configMap":{"name":"release-name-docker-registry-config"},"name":"release-name-docker-registry-config"},{"name":"data","persistentVolumeClaim":{"claimName":"release-name-docker-registry"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"//ServiceAccount/release-name-substra-backend-worker/path=3588061401/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker/path=3655171877/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-worker","object":{"kind":"ServiceAccount","name":"release-name-substra-backend-worker","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-substra-backend-worker"},"sourcePath":"templates/substra-backend_template.yaml:36","subjects":[{"kind":"ServiceAccount","name":"release-name-substra-backend-worker"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"substra-backend","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-worker"},"rules":[{"apiGroups":[""],"resources":["secrets"],"verbs":["get","watch","list"]},{"apiGroups":[""],"resources":["pods/log","pods/status"],"verbs":["get","list","watch"]},{"apiGroups":[""],"resources":["pods","pods/exec"],"verbs":["get","list","watch","create","update","patch","delete"]},{"apiGroups":[""],"resources":["services"],"verbs":["get"]}],"sourcePath":"templates/substra-backend_template.yaml:32"}]}},{"resourceID":"path=3571136687/api=/v1//ConfigMap/release-name-substra-backend-settings","object":{"apiVersion":"v1","data":{"BUILDER_ENABLED":"XXXXXX","COMMON_HOST_DOMAIN":"XXXXXX","COMPUTE_POD_FS_GROUP":"XXXXXX","COMPUTE_POD_RUN_AS_GROUP":"XXXXXX","COMPUTE_POD_RUN_AS_USER":"XXXXXX","DEFAULT_DOMAIN":"XXXXXX","ENABLE_DATASAMPLE_STORAGE_IN_SERVERMEDIAS":"XXXXXX","EXPIRY_TOKEN_ENABLED":"XXXXXX","KANIKO_IMAGE":"XXXXXX","KANIKO_MIRROR":"XXXXXX","MEDIA_ROOT":"XXXXXX","OBJECTSTORE_URL":"XXXXXX","ORG_NAME":"XXXXXX","SERVERMEDIAS_ROOT":"XXXXXX","SUBTUPLE_DIR":"XXXXXX","WORKER_REPLICA_SET_NAME":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/part-of":"substra-backend","app.kubernetes.io/version":"0.45.0","helm.sh/chart":"substra-backend-26.4.0"},"name":"release-name-substra-backend-settings"},"sourcePath":"templates/substra-backend_template.yaml:27"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}},{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"minio","app.kubernetes.io/version":"2023.9.30","helm.sh/chart":"minio-12.8.12"},"name":"release-name-minio","namespace":"default"},"sourcePath":"templates/substra-backend_template.yaml:50","spec":{"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"minio"}},"strategy":{"type":"Recreate"},"template":{"metadata":{"annotations":{"checksum/credentials-secret":"81c38367c3b2ea066728e839e17a74efbc7d210e71732d782be721ed1baa4dfe"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"minio","app.kubernetes.io/version":"2023.9.30","helm.sh/chart":"minio-12.8.12"}},"spec":{"affinity":{"nodeAffinity":null,"podAffinity":null,"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"minio"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"containers":[{"name":"minio","image":"docker.io/bitnami/minio:2023.9.30-debian-11-r2","ports":[{"name":"minio-api","containerPort":9000,"protocol":"TCP"},{"name":"minio-console","containerPort":9001,"protocol":"TCP"}],"env":[{"name":"BITNAMI_DEBUG","value":"XXXXXX"},{"name":"MINIO_SCHEME","value":"XXXXXX"},{"name":"MINIO_FORCE_NEW_KEYS","value":"XXXXXX"},{"name":"MINIO_ROOT_USER","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-minio","key":"root-user"}}},{"name":"MINIO_ROOT_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-minio","key":"root-password"}}},{"name":"MINIO_BROWSER","value":"XXXXXX"},{"name":"MINIO_PROMETHEUS_AUTH_TYPE","value":"XXXXXX"},{"name":"MINIO_CONSOLE_PORT_NUMBER","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"64Gi"},"requests":{"cpu":"100m","memory":"1Gi"}},"volumeMounts":[{"name":"data","mountPath":"/bitnami/minio/data"}],"livenessProbe":{"httpGet":{"path":"/minio/health/live","port":"minio-api","scheme":"HTTP"},"initialDelaySeconds":5,"timeoutSeconds":5,"periodSeconds":5,"successThreshold":1,"failureThreshold":5},"readinessProbe":{"tcpSocket":{"port":"minio-api"},"initialDelaySeconds":5,"timeoutSeconds":1,"periodSeconds":5,"successThreshold":1,"failureThreshold":5},"imagePullPolicy":"IfNotPresent","securityContext":{"capabilities":{"drop":["ALL"]},"runAsUser":1001,"runAsNonRoot":true,"allowPrivilegeEscalation":false}}],"securityContext":{"fsGroup":1001,"seccompProfile":{"type":"RuntimeDefault"}},"serviceAccountName":"release-name-minio","volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"release-name-minio"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/substra-backend_template.yaml","fileType":"YAML","lastCommit":{"date":"0001-01-01T00:00:00Z"}}}],"attributes":null,"results":[{"resourceID":"path=3714959222/api=/v1//ServiceAccount/release-name-substra-backend-event","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3536742806/api=apps/v1//Deployment/release-name-substra-backend-api-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=1691896264/api=/v1/default/ConfigMap/release-name-docker-registry-config","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3520803830/api=/v1/default/ConfigMap/release-name-redis-scripts","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3554359068/api=/v1//ConfigMap/release-name-substra-backend-server-uwsgi","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3765292079/api=networking.k8s.io/v1//NetworkPolicy/release-name-substra-backend-deny-ingress","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]}]},{"resourceID":"path=3571283782/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-builder","controls":[{"controlID":"C-0262","name":"Anonymous access enabled","status":{"status":"passed"},"rules":[{"name":"anonymous-access-enabled","status":"passed","subStatus":""}]}]},{"resourceID":"path=3739059972/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-api-event","controls":[{"controlID":"C-0262","name":"Anonymous access enabled","status":{"status":"passed"},"rules":[{"name":"anonymous-access-enabled","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3587075663/api=apps/v1/default/StatefulSet/release-name-postgresql","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3587075663/api=apps/v1/default/StatefulSet/release-name-postgresql","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3587075663/api=apps/v1/default/StatefulSet/release-name-postgresql","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"passed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3587075663/api=apps/v1/default/StatefulSet/release-name-postgresql","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"passed"},"rules":[{"name":"linux-hardening","status":"passed","subStatus":""}]}]},{"resourceID":"path=3655024782/api=/v1//ConfigMap/release-name-substra-backend-wait-init-migrations","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3504026211/api=/v1//ConfigMap/release-name-substra-backend-orchestrator","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"failed","subStatus":"","paths":[{"resourceID":"path=3504026211/api=/v1//ConfigMap/release-name-substra-backend-orchestrator","failedPath":"data[ORCHESTRATOR_TLS_CLIENT_KEY_PATH]","fixPath":{"path":"","value":""}},{"resourceID":"path=3504026211/api=/v1//ConfigMap/release-name-substra-backend-orchestrator","deletePath":"data[ORCHESTRATOR_TLS_CLIENT_KEY_PATH]","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3698181603/api=/v1//ServiceAccount/release-name-substra-backend-builder","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"resourceID":"path=3731736841/api=/v1//ServiceAccount/release-name-substra-backend-api-event","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"resourceID":"path=1658341026/api=/v1/default/ConfigMap/release-name-redis-health","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3519965187/api=apps/v1//Deployment/release-name-substra-backend-scheduler-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3654333234/api=batch/v1//Job/release-name-substra-backend-migrations","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3503187568/api=apps/v1//Deployment/release-name-substra-backend-scheduler","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=3681403984/api=/v1//ServiceAccount/release-name-substra-backend-worker","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"resourceID":"//ServiceAccount/release-name-substra-backend-event/path=3554506163/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-worker-event/path=3755837591/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker-event","controls":[{"controlID":"C-0035","name":"Administrative Roles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0037","name":"CoreDNS poisoning","status":{"status":"passed"},"rules":[{"name":"rule-can-update-configmap-v1","status":"passed","subStatus":""}]},{"controlID":"C-0015","name":"List Kubernetes secrets","status":{"status":"passed"},"rules":[{"name":"rule-can-list-get-secrets-v1","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-subject-v1","status":"passed","subStatus":""}]},{"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":{"status":"passed"},"rules":[{"name":"exec-into-container-v1","status":"passed","subStatus":""}]},{"controlID":"C-0007","name":"Roles with delete capabilities","status":{"status":"passed"},"rules":[{"name":"rule-excessive-delete-rights-v1","status":"passed","subStatus":""}]},{"controlID":"C-0063","name":"Portforwarding privileges","status":{"status":"passed"},"rules":[{"name":"rule-can-portforward-v1","status":"passed","subStatus":""}]},{"controlID":"C-0188","name":"Minimize access to create pods","status":{"status":"passed"},"rules":[{"name":"rule-can-create-pod","status":"passed","subStatus":""}]},{"controlID":"C-0031","name":"Delete Kubernetes events","status":{"status":"passed"},"rules":[{"name":"rule-can-delete-k8s-events-v1","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","failedPath":"spec.template.spec.containers[0].env[10].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","failedPath":"spec.template.spec.containers[0].env[10].value","fixPath":{"path":"","value":""}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","deletePath":"spec.template.spec.containers[0].env[10].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","deletePath":"spec.template.spec.containers[0].env[10].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3687741377/api=apps/v1//StatefulSet/release-name-substra-backend-builder","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=3487248592/api=/v1//ConfigMap/release-name-substra-backend-oidc","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"failed","subStatus":"","paths":[{"resourceID":"path=3487248592/api=/v1//ConfigMap/release-name-substra-backend-oidc","failedPath":"data[OIDC_USERS_USE_REFRESH_TOKEN]","fixPath":{"path":"","value":""}},{"resourceID":"path=3487248592/api=/v1//ConfigMap/release-name-substra-backend-oidc","deletePath":"data[OIDC_USERS_USE_REFRESH_TOKEN]","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3782069698/api=/v1/default/ServiceAccount/release-name-minio","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"failed"},"rules":[{"name":"automount-service-account","status":"failed","subStatus":"","paths":[{"resourceID":"path=3782069698/api=/v1/default/ServiceAccount/release-name-minio","failedPath":"automountServiceAccountToken","fixPath":{"path":"","value":""}},{"resourceID":"path=3782069698/api=/v1/default/ServiceAccount/release-name-minio","deletePath":"automountServiceAccountToken","fixPath":{"path":"","value":""}}]}]}]},{"resourceID":"path=3588061401/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker","controls":[{"controlID":"C-0262","name":"Anonymous access enabled","status":{"status":"passed"},"rules":[{"name":"anonymous-access-enabled","status":"passed","subStatus":""}]}]},{"resourceID":"path=3755837591/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker-event","controls":[{"controlID":"C-0262","name":"Anonymous access enabled","status":{"status":"passed"},"rules":[{"name":"anonymous-access-enabled","status":"passed","subStatus":""}]}]},{"resourceID":"//ServiceAccount/release-name-substra-backend-builder/path=3571283782/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-builder/path=3638394258/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-builder","controls":[{"controlID":"C-0035","name":"Administrative Roles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0037","name":"CoreDNS poisoning","status":{"status":"passed"},"rules":[{"name":"rule-can-update-configmap-v1","status":"passed","subStatus":""}]},{"controlID":"C-0015","name":"List Kubernetes secrets","status":{"status":"passed"},"rules":[{"name":"rule-can-list-get-secrets-v1","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-subject-v1","status":"passed","subStatus":""}]},{"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":{"status":"passed"},"rules":[{"name":"exec-into-container-v1","status":"passed","subStatus":""}]},{"controlID":"C-0007","name":"Roles with delete capabilities","status":{"status":"passed"},"rules":[{"name":"rule-excessive-delete-rights-v1","status":"passed","subStatus":""}]},{"controlID":"C-0063","name":"Portforwarding privileges","status":{"status":"passed"},"rules":[{"name":"rule-can-portforward-v1","status":"passed","subStatus":""}]},{"controlID":"C-0188","name":"Minimize access to create pods","status":{"status":"passed"},"rules":[{"name":"rule-can-create-pod","status":"passed","subStatus":""}]},{"controlID":"C-0031","name":"Delete Kubernetes events","status":{"status":"passed"},"rules":[{"name":"rule-can-delete-k8s-events-v1","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","failedPath":"spec.template.spec.containers[0].env[2].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","failedPath":"spec.template.spec.containers[0].env[2].value","fixPath":{"path":"","value":""}},{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","deletePath":"spec.template.spec.containers[0].env[2].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","deletePath":"spec.template.spec.containers[0].env[2].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"passed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3570298044/api=apps/v1/default/StatefulSet/release-name-redis-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"passed"},"rules":[{"name":"linux-hardening","status":"passed","subStatus":""}]}]},{"resourceID":"/default/Deployment/release-name-docker-registry","controls":[{"controlID":"C-0042","name":"SSH server running inside container","status":{"status":"passed"},"rules":[{"name":"rule-can-ssh-to-pod-v1","status":"passed","subStatus":""}]}]},{"resourceID":"//ServiceAccount/release-name-substra-backend-api-event/path=3537728544/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-api-event/path=3739059972/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-api-event","controls":[{"controlID":"C-0035","name":"Administrative Roles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0037","name":"CoreDNS poisoning","status":{"status":"passed"},"rules":[{"name":"rule-can-update-configmap-v1","status":"passed","subStatus":""}]},{"controlID":"C-0015","name":"List Kubernetes secrets","status":{"status":"passed"},"rules":[{"name":"rule-can-list-get-secrets-v1","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-subject-v1","status":"passed","subStatus":""}]},{"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":{"status":"passed"},"rules":[{"name":"exec-into-container-v1","status":"passed","subStatus":""}]},{"controlID":"C-0007","name":"Roles with delete capabilities","status":{"status":"passed"},"rules":[{"name":"rule-excessive-delete-rights-v1","status":"passed","subStatus":""}]},{"controlID":"C-0063","name":"Portforwarding privileges","status":{"status":"passed"},"rules":[{"name":"rule-can-portforward-v1","status":"passed","subStatus":""}]},{"controlID":"C-0188","name":"Minimize access to create pods","status":{"status":"passed"},"rules":[{"name":"rule-can-create-pod","status":"passed","subStatus":""}]},{"controlID":"C-0031","name":"Delete Kubernetes events","status":{"status":"passed"},"rules":[{"name":"rule-can-delete-k8s-events-v1","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3620630901/api=apps/v1//Deployment/release-name-substra-backend-server","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=3587914306/api=/v1//ConfigMap/release-name-substra-backend-redis","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1675118645/api=/v1/default/ConfigMap/release-name-redis-configuration","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3603853282/api=apps/v1//Deployment/release-name-substra-backend-worker-events","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=3748514460/api=networking.k8s.io/v1/default/NetworkPolicy/release-name-redis","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]}]},{"resourceID":"path=3798847317/api=/v1/default/ServiceAccount/release-name-redis-master","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"resourceID":"path=3537581449/api=/v1//ConfigMap/release-name-substra-backend-database","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3604691925/api=/v1//ConfigMap/release-name-substra-backend-registry","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"passed"},"rules":[{"name":"non-root-containers","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3670963758/api=apps/v1//StatefulSet/release-name-substra-backend-worker","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3603706187/api=apps/v1/default/Deployment/release-name-docker-registry","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"//ServiceAccount/release-name-substra-backend-worker/path=3588061401/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-substra-backend-worker/path=3655171877/api=rbac.authorization.k8s.io/v1//Role/release-name-substra-backend-worker","controls":[{"controlID":"C-0035","name":"Administrative Roles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0037","name":"CoreDNS poisoning","status":{"status":"passed"},"rules":[{"name":"rule-can-update-configmap-v1","status":"passed","subStatus":""}]},{"controlID":"C-0015","name":"List Kubernetes secrets","status":{"status":"passed"},"rules":[{"name":"rule-can-list-get-secrets-v1","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-subject-v1","status":"passed","subStatus":""}]},{"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":{"status":"passed"},"rules":[{"name":"exec-into-container-v1","status":"passed","subStatus":""}]},{"controlID":"C-0007","name":"Roles with delete capabilities","status":{"status":"passed"},"rules":[{"name":"rule-excessive-delete-rights-v1","status":"passed","subStatus":""}]},{"controlID":"C-0063","name":"Portforwarding privileges","status":{"status":"passed"},"rules":[{"name":"rule-can-portforward-v1","status":"passed","subStatus":""}]},{"controlID":"C-0188","name":"Minimize access to create pods","status":{"status":"passed"},"rules":[{"name":"rule-can-create-pod","status":"passed","subStatus":""}]},{"controlID":"C-0031","name":"Delete Kubernetes events","status":{"status":"passed"},"rules":[{"name":"rule-can-delete-k8s-events-v1","status":"passed","subStatus":""}]}]},{"resourceID":"path=3571136687/api=/v1//ConfigMap/release-name-substra-backend-settings","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"failed","subStatus":"","paths":[{"resourceID":"path=3571136687/api=/v1//ConfigMap/release-name-substra-backend-settings","failedPath":"data[EXPIRY_TOKEN_ENABLED]","fixPath":{"path":"","value":""}},{"resourceID":"path=3571136687/api=/v1//ConfigMap/release-name-substra-backend-settings","deletePath":"data[EXPIRY_TOKEN_ENABLED]","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":8.8,"severity":2},"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","failedPath":"spec.template.spec.containers[0].env[2].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","failedPath":"spec.template.spec.containers[0].env[2].value","fixPath":{"path":"","value":""}},{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","deletePath":"spec.template.spec.containers[0].env[2].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","deletePath":"spec.template.spec.containers[0].env[2].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"failed"},"rules":[{"name":"automount-service-account","status":"failed","subStatus":"","paths":[{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","fixPath":{"path":"spec.template.spec.automountServiceAccountToken","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"passed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3553520425/api=apps/v1/default/Deployment/release-name-minio","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"passed"},"rules":[{"name":"linux-hardening","status":"passed","subStatus":""}]}]}],"metadata":{"targetMetadata":{"gitRepoContextMetadata":{"provider":"github","repo":"LLM-Helm-Fix","owner":"fminna","branch":"main","remoteURL":"https://github.com/fminna/LLM-Helm-Fix","lastCommit":{"hash":"f1a56b65a41cfbea43698f2172f4da510f5e0bbd","date":"0001-01-01T00:00:00Z"},"localRootPath":"/Applications/Utilities/repos/LLM-Helm-Fix"}},"clusterMetadata":{},"scanMetadata":{"targetType":"Framework","kubescapeVersion":"v3.0.1","formatVersion":"v2","formats":["json"],"targetNames":["clusterscan","mitre","nsa"],"failThreshold":100,"scanningTarget":3,"submit":true}},"paginationInfo":{"chunkNumber":0,"isLastChunk":false},"customerGUIDGenerated":false}