{"generationTime":"0001-01-01T00:00:00Z","clusterAPIServerInfo":null,"clusterCloudProvider":"","customerGUID":"","clusterName":"","reportGUID":"","jobID":"","summaryDetails":{"controls":{"C-0002":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":20.27027,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0030":{"statusInfo":{"status":"passed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":20,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0031":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0034":{"statusInfo":{"status":"passed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0042":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0053","name":"Access container service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0063":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0187":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"passed"},"controlID":"C-0260","name":"Missing network policy","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":25,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":6,"failedResources":13,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":52.845528,"complianceScore":31.578945,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":9,"failedResources":10,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":40.650406,"complianceScore":47.368423,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"status":"failed","frameworks":[{"controls":{"C-0002":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":20.27027,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0015":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0063":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0187":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"passed"},"controlID":"C-0260","name":"Missing network policy","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":25,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}}},"name":"ClusterScan","status":"failed","version":"","ResourceCounters":{"passedResources":6,"failedResources":19,"skippedResources":0,"excludedResources":0},"score":15.637991,"complianceScore":91.666664},{"controls":{"C-0002":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":20.27027,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0031":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0042":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0053","name":"Access container service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}}},"name":"MITRE","status":"failed","version":"","ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"score":5.051568,"complianceScore":98.52941},{"controls":{"C-0002":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":18,"failedResources":6,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":20.27027,"complianceScore":75,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0030":{"statusInfo":{"status":"passed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":20,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0034":{"statusInfo":{"status":"passed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":19,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":19,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":6,"failedResources":13,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":52.845528,"complianceScore":31.578945,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":9,"failedResources":10,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":40.650406,"complianceScore":47.368423,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"name":"NSA","status":"failed","version":"","ResourceCounters":{"passedResources":6,"failedResources":19,"skippedResources":0,"excludedResources":0},"score":31.635607,"complianceScore":71.26039}],"resourcesSeverityCounters":{"criticalSeverity":0,"highSeverity":29,"mediumSeverity":57,"lowSeverity":19},"controlsSeverityCounters":{"criticalSeverity":0,"highSeverity":3,"mediumSeverity":3,"lowSeverity":1},"ResourceCounters":{"passedResources":6,"failedResources":19,"skippedResources":0,"excludedResources":0},"score":24.28135,"complianceScore":83.93964},"resources":[{"resourceID":"path=2527770420/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-security-entrypoint","object":{"apiVersion":"v1","data":{"entrypoint.sh":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-security-config","heritage":"Helm","release":"release-name","role":"security-config"},"name":"release-name-ibm-dba-ek-elasticsearch-security-entrypoint"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:8"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2376771849/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-entrypoint","object":{"apiVersion":"v1","data":{"entrypoint.sh":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-elasticsearch","heritage":"Helm","release":"release-name"},"name":"release-name-ibm-dba-ek-elasticsearch-entrypoint"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:7"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2544548039/api=/v1//ConfigMap/release-name-bai-env","object":{"apiVersion":"v1","data":{"admin-username":"XXXXXX","bai-features":"XXXXXX","bpmn-end-aggregation-delay":"XXXXXX","egress-topic":"XXXXXX","elasticsearch-url":"XXXXXX","elasticsearch-username":"XXXXXX","es-config-version":"XXXXXX","flink-heap-memory":"XXXXXX","flink-job-checkpointing-interval":"XXXXXX","flink-job-elasticsearch-max-actions":"XXXXXX","flink-security-krb5-enable-hdfs":"XXXXXX","flink-security-krb5-enable-kafka":"XXXXXX","flink-security-krb5-kdc":"XXXXXX","flink-security-krb5-principal":"XXXXXX","flink-security-krb5-realm":"XXXXXX","flink-taskmanager-cpu-cores":"XXXXXX","ingress-topic":"XXXXXX","kafka-bootstrap-servers":"XXXXXX","kafka-sasl-kerberos-service-name":"XXXXXX","kafka-security-protocol":"XXXXXX","kafka-username":"XXXXXX","service-topic":"XXXXXX","storage-batch-size":"XXXXXX","storage-bucket-url":"XXXXXX","storage-inactive-bucket-check-interval-ms":"XXXXXX","storage-inactive-bucket-threshold-ms":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-env"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:9"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-flink-taskmanager"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:27","spec":{"podManagementPolicy":"Parallel","replicas":6,"selector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-taskmanager","heritage":"Helm","release":"release-name"}},"serviceName":"release-name-bai-flink-taskmanager-svc","template":{"metadata":{"annotations":{"checksum/config":"11df91aa48f5f4a1a5b793a5d25aae87d2d8f66922076070e627559d36cbe2cb","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-taskmanager","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-taskmanager","heritage":"Helm","release":"release-name"}},"topologyKey":"kubernetes.io/hostname"},"weight":100}]}},"containers":[{"name":"taskmanager","image":"ibmcom/bai-flink-dev:19.0.2","args":["taskmanager"],"ports":[{"name":"data","containerPort":6121},{"name":"rpc","containerPort":6122},{"name":"query","containerPort":6125}],"env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"HEAP_MEMORY","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-heap-memory"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_HDFS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-hdfs"}}},{"name":"FLINK_SECURITY_KRB5_REALM","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-realm"}}},{"name":"FLINK_SECURITY_KRB5_KDC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-kdc"}}},{"name":"FLINK_SECURITY_KRB5_PRINCIPAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-principal"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"CPU_CORES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-taskmanager-cpu-cores"}}},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}}],"resources":{"limits":{"cpu":"1","memory":"1536Mi"},"requests":{"cpu":"1","memory":"1280Mi"}},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-console.properties","subPath":"log4j-console.properties"},{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"},{"name":"kerberos-keytabs","readOnly":true,"mountPath":"/etc/krb5"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"TaskManagerRunner\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","wget https://release-name-bai-flink-jobmanager:8081/taskmanagers -qO- -T 5 --no-check-certificate | grep `hostname`"]},"initialDelaySeconds":10,"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-console.properties","path":"log4j-console.properties"},{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"kerberos-keytabs","secret":{"items":[{"key":"flink-security-krb5-keytab","path":"flink.keytab"}],"optional":true,"secretName":"release-name-bai-secrets"}},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"},{"key":"kafka-server-cert","path":"kafka-server-cert"},{"key":"elasticsearch-server-cert","path":"elasticsearch-server-cert"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}},"updateStrategy":{"type":"RollingUpdate"}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-admin"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:22","spec":{"replicas":1,"selector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-admin","heritage":"Helm","release":"release-name"}},"strategy":{"rollingUpdate":null,"type":"Recreate"},"template":{"metadata":{"annotations":{"checksum/config":"e692e81988f822b03269e902f0053d658b8a479e2a0c824be46d962388451e65","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-admin","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-admin","heritage":"Helm","release":"release-name"}},"topologyKey":"kubernetes.io/hostname"},"weight":100}]}},"containers":[{"name":"bai-admin","image":"ibmcom/bai-admin-dev:19.0.2","ports":[{"name":"admin-rest","containerPort":6892,"protocol":"TCP"}],"env":[{"name":"TAIGA_ADMIN_PORT","value":"XXXXXX"},{"name":"TAIGA_ADMIN_USER","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"admin-username"}}},{"name":"TAIGA_ADMIN_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"admin-password"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"KAFKA_KRB5_ENABLED","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"KAFKA_KRB5_REALM","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-realm"}}},{"name":"KAFKA_KRB5_KDC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-kdc"}}},{"name":"KAFKA_KRB5_PRINCIPAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-principal"}}},{"name":"KAFKA_KRB5_KEYTAB","value":"XXXXXX"},{"name":"KAFKA_SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}}],"resources":{"limits":{"memory":"120Mi"},"requests":{"cpu":"3m","memory":"50Mi"}},"volumeMounts":[{"name":"kerberos-keytabs","readOnly":true,"mountPath":"/etc/krb5"},{"name":"admin-ssl","readOnly":true,"mountPath":"/etc/admin-ssl"},{"name":"admin-server-ssl-key","mountPath":"/usr/src/taiga-admin/src/server/resources/local-server.key","subPath":"local-server.key"},{"name":"admin-server-ssl-crt","mountPath":"/usr/src/taiga-admin/src/server/resources/local-server.crt","subPath":"local-server.crt"}],"livenessProbe":{"httpGet":{"path":"/api/health","port":"admin-rest","scheme":"HTTPS"},"initialDelaySeconds":25,"timeoutSeconds":5,"periodSeconds":10},"readinessProbe":{"httpGet":{"path":"/api/health","port":"admin-rest","scheme":"HTTPS"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10},"securityContext":{"runAsUser":20181,"runAsNonRoot":true}}],"serviceAccountName":"default","volumes":[{"name":"kerberos-keytabs","secret":{"items":[{"key":"flink-security-krb5-keytab","path":"kafka.keytab"}],"optional":true,"secretName":"release-name-bai-secrets"}},{"name":"admin-ssl","secret":{"items":[{"key":"kafka-ca-cert","path":"kafka-ca.pem"}],"optional":true,"secretName":"release-name-bai-secrets"}},{"name":"admin-server-ssl-key","secret":{"items":[{"key":"admin-key","path":"local-server.key"}],"secretName":"release-name-bai-secrets"}},{"name":"admin-server-ssl-crt","secret":{"items":[{"key":"admin-cert","path":"local-server.crt"}],"secretName":"release-name-bai-secrets"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-master","heritage":"Helm","release":"release-name","role":"master"},"name":"release-name-ibm-dba-ek-master"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:25","spec":{"podManagementPolicy":"Parallel","replicas":1,"revisionHistoryLimit":3,"selector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-master","heritage":"Helm","release":"release-name","role":"master"}},"serviceName":"release-name-ibm-dba-ek-master","template":{"metadata":{"annotations":{"checksum/config":"bbe879468b78d97753935ab6b844d8eacd9444cc90f1119b50a9bf843c8e510a","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-master","heritage":"Helm","release":"release-name","role":"master"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-master","heritage":"Helm","release":"release-name","role":"master"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"containers":[{"name":"es-master","image":"ibmcom/bai-elasticsearch-dev:19.0.2","command":["/bin/bash","/scripts/entrypoint.sh"],"ports":[{"name":"transport","containerPort":9300,"protocol":"TCP"}],"env":[{"name":"ES_JAVA_OPTS","value":"XXXXXX"},{"name":"CFG_BASEDIR","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"2Gi"},"requests":{"cpu":"100m","memory":"1Gi"}},"volumeMounts":[{"name":"entrypoint","mountPath":"/scripts"},{"name":"data","mountPath":"/usr/share/elasticsearch/data"},{"name":"config","mountPath":"/usr/share/elasticsearch/ibm-dba-ek-config/elasticsearch.yml","subPath":"elasticsearch.yml"},{"name":"plugin-bundle","mountPath":"/usr/share/elasticsearch/plugin-bundles"}],"livenessProbe":{"tcpSocket":{"port":9300},"initialDelaySeconds":90},"readinessProbe":{"tcpSocket":{"port":9300},"initialDelaySeconds":90},"securityContext":{"runAsUser":1000,"runAsNonRoot":true}}],"initContainers":[{"command":["/bin/sh","-c","sysctl -w vm.max_map_count=262144 \u0026\u0026 sed -i '/^vm.max_map_count /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.max_map_count = 262144' \u003e\u003e /etc/sysctl.conf \u0026\u0026 sysctl -w vm.swappiness=1 \u0026\u0026 sed -i '/^vm.swappiness /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.swappiness=1' \u003e\u003e /etc/sysctl.conf"],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"sysctl","securityContext":{"privileged":true}},{"command":["/bin/sh","-c","mkdir -p /usr/share/elasticsearch/data/nodes \u0026\u0026 chown -R 1000:1000 /usr/share/elasticsearch/data; chmod ug+x /usr/share/elasticsearch/data /usr/share/elasticsearch/data/nodes"],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"initcontainer","securityContext":{"privileged":true},"volumeMounts":[{"mountPath":"/usr/share/elasticsearch/data","name":"data"}]}],"securityContext":{"fsGroup":1000},"serviceAccountName":"release-name-bai-psp-sa","volumes":[{"configMap":{"defaultMode":365,"items":[{"key":"entrypoint.sh","path":"entrypoint.sh"}],"name":"release-name-ibm-dba-ek-elasticsearch-entrypoint"},"name":"entrypoint"},{"configMap":{"items":[{"key":"master.yml","path":"elasticsearch.yml"}],"name":"release-name-ibm-dba-ek-elasticsearch-config"},"name":"config"},{"emptyDir":{"medium":""},"name":"plugin-bundle"}]}},"updateStrategy":{"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name"},"name":"data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"storageClassName":""}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","object":{"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{"helm.sh/hook":"test-success","helm.sh/hook-delete-policy":"hook-succeeded"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-admin-test","heritage":"Helm","release":"release-name"},"name":"release-name-bai-admin-test"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:37","spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"ibm-business-automation-insights-dev","image":"ibmcom/bai-init-dev:19.0.2","command":["sh","-c","echo 'Testing API health at https://taiga-admin-service:6892' \u0026\u0026 curl -s https://release-name-bai-admin-service:6892/api/health --insecure | grep '\"status\":0' \u0026\u0026 echo 'Testing API is secure at https://taiga-admin-service:6892' \u0026\u0026 touch file.txt \u0026\u0026 curl -s -X POST -F \"file=@file.txt\" -u user:pass https://release-name-bai-admin-service:6892/api/actions --insecure | grep Unauthorized \u0026\u0026 echo 'Testing API has valid credentials at https://release-name-bai-admin-service:6892' \u0026\u0026 curl -s -X POST -F \"file=@file.txt\" -u admin:passw0rd https://release-name-bai-admin-service:6892/api/actions --insecure | grep 'File must be in JSON format.'"],"resources":{}}],"restartPolicy":"Never","serviceAccountName":"default"}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-odm"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:34","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-odm","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-odm","image":"ibmcom/bai-odm-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/odm-timeseries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-bawadv"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:30","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-bawadv","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-bawadv","image":"ibmcom/bai-bawadv-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/bawadv-summaries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1219294413/api=/v1//ConfigMap/release-name-bai-flink-log4j","object":{"apiVersion":"v1","data":{"log4j-cli.properties":"XXXXXX","log4j-console.properties":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-flink-log4j"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:10"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-flink-zk"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:26","spec":{"podManagementPolicy":"Parallel","replicas":1,"selector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-flink-zk","heritage":"Helm","release":"release-name"}},"serviceName":"release-name-bai-flink-zk-svc","template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-flink-zk","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":[{"labelSelector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-flink-zk","heritage":"Helm","release":"release-name"}},"topologyKey":"kubernetes.io/hostname"}]}},"containers":[{"name":"bai-flink-zk","image":"ibmcom/bai-flink-zookeeper-dev:19.0.2","ports":[{"name":"client","containerPort":2181},{"name":"server","containerPort":2888},{"name":"leader-election","containerPort":3888}],"env":[{"name":"ZK_REPLICAS","value":"XXXXXX"},{"name":"ZK_HEAP_SIZE","value":"XXXXXX"},{"name":"ZK_TICK_TIME","value":"XXXXXX"},{"name":"ZK_INIT_LIMIT","value":"XXXXXX"},{"name":"ZK_SYNC_LIMIT","value":"XXXXXX"},{"name":"ZK_MAX_CLIENT_CNXNS","value":"XXXXXX"},{"name":"ZK_SNAP_RETAIN_COUNT","value":"XXXXXX"},{"name":"ZK_PURGE_INTERVAL","value":"XXXXXX"},{"name":"ZK_CLIENT_PORT","value":"XXXXXX"},{"name":"ZK_SERVER_PORT","value":"XXXXXX"},{"name":"ZK_ELECTION_PORT","value":"XXXXXX"},{"name":"ZK_DATA_DIR","value":"XXXXXX"},{"name":"ZK_DATA_LOG_DIR","value":"XXXXXX"}],"resources":{"limits":{"cpu":"200m","memory":"768Mi"},"requests":{"cpu":"100m","memory":"640Mi"}},"volumeMounts":[{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["zkOk.sh"]},"initialDelaySeconds":30,"timeoutSeconds":5,"periodSeconds":20},"readinessProbe":{"exec":{"command":["zkOk.sh"]},"initialDelaySeconds":10,"timeoutSeconds":5},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"serviceAccountName":"release-name-bai-psp-sa","volumes":[{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}},"updateStrategy":{"type":"RollingUpdate"}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","object":{"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{"helm.sh/hook":"test-success","helm.sh/hook-delete-policy":"hook-succeeded"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"test-bai-processing-jobs","heritage":"Helm","release":"release-name"},"name":"release-name-test-bai-processing-jobs"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:38","spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"ibm-business-automation-insights-dev","image":"ibmcom/bai-init-dev:19.0.2","command":["sh","-c"," log_msg() { echo \"[`date`] $1\"; }\nlog_msg \"starting test-bai-processing-jobs...\";\nreadonly getJobsOverview=\"wget http://release-name-bai-flink-jobmanager:8081/jobs/overview -qO- -T 5 --no-check-certificate\"; jobsOverview=\"\";\nsecondsBeforeRetry=\"5\"; maximumRetries=\"100\"; tryCount=0;\nwhile :; do log_msg \"trying... ${getJobsOverview}\";\njobsOverview=`${getJobsOverview}`; returnCode=$?; if [ \"${returnCode}\" = \"0\" ]; then break; fi;\ntryCount=`expr ${tryCount} + 1`; if [ \"${tryCount}\" = \"${maximumRetries}\" ]; then log_msg \"ERROR (${returnCode}) - unable to reach Flink jobmanager.\"; exit 1; fi;\nlog_msg \"waiting for the jobmanager to be available... (${tryCount}/${maximumRetries})\"; sleep ${secondsBeforeRetry}; done;\nlog_msg \"jobmanager is ready.\";\nsecondsBeforeRetry=3; maximumRetries=10;\ncheck_job() { jobName=\"dba/bai-$1\"; isJobInstalled=$2;\nif [ \"${isJobInstalled}\" == \"true\" ]; then log_msg \"checking installed job ${jobName}...\"; echo \"${jobsOverview}\" | jq .;\ntryCount=0; successCount=0; minimumConsecutiveSuccess=3;\nwhile :; do state=`echo \"${jobsOverview}\" | jq -r '.[] | .[] | select(.name=='\\\"$jobName\\\"') | .state'`;\nif [ \"`echo \"${state}\" | grep RUNNING`\" ]; then successCount=`expr ${successCount} + 1`; log_msg \"job ${jobName} state: ${state} (${successCount}/${minimumConsecutiveSuccess})\"; if [ \"${successCount}\" = \"${minimumConsecutiveSuccess}\" ]; then break; fi; else successCount=0;\nif [ -n \"${state}\" ]; then log_msg \"job ${jobName} state: ${state}\"; fi;\nif [ \"${state}\" = \"RESTARTING\" ] || [ \"${state}\" = \"FAILING\"    ] || [ \"${state}\" = \"SUSPENDED\"  ] || [ \"${state}\" = \"FAILED\"     ]; then tryCount=\"${maximumRetries}\"; else tryCount=`expr ${tryCount} + 1`; fi;\nif [ \"${tryCount}\" = \"${maximumRetries}\" ]; then log_msg \"ERROR - job ${jobName} is not running.\"; exit 1; fi;\nlog_msg \"waiting for job ${jobName} to be running... (${tryCount}/${maximumRetries})\"; fi; sleep ${secondsBeforeRetry}; jobsOverview=`${getJobsOverview}`; done; fi; }\ncheck_job ingestion false; check_job bpmn true; check_job bawadv true; check_job icm true; check_job odm true; check_job content true;\nlog_msg \"All installed jobs are in RUNNING state.\"; exit 0; "],"resources":{}}],"restartPolicy":"Never","serviceAccountName":"default"}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-setup"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:35","spec":{"backoffLimit":3,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-setup","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"es-bootstrap","image":"ibmcom/bai-setup-dev:19.0.2","env":[{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"KAFKA_KRB5_ENABLED","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"KAFKA_KRB5_REALM","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-realm"}}},{"name":"KAFKA_KRB5_KDC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-kdc"}}},{"name":"KAFKA_KRB5_PRINCIPAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-principal"}}},{"name":"KAFKA_KRB5_KEYTAB","value":"XXXXXX"},{"name":"KAFKA_INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"KAFKA_EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"KAFKA_SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}}],"resources":{"limits":{"memory":"120Mi"},"requests":{"cpu":"200m","memory":"50Mi"}},"volumeMounts":[{"name":"kerberos-keytabs","readOnly":true,"mountPath":"/etc/krb5"},{"name":"setup-ssl","readOnly":true,"mountPath":"/etc/setup-ssl"}],"securityContext":{"runAsUser":20181,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c","until curl -k -X GET -m 30 ${ELASTICSEARCH_URL} ; do echo Waiting for elasticsearch to start...; sleep 2; done;"],"env":[{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-elasticsearch","securityContext":{"runAsNonRoot":true,"runAsUser":20181}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"name":"kerberos-keytabs","secret":{"items":[{"key":"flink-security-krb5-keytab","path":"kafka.keytab"}],"optional":true,"secretName":"release-name-bai-secrets"}},{"name":"setup-ssl","secret":{"items":[{"key":"kafka-ca-cert","path":"kafka-ca.pem"}],"optional":true,"secretName":"release-name-bai-secrets"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","object":{"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{"helm.sh/hook":"test-success","helm.sh/hook-delete-policy":"hook-succeeded"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"es-test","heritage":"Helm","release":"release-name"},"name":"release-name-test-es-health"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:36","spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"release-name-test-es-health","image":"ibmcom/bai-init-dev:19.0.2","command":["sh","-c","echo $ES_HOST \u0026\u0026 echo $ES_PORT \u0026\u0026 curl https://$ES_HOST:$ES_PORT -u $ES_USERNAME:$ES_PASSWORD --insecure"],"env":[{"name":"ES_HOST","value":"XXXXXX"},{"name":"ES_PORT","value":"XXXXXX"},{"name":"ES_USERNAME","value":"XXXXXX"},{"name":"ES_PASSWORD","value":"XXXXXX"}],"resources":{}}],"restartPolicy":"Never","serviceAccountName":"default"}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-kibana","heritage":"Helm","release":"release-name","role":"kibana"},"name":"release-name-ibm-dba-ek-kibana"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:21","spec":{"minReadySeconds":5,"progressDeadlineSeconds":900,"replicas":1,"selector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-kibana","heritage":"Helm","release":"release-name","role":"kibana"}},"strategy":{"rollingUpdate":{"maxSurge":1,"maxUnavailable":1},"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"ad11d289ef57f36d20328393485989a59fc9610adec47613b3701a2334f998cd","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-kibana","heritage":"Helm","release":"release-name","role":"kibana"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"kibana","image":"ibmcom/bai-kibana-dev:19.0.2","ports":[{"name":"kibana-ui","containerPort":5601,"protocol":"TCP"}],"env":[{"name":"CFG_BASEDIR","value":"XXXXXX"},{"name":"RELEASE_NAME","value":"XXXXXX"},{"name":"KIBANA_MULTITENANCY","value":"XXXXXX"},{"name":"KIBANA_USERNAME","value":"XXXXXX"},{"name":"KIBANA_PASSWORD","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"2Gi"},"requests":{"cpu":"100m","memory":"1Gi"}},"volumeMounts":[{"name":"security-config","mountPath":"/usr/share/kibana/config"},{"name":"tls-config","mountPath":"/usr/share/kibana/config/tls"}],"livenessProbe":{"httpGet":{"path":"/app/kibana","port":5601,"scheme":"HTTPS","httpHeaders":[{"name":"Authorization","value":"Basic YWRtaW46cGFzc3cwcmQ="}]},"initialDelaySeconds":120},"readinessProbe":{"httpGet":{"path":"/app/kibana","port":5601,"scheme":"HTTPS","httpHeaders":[{"name":"Authorization","value":"Basic YWRtaW46cGFzc3cwcmQ="}]},"initialDelaySeconds":120},"securityContext":{"runAsUser":1000,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; healthUrl=$ELASTICSEARCH_URL/_cluster/health; expectedStr=\\\"number_of_data_nodes\\\":1\nwhile :; do echo \"[`date`] Waiting for Elasticsearch data nodes availability...\"; curl -s -k -X GET -m 30 $healthUrl -u $KIBANA_USERNAME:$KIBANA_PASSWORD | grep $expectedStr; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster data nodes have all joined the cluster.\\n\"; break; fi; sleep 5; done; "],"env":[{"name":"ELASTICSEARCH_URL","value":"https://release-name-ibm-dba-ek-client:9200"},{"name":"KIBANA_USERNAME","value":"admin"},{"name":"KIBANA_PASSWORD","value":"passw0rd"}],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"wait-es-data-nodes","securityContext":{"runAsNonRoot":true,"runAsUser":1000}}],"restartPolicy":"Always","securityContext":{"fsGroup":1000},"serviceAccountName":"default","volumes":[{"name":"security-config","secret":{"secretName":"release-name-ibm-dba-ek-kibana-security-config"}},{"name":"tls-config","secret":{"secretName":"release-name-ibm-dba-ek-elasticsearch-tls"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-flink-jobmanager"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:23","spec":{"replicas":1,"selector":{"matchLabels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-jobmanager","heritage":"Helm","release":"release-name"}},"strategy":{"rollingUpdate":null,"type":"Recreate"},"template":{"metadata":{"annotations":{"checksum/config":"73a99585e8ef08066f51bbcb4d4d51c92ba48083e381c99d9a6946aea95be969","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-jobmanager","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"jobmanager","image":"ibmcom/bai-flink-dev:19.0.2","args":["jobmanager"],"ports":[{"name":"rpc","containerPort":6123},{"name":"blob","containerPort":6124},{"name":"query","containerPort":6125},{"name":"ui-rest","containerPort":8081}],"env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"HEAP_MEMORY","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-heap-memory"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_HDFS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-hdfs"}}},{"name":"FLINK_SECURITY_KRB5_REALM","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-realm"}}},{"name":"FLINK_SECURITY_KRB5_KDC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-kdc"}}},{"name":"FLINK_SECURITY_KRB5_PRINCIPAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-principal"}}},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}}],"resources":{"limits":{"memory":"1280Mi"},"requests":{"cpu":"100m","memory":"256Mi"}},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-console.properties","subPath":"log4j-console.properties"},{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"},{"name":"kerberos-keytabs","readOnly":true,"mountPath":"/etc/krb5"}],"livenessProbe":{"httpGet":{"path":"/taskmanagers","port":"ui-rest","scheme":"HTTPS"},"initialDelaySeconds":60,"periodSeconds":10,"failureThreshold":3},"readinessProbe":{"exec":{"command":["check-jobmanager.sh","release-name","1"]},"initialDelaySeconds":10,"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-console.properties","path":"log4j-console.properties"},{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"kerberos-keytabs","secret":{"items":[{"key":"flink-security-krb5-keytab","path":"flink.keytab"}],"optional":true,"secretName":"release-name-bai-secrets"}},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"},{"key":"kafka-server-cert","path":"kafka-server-cert"},{"key":"elasticsearch-server-cert","path":"elasticsearch-server-cert"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2393549468/api=networking.k8s.io/v1/default/NetworkPolicy/release-name-allow-all","object":{"apiVersion":"networking.k8s.io/v1","kind":"NetworkPolicy","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-allow-all","namespace":"default"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:0","spec":{"egress":[{}],"ingress":[{}],"podSelector":{},"policyTypes":["Ingress","Egress"]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-content"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:32","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-content","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-content","image":"ibmcom/bai-content-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/content-timeseries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-baiw"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:29","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-baiw","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-baiw","image":"ibmcom/bai-baiw-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/baiw-timeseries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2359994230/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-config","object":{"apiVersion":"v1","data":{"client.yml":"XXXXXX","data.yml":"XXXXXX","log4j2.properties":"XXXXXX","master.yml":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-elasticsearch","heritage":"Helm","release":"release-name"},"name":"release-name-ibm-dba-ek-elasticsearch-config"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:6"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-bpmn"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:31","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-bpmn","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-bpmn","image":"ibmcom/bai-bpmn-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/process-summaries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name","role":"data"},"name":"release-name-ibm-dba-ek-data"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:24","spec":{"podManagementPolicy":"Parallel","replicas":1,"revisionHistoryLimit":3,"selector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name","role":"data"}},"serviceName":"release-name-ibm-dba-ek-data","template":{"metadata":{"annotations":{"checksum/config":"bbe879468b78d97753935ab6b844d8eacd9444cc90f1119b50a9bf843c8e510a","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name","role":"data"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":[{"labelSelector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name","role":"data"}},"topologyKey":"kubernetes.io/hostname"}]}},"containers":[{"name":"es-data","image":"ibmcom/bai-elasticsearch-dev:19.0.2","command":["/bin/bash","/scripts/entrypoint.sh"],"ports":[{"name":"transport","containerPort":9300,"protocol":"TCP"}],"env":[{"name":"ES_JAVA_OPTS","value":"XXXXXX"},{"name":"CFG_BASEDIR","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"2Gi"},"requests":{"cpu":"100m","memory":"1Gi"}},"volumeMounts":[{"name":"entrypoint","mountPath":"/scripts"},{"name":"data","mountPath":"/usr/share/elasticsearch/data"},{"name":"config","mountPath":"/usr/share/elasticsearch/ibm-dba-ek-config/elasticsearch.yml","subPath":"elasticsearch.yml"},{"name":"plugin-bundle","mountPath":"/usr/share/elasticsearch/plugin-bundles"}],"livenessProbe":{"tcpSocket":{"port":9300},"initialDelaySeconds":90},"readinessProbe":{"tcpSocket":{"port":9300},"initialDelaySeconds":90},"securityContext":{"runAsUser":1000,"runAsNonRoot":true}}],"initContainers":[{"command":["/bin/sh","-c","sysctl -w vm.max_map_count=262144 \u0026\u0026 sed -i '/^vm.max_map_count /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.max_map_count = 262144' \u003e\u003e /etc/sysctl.conf \u0026\u0026 sysctl -w vm.swappiness=1 \u0026\u0026 sed -i '/^vm.swappiness /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.swappiness=1' \u003e\u003e /etc/sysctl.conf"],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"sysctl","securityContext":{"privileged":true}},{"command":["/bin/sh","-c","mkdir -p /usr/share/elasticsearch/data/nodes \u0026\u0026 chown -R 1000:1000 /usr/share/elasticsearch/data; chmod ug+x /usr/share/elasticsearch/data /usr/share/elasticsearch/data/nodes"],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"initcontainer","securityContext":{"privileged":true},"volumeMounts":[{"mountPath":"/usr/share/elasticsearch/data","name":"data"}]}],"securityContext":{"fsGroup":1000},"serviceAccountName":"release-name-bai-psp-sa","volumes":[{"configMap":{"defaultMode":365,"items":[{"key":"entrypoint.sh","path":"entrypoint.sh"}],"name":"release-name-ibm-dba-ek-elasticsearch-entrypoint"},"name":"entrypoint"},{"configMap":{"items":[{"key":"data.yml","path":"elasticsearch.yml"}],"name":"release-name-ibm-dba-ek-elasticsearch-config"},"name":"config"},{"emptyDir":{"medium":""},"name":"plugin-bundle"}]}},"updateStrategy":{"type":"RollingUpdate"},"volumeClaimTemplates":[{"metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-data","heritage":"Helm","release":"release-name"},"name":"data"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}},"storageClassName":""}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","heritage":"Helm","release":"release-name"},"name":"release-name-bai-icm"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:33","spec":{"backoffLimit":0,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"ibm-business-automation-insights-dev","chart":"ibm-business-automation-insights-dev","component":"bai-icm","heritage":"Helm","release":"release-name"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"bai-icm","image":"ibmcom/bai-icm-dev:19.0.2","env":[{"name":"JOB_MANAGER_RPC_ADDRESS","value":"XXXXXX"},{"name":"ZOOKEEPER_ADDRESS","value":"XXXXXX"},{"name":"TAIGA_FEATURES","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bai-features"}}},{"name":"KAFKA_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-username"}}},{"name":"KAFKA_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"kafka-password"}}},{"name":"KAFKA_BOOTSTRAP_SERVERS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-bootstrap-servers"}}},{"name":"KAFKA_SECURITY_PROTOCOL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-security-protocol"}}},{"name":"KAFKA_SASL_KERBEROS_SERVICE_NAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"kafka-sasl-kerberos-service-name"}}},{"name":"FLINK_SECURITY_KRB5_ENABLE_KAFKA","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-security-krb5-enable-kafka"}}},{"name":"SSL_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"flink-ssl-password"}}},{"name":"JOB_PARALLELISM","value":"XXXXXX"},{"name":"CHECKPOINTING_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-checkpointing-interval"}}},{"name":"SUMMARY_END_AGGREGATION_DELAY_MS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"bpmn-end-aggregation-delay","optional":true}}},{"name":"STORAGE_BATCH_SIZE","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-batch-size"}}},{"name":"INACTIVE_BUCKET_CHECK_INTERVAL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-check-interval-ms"}}},{"name":"INACTIVE_BUCKET_THRESHOLD","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-inactive-bucket-threshold-ms"}}},{"name":"STORAGE_BUCKET_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"storage-bucket-url"}}},{"name":"INGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"ingress-topic"}}},{"name":"EGRESS_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"egress-topic"}}},{"name":"SERVICE_TOPIC","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"service-topic"}}},{"name":"SAVEPOINT","value":"XXXXXX"},{"name":"ELASTICSEARCH_URL","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-url"}}},{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"elasticsearch-username"}}},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-bai-secrets","key":"elasticsearch-password"}}},{"name":"ELASTICSEARCH_MAX_ACTIONS","value":"XXXXXX","valueFrom":{"configMapKeyRef":{"name":"release-name-bai-env","key":"flink-job-elasticsearch-max-actions"}}}],"resources":{},"volumeMounts":[{"name":"flink-log4j","mountPath":"/opt/flink/conf/log4j-cli.properties","subPath":"log4j-cli.properties"},{"name":"flink-ssl","readOnly":true,"mountPath":"/etc/flink-ssl"},{"name":"nfs-storage","mountPath":"/mnt/pv"}],"livenessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"initialDelaySeconds":15,"periodSeconds":20},"readinessProbe":{"exec":{"command":["sh","-c","ps aux | grep -v grep | grep \"run-job\""]},"periodSeconds":10},"securityContext":{"runAsUser":9999,"runAsNonRoot":true}}],"initContainers":[{"command":["sh","-c"," [[ \"${ELASTICSEARCH_URL: -1}\" == \"/\" ]] \u0026\u0026 ELASTICSEARCH_URL=${ELASTICSEARCH_URL:$i:-1}; templateUrl=$ELASTICSEARCH_URL/_template/case-summaries; esRequest=\"curl -s -k -X GET -m 30 $templateUrl -u $ELASTICSEARCH_USERNAME:$ELASTICSEARCH_PASSWORD\";\nwhile :; do echo \"[`date`] Waiting for Flink cluster to start...\"; sleep 5; wget \"https://release-name-bai-flink-jobmanager:8081/overview\" -qO- -T 5 --no-check-certificate; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Flink cluster is ready.\\n\"; break; fi; done;\nwhile :; do echo \"[`date`] Waiting for Elasticsearch cluster availability...\"; ${esRequest}; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Elasticsearch cluster is available.\\n\"; break; fi; done;\ni=0; while :; do echo \"[`date`] Checking if mappings version is up-to-date (${templateUrl}). Expecting version: $ES_CONFIG_VERSION... (iteration $i)\"; i=$((i+1)); ${esRequest} | grep \"\\\"version\\\":\\\"$ES_CONFIG_VERSION\\\"\"; if [[ \"$?\" == \"0\" ]]; then printf \"\\n[`date`] Mappings are up-to-date.\\n\"; break; else printf \"\\n[`date`] Mappings are NOT up-to-date.\\n\"; fi; sleep 5; done; "],"env":[{"name":"ES_CONFIG_VERSION","valueFrom":{"configMapKeyRef":{"key":"es-config-version","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_URL","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-url","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_USERNAME","valueFrom":{"configMapKeyRef":{"key":"elasticsearch-username","name":"release-name-bai-env"}}},{"name":"ELASTICSEARCH_PASSWORD","valueFrom":{"secretKeyRef":{"key":"elasticsearch-password","name":"release-name-bai-secrets"}}}],"image":"ibmcom/bai-init-dev:19.0.2","name":"wait-bai-flink-es","securityContext":{"runAsNonRoot":true,"runAsUser":9999}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"configMap":{"items":[{"key":"log4j-cli.properties","path":"log4j-cli.properties"}],"name":"release-name-bai-flink-log4j"},"name":"flink-log4j"},{"name":"flink-ssl","secret":{"items":[{"key":"flink-ssl-keystore","path":"pods.keystore"},{"key":"flink-ssl-truststore","path":"ca.truststore"},{"key":"flink-ssl-internal-keystore","path":"internal.keystore"}],"secretName":"release-name-bai-secrets"}},{"name":"nfs-storage","persistentVolumeClaim":{"claimName":"release-name-bai-pvc"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-client","heritage":"Helm","release":"release-name","role":"client"},"name":"release-name-ibm-dba-ek-client"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:20","spec":{"minReadySeconds":5,"progressDeadlineSeconds":900,"replicas":1,"selector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-client","heritage":"Helm","release":"release-name","role":"client"}},"strategy":{"rollingUpdate":{"maxSurge":1,"maxUnavailable":1},"type":"RollingUpdate"},"template":{"metadata":{"annotations":{"checksum/config":"6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b","productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-client","heritage":"Helm","release":"release-name","role":"client"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}},"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchLabels":{"app":"release-name-ibm-dba-ek-elasticsearch","component":"release-name-ibm-dba-ek-client","heritage":"Helm","release":"release-name","role":"client"}},"topologyKey":"kubernetes.io/hostname"},"weight":1}]}},"containers":[{"name":"es-client","image":"ibmcom/bai-elasticsearch-dev:19.0.2","command":["/bin/bash","/scripts/entrypoint.sh"],"ports":[{"name":"es-rest","containerPort":9200,"protocol":"TCP"},{"name":"transport","containerPort":9300,"protocol":"TCP"}],"env":[{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX"},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX"},{"name":"ES_JAVA_OPTS","value":"XXXXXX"},{"name":"CFG_BASEDIR","value":"XXXXXX"}],"resources":{"limits":{"cpu":"1","memory":"2Gi"},"requests":{"cpu":"100m","memory":"1Gi"}},"volumeMounts":[{"name":"entrypoint","mountPath":"/scripts"},{"name":"config","mountPath":"/usr/share/elasticsearch/ibm-dba-ek-config/elasticsearch.yml","subPath":"elasticsearch.yml"}],"livenessProbe":{"tcpSocket":{"port":9300},"initialDelaySeconds":90},"readinessProbe":{"httpGet":{"path":"/_cluster/health","port":9200,"scheme":"HTTPS","httpHeaders":[{"name":"Authorization","value":"Basic YWRtaW46cGFzc3cwcmQ="}]},"initialDelaySeconds":90},"securityContext":{"runAsUser":1000,"runAsNonRoot":true}}],"initContainers":[{"command":["/bin/sh","-c","sysctl -w vm.max_map_count=262144 \u0026\u0026 sed -i '/^vm.max_map_count /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.max_map_count = 262144' \u003e\u003e /etc/sysctl.conf \u0026\u0026 sysctl -w vm.swappiness=1 \u0026\u0026 sed -i '/^vm.swappiness /d' /etc/sysctl.conf \u0026\u0026 echo 'vm.swappiness=1' \u003e\u003e /etc/sysctl.conf"],"image":"ibmcom/bai-init-dev:19.0.2","imagePullPolicy":null,"name":"sysctl","securityContext":{"privileged":true}}],"serviceAccountName":"release-name-bai-psp-sa","volumes":[{"configMap":{"defaultMode":365,"items":[{"key":"entrypoint.sh","path":"entrypoint.sh"}],"name":"release-name-ibm-dba-ek-elasticsearch-entrypoint"},"name":"entrypoint"},{"configMap":{"items":[{"key":"client.yml","path":"elasticsearch.yml"},{"key":"log4j2.properties","path":"log4j2.properties"}],"name":"release-name-ibm-dba-ek-elasticsearch-config"},"name":"config"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-security-config","heritage":"Helm","release":"release-name","role":"security-config"},"name":"release-name-ibm-dba-ek-security-config"},"sourcePath":"templates/ibm-business-automation-insights-dev_template.yaml:28","spec":{"backoffLimit":3,"template":{"metadata":{"annotations":{"productID":"BAIID","productName":"IBM Business Automation Insights","productVersion":"19.0.2"},"labels":{"app":"release-name-ibm-dba-ek-elasticsearch","chart":"ibm-dba-ek","component":"release-name-ibm-dba-ek-security-config","heritage":"Helm","release":"release-name","role":"security-config"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"beta.kubernetes.io/arch","operator":"In","values":["amd64"]}]}]}}},"containers":[{"name":"es-security-config","image":"ibmcom/bai-elasticsearch-dev:19.0.2","command":["/bin/bash","/scripts/entrypoint.sh"],"env":[{"name":"ELASTICSEARCH_USERNAME","value":"XXXXXX"},{"name":"ELASTICSEARCH_PASSWORD","value":"XXXXXX"},{"name":"KIBANA_MULTITENANCY","value":"XXXXXX"}],"resources":{},"volumeMounts":[{"name":"init-security-config","mountPath":"/usr/share/elasticsearch/init-security-config"},{"name":"entrypoint","mountPath":"/scripts"}],"securityContext":{"runAsUser":1000,"runAsNonRoot":true}}],"restartPolicy":"Never","serviceAccountName":"default","volumes":[{"name":"init-security-config","secret":{"secretName":"release-name-ibm-dba-ek-elasticsearch-security-config"}},{"configMap":{"defaultMode":365,"items":[{"key":"entrypoint.sh","path":"entrypoint.sh"}],"name":"release-name-ibm-dba-ek-elasticsearch-security-entrypoint"},"name":"entrypoint"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/ibm-business-automation-insights-dev_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}}],"attributes":null,"results":[{"resourceID":"path=2527770420/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-security-entrypoint","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]}]},{"resourceID":"path=2376771849/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-entrypoint","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]}]},{"resourceID":"path=2544548039/api=/v1//ConfigMap/release-name-bai-env","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":4.800000000000001,"severity":1}],"score":4.800000000000001,"severity":1},"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981091503/api=apps/v1//StatefulSet/release-name-bai-flink-taskmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":12.100000000000001,"severity":3},"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","failedPath":"spec.template.spec.containers[0].env[12].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","failedPath":"spec.template.spec.containers[0].env[12].value","fixPath":{"path":"","value":""}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","deletePath":"spec.template.spec.containers[0].env[12].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","deletePath":"spec.template.spec.containers[0].env[12].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2897203408/api=apps/v1//Deployment/release-name-bai-admin","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014646741/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-master","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=2981238598/api=/v1//Pod/release-name-bai-admin-test","fixPath":{"path":"spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964460979/api=batch/v1//Job/release-name-bai-odm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3031571455/api=batch/v1//Job/release-name-bai-bawadv","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"resourceID":"path=1219294413/api=/v1//ConfigMap/release-name-bai-flink-log4j","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2964313884/api=apps/v1//StatefulSet/release-name-bai-flink-zk","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=3165792407/api=/v1//Pod/release-name-test-bai-processing-jobs","fixPath":{"path":"spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":12.100000000000001,"severity":3},"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","failedPath":"spec.template.spec.containers[0].env[12].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","failedPath":"spec.template.spec.containers[0].env[12].value","fixPath":{"path":"","value":""}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","deletePath":"spec.template.spec.containers[0].env[12].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","deletePath":"spec.template.spec.containers[0].env[12].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947683360/api=batch/v1//Job/release-name-bai-setup","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","failedPath":"spec.containers[0].env[3].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","failedPath":"spec.containers[0].env[3].value","fixPath":{"path":"","value":""}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","deletePath":"spec.containers[0].env[3].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","deletePath":"spec.containers[0].env[3].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=2998016217/api=/v1//Pod/release-name-test-es-health","fixPath":{"path":"spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","failedPath":"spec.template.spec.containers[0].env[4].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","failedPath":"spec.template.spec.containers[0].env[4].value","fixPath":{"path":"","value":""}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","deletePath":"spec.template.spec.containers[0].env[4].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","deletePath":"spec.template.spec.containers[0].env[4].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2947536265/api=apps/v1//Deployment/release-name-ibm-dba-ek-kibana","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":12.100000000000001,"severity":3},"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2913981027/api=apps/v1//Deployment/release-name-bai-flink-jobmanager","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"resourceID":"path=2393549468/api=networking.k8s.io/v1/default/NetworkPolicy/release-name-allow-all","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3065126693/api=batch/v1//Job/release-name-bai-content","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3081757217/api=batch/v1//Job/release-name-bai-baiw","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"resourceID":"path=2359994230/api=/v1//ConfigMap/release-name-ibm-dba-ek-elasticsearch-config","controls":[{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3014793836/api=batch/v1//Job/release-name-bai-bpmn","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2997869122/api=apps/v1//StatefulSet/release-name-ibm-dba-ek-data","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3048349074/api=batch/v1//Job/release-name-bai-icm","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","priorityVector":[{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":3.3000000000000003,"severity":1},"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"passed"},"rules":[{"name":"resources-cpu-limits","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"passed"},"rules":[{"name":"resources-memory-limits","status":"passed","subStatus":""}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","failedPath":"spec.template.spec.containers[0].env[1].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","failedPath":"spec.template.spec.containers[0].env[1].value","fixPath":{"path":"","value":""}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","deletePath":"spec.template.spec.containers[0].env[1].name","fixPath":{"path":"","value":""}},{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","deletePath":"spec.template.spec.containers[0].env[1].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=2930758646/api=apps/v1//Deployment/release-name-ibm-dba-ek-client","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]},{"prioritizedResource":{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","failedPath":"spec.template.spec.containers[0].env[1].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","failedPath":"spec.template.spec.containers[0].env[1].value","fixPath":{"path":"","value":""}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","deletePath":"spec.template.spec.containers[0].env[1].name","fixPath":{"path":"","value":""}},{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","deletePath":"spec.template.spec.containers[0].env[1].value","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=3064979598/api=batch/v1//Job/release-name-ibm-dba-ek-security-config","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]}]}],"metadata":{"targetMetadata":{"gitRepoContextMetadata":{"provider":"github","repo":"LLM-Helm-Fix","owner":"fminna","branch":"main","remoteURL":"https://github.com/fminna/LLM-Helm-Fix","lastCommit":{"hash":"58081b17c30dcf7edd5f95a1e7ba1d4057a23572","date":"0001-01-01T00:00:00Z"},"localRootPath":"/Applications/Utilities/repos/LLM-Helm-Fix"}},"clusterMetadata":{},"scanMetadata":{"targetType":"Framework","kubescapeVersion":"v3.0.1","formatVersion":"v2","formats":["json"],"targetNames":["clusterscan","mitre","nsa"],"failThreshold":100,"scanningTarget":3,"submit":true}},"paginationInfo":{"chunkNumber":0,"isLastChunk":false},"customerGUIDGenerated":false}