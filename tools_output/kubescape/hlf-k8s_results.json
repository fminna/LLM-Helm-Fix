{"generationTime":"0001-01-01T00:00:00Z","clusterAPIServerInfo":null,"clusterCloudProvider":"","customerGUID":"","clusterName":"","reportGUID":"","jobID":"","summaryDetails":{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"failed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":5.882353,"complianceScore":94.117645,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":9,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"failed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0030":{"statusInfo":{"status":"failed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":88.888885,"complianceScore":11.111112,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0031":{"statusInfo":{"status":"passed"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0034":{"statusInfo":{"status":"passed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":10,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0042":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"failed"},"controlID":"C-0053","name":"Access container service account","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0063":{"statusInfo":{"status":"passed"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0187":{"statusInfo":{"status":"passed"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"failed"},"controlID":"C-0260","name":"Missing network policy","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":7,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":38.88889,"complianceScore":61.11111,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"status":"failed","frameworks":[{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"failed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":5.882353,"complianceScore":94.117645,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0015":{"statusInfo":{"status":"failed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0063":{"statusInfo":{"status":"passed"},"controlID":"C-0063","name":"Portforwarding privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0187":{"statusInfo":{"status":"passed"},"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0188":{"statusInfo":{"status":"passed"},"controlID":"C-0188","name":"Minimize access to create pods","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0260":{"statusInfo":{"status":"failed"},"controlID":"C-0260","name":"Missing network policy","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":11,"failedResources":7,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":38.88889,"complianceScore":61.11111,"scoreFactor":5,"category":{"name":"Network","id":"Cat-4"}},"C-0262":{"statusInfo":{"status":"passed"},"controlID":"C-0262","name":"Anonymous access enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Control plane","id":"Cat-1","subCategory":{"name":"Supply chain","id":"Cat-6"}}}},"name":"ClusterScan","status":"failed","version":"","ResourceCounters":{"passedResources":10,"failedResources":10,"skippedResources":0,"excludedResources":0},"score":18.625679,"complianceScore":77.01525},{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0007":{"statusInfo":{"status":"failed"},"controlID":"C-0007","name":"Roles with delete capabilities","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":5.882353,"complianceScore":94.117645,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0014":{"statusInfo":{"status":"passed"},"controlID":"C-0014","name":"Access Kubernetes dashboard","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":9,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":2,"category":{"name":"Access control","id":"Cat-2"}},"C-0015":{"statusInfo":{"status":"failed"},"controlID":"C-0015","name":"List Kubernetes secrets","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":7,"category":{"name":"Access control","id":"Cat-2"}},"C-0020":{"statusInfo":{"status":"passed"},"controlID":"C-0020","name":"Mount service principal","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5"}},"C-0031":{"statusInfo":{"status":"passed"},"controlID":"C-0031","name":"Delete Kubernetes events","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0037":{"statusInfo":{"status":"passed"},"controlID":"C-0037","name":"CoreDNS poisoning","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Access control","id":"Cat-2"}},"C-0042":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0042","name":"SSH server running inside container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5"}},"C-0045":{"statusInfo":{"status":"passed"},"controlID":"C-0045","name":"Writable hostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0048":{"statusInfo":{"status":"passed"},"controlID":"C-0048","name":"HostPath mount","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Storage","id":"Cat-8"}}},"C-0053":{"statusInfo":{"status":"failed"},"controlID":"C-0053","name":"Access container service account","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}}},"name":"MITRE","status":"failed","version":"","ResourceCounters":{"passedResources":16,"failedResources":2,"skippedResources":0,"excludedResources":0},"score":6.3882065,"complianceScore":82.00692},{"controls":{"C-0002":{"statusInfo":{"status":"passed"},"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":5,"category":{"name":"Access control","id":"Cat-2"}},"C-0012":{"statusInfo":{"status":"failed"},"controlID":"C-0012","name":"Applications credentials in configuration files","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":16,"failedResources":1,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":5.882353,"complianceScore":94.117645,"scoreFactor":8,"category":{"name":"Secrets","id":"Cat-3"}},"C-0013":{"statusInfo":{"status":"failed"},"controlID":"C-0013","name":"Non-root containers","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0016":{"statusInfo":{"status":"failed"},"controlID":"C-0016","name":"Allow privilege escalation","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":6,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0017":{"statusInfo":{"status":"failed"},"controlID":"C-0017","name":"Immutable container filesystem","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":3,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0030":{"statusInfo":{"status":"failed"},"controlID":"C-0030","name":"Ingress and Egress blocked","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":88.888885,"complianceScore":11.111112,"scoreFactor":6,"category":{"name":"Network","id":"Cat-4"}},"C-0034":{"statusInfo":{"status":"passed"},"controlID":"C-0034","name":"Automatic mapping of service account","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":10,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Secrets","id":"Cat-3"}},"C-0035":{"statusInfo":{"status":"passed"},"controlID":"C-0035","name":"Administrative Roles","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":1,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":6,"category":{"name":"Access control","id":"Cat-2"}},"C-0038":{"statusInfo":{"status":"passed"},"controlID":"C-0038","name":"Host PID/IPC privileges","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0041":{"statusInfo":{"status":"passed"},"controlID":"C-0041","name":"HostNetwork access","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Network","id":"Cat-4"}}},"C-0044":{"statusInfo":{"status":"passed"},"controlID":"C-0044","name":"Container hostPort","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0046":{"statusInfo":{"status":"passed"},"controlID":"C-0046","name":"Insecure capabilities","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":7,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0054":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0054","name":"Cluster internal networking","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":4,"category":{"name":"Network","id":"Cat-4"}},"C-0055":{"statusInfo":{"status":"failed"},"controlID":"C-0055","name":"Linux hardening","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":4,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0057":{"statusInfo":{"status":"passed"},"controlID":"C-0057","name":"Privileged container","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":8,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Node escape","id":"Cat-9"}}},"C-0059":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5"}},"C-0068":{"statusInfo":{"status":"passed","subStatus":"irrelevant"},"controlID":"C-0068","name":"PSP enabled","status":"passed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":0,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":0,"complianceScore":100,"scoreFactor":1,"category":{"name":"Control plane","id":"Cat-1"}},"C-0270":{"statusInfo":{"status":"failed"},"controlID":"C-0270","name":"Ensure CPU limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}},"C-0271":{"statusInfo":{"status":"failed"},"controlID":"C-0271","name":"Ensure memory limits are set","status":"failed","resourceIDs":{},"ResourceCounters":{"passedResources":0,"failedResources":8,"skippedResources":0,"excludedResources":0},"subStatusCounters":{"ignoredResources":0},"score":100,"complianceScore":0,"scoreFactor":8,"category":{"name":"Workload","id":"Cat-5","subCategory":{"name":"Resource management","id":"Cat-7"}}}},"name":"NSA","status":"failed","version":"","ResourceCounters":{"passedResources":12,"failedResources":9,"skippedResources":0,"excludedResources":0},"score":41.739132,"complianceScore":63.433094}],"resourcesSeverityCounters":{"criticalSeverity":0,"highSeverity":18,"mediumSeverity":41,"lowSeverity":8},"controlsSeverityCounters":{"criticalSeverity":0,"highSeverity":4,"mediumSeverity":7,"lowSeverity":1},"ResourceCounters":{"passedResources":12,"failedResources":10,"skippedResources":0,"excludedResources":0},"score":34.887894,"complianceScore":69.59823},"resources":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s-appchannel-operator-mychannel"},"sourcePath":"templates/hlf-k8s_template.yaml:27","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-appchannel-operator-mychannel"}},"template":{"metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-appchannel-operator-mychannel"}},"spec":{"containers":[{"name":"fabric-tools","image":"ghcr.io/substra/fabric-tools:0.2.4","command":["sh","-c"],"args":["## Update CA certs\nupdate-ca-certificates\n\n## Check connection with the Orderer\nprintf \"[DEBUG] Testing the connection with the Orderer (orderer-hostname:7050)\\n\"\nuntil $(nc -z orderer-hostname 7050); do\n  printf \"[DEBUG] Orderer (orderer-hostname:7050) is not reacheable, retry in 5s\\n\"\n  sleep 5\ndone\n\n## Add orgs to the application channel\nwhile true; do\n\n  ## Create and join application channel\n  until grep -e \"existing.*mychannel\" -e \"FORBIDDEN\" channel.created \u003e /dev/null; do\n\n    printf \"[DEBUG] Create and join the application channel (mychannel)\\n\"\n\n    ## Create channel\n    configtxgen -profile OrgsChannel-mychannel --outputCreateChannelTx channel.tx -channelID mychannel -asOrg MyOrganization\n    peer channel create -f channel.tx \\\n      --outputBlock channel.block \\\n      -c mychannel \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050 2\u003e channel.created\n\n    ## Create and add anchor\n    configtxgen -profile OrgsChannel-mychannel --outputAnchorPeersUpdate anchor.tx -channelID mychannel -asOrg MyOrganization\n\n    peer channel update \\\n      -f anchor.tx \\\n      -c mychannel \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050\n\n    sleep 1\n  done\n\n  ## Join Application Channel\n  ## Fetch channel list\n\n  peer channel list \\\n    --tls \\\n    --clientauth \\\n    --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n    --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n    --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n    -o orderer-hostname:7050 \u003e channel.list\n\n  until grep \"^mychannel$\" channel.list \u003e /dev/null; do\n\n    printf \"[DEBUG] Fetching application channel block\\n\"\n    peer channel fetch oldest channeljoin.block \\\n      -c mychannel \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050\n\n    printf \"[DEBUG] Joining channel\\n\"\n    peer channel join -b channeljoin.block\n\n    ## Fetch channel list\n    peer channel list \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050 \u003e channel.list\n\n    sleep 1\n  done\n\n\n  ## Add organizations to application channel\n\n  while IFS=\" \" read -r org mspid configUrl ; do\n\n    ## Delete stale channel configuration files\n    rm -rf \\\n      channel.block \\\n      channel-cfg.block \\\n      channel-cfg.json\n\n\n    ## Fetch up-to-date channel configuration block\n    until [ -f \"channel.block\" ] \u0026\u0026 [ -s \"channel.block\" ]; do\n      printf \"[DEBUG] Fetching the channel (mychannel) configuration block\\n\"\n      peer channel fetch config channel.block \\\n        -c mychannel \\\n        --tls \\\n        --clientauth \\\n        --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n        --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n        --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n        -o orderer-hostname:7050 \u003e /tmp/out.txt 2\u003e\u00261 || cat /tmp/out.txt\n      sleep 3\n    done\n\n    ## Check if update has been already sent\n    printf \"[DEBUG] Check if $org is in the application channel \\n\"\n    configtxlator proto_decode --input channel.block --type common.Block | jq .data.data[0].payload.data.config \u003e channel-$org-hasjoined.json\n    if grep \"$mspid\" channel-$org-hasjoined.json \u003e /dev/null; then\n      printf \"[DEBUG] $org is already in the application channel\\n\"\n      rm -f /data/proposal-$org.pb\n      sleep 5\n      continue\n    else\n      printf \"[DEBUG] $org is not in the application channel\\n\"\n      ## Remove all configuration files because of edge cases (network issue, proposal issue).\n      ## We prefer to delete all and retry all steps to avoid side effect.\n      rm -f *-$org.*\n    fi\n\n    ## Fetch organization configuration\n    if ! [ -s \"configOrg-$org.json\" ]; then\n      printf \"[DEBUG] Fetch the organization ($org) configuration from $configUrl\\n\"\n      curl --fail -L --output ./configOrg-$org.json $configUrl || continue # continue to next org if curl fails\n    fi\n\n    ## Extract application channel configuration\n    until [ -f \"channel-cfg.block\" ] \u0026\u0026 [ -s \"channel-cfg.block\" ]; do\n      configtxlator proto_decode --input channel.block --type common.Block | jq .data.data[0].payload.data.config \u003e channel-cfg.json\n      configtxlator proto_encode --input channel-cfg.json --type common.Config --output channel-cfg.block\n      sleep 2\n    done\n\n\n    ## Fetch update proposal from external orgs if exists\n    while IFS=\" \" read -r orgProposal mspidProposal proposalServerUrl ; do\n\n      # Don't need to network-fetch proposals made by ourselves\n      if [ \"$orgProposal\" = \"MyOrganization\" ]; then continue; fi\n\n      printf \"[DEBUG] Fetch the update proposal built by organization ($orgProposal) for organization ($org) from $proposalServerUrl/proposal-$org.pb \\n\"\n      curl --fail -L --output ./external-$orgProposal-proposal-$org.pb $proposalServerUrl/proposal-$org.pb\n\n      ## Compare external proposal file with local one, keep the largest (more signatures) between them as the only difference will be the number of signatures\n      if [ -s \"external-$orgProposal-proposal-$org.pb\" ]\n      then\n        if [ -s \"proposal-$org.pb\" ] ; then\n          if [ $(stat -c %s \"external-$orgProposal-proposal-$org.pb\") -gt $(stat -c %s \"proposal-$org.pb\") ] ; then\n            printf \"[DEBUG] Use the $org update proposal from $orgProposal as there are more signatures in it !\\n\"\n            cp external-$orgProposal-proposal-$org.pb proposal-$org.pb\n          fi\n        else\n          printf \"[DEBUG] Use the $org update proposal from $orgProposal \\n\"\n          cp external-$orgProposal-proposal-$org.pb proposal-$org.pb\n        fi\n      fi\n\n    done \u003c /proposal/application-proposal-organizations\n\n    ## Create proposal if not fetched\n    until [ -f \"proposal-$org.pb\" ]; do\n      printf \"[DEBUG] Create application channel update for $org \\n\"\n\n      ## Add the Organization in the Applciation group\n      jq -s '.[0] * {\"channel_group\":{\"groups\":{\"Application\":{\"groups\":{\"'$org'\":.[1]}}}}}' channel-cfg.json configOrg-$org.json \u003e new-channel-cfg-$org.json\n      configtxlator proto_encode --input new-channel-cfg-$org.json --type common.Config --output channelupdate-$org.block\n\n      ## Compute update between channel old configuration and the updated one\n      configtxlator compute_update \\\n        --channel_id mychannel \\\n        --original channel-cfg.block \\\n        --updated channelupdate-$org.block \\\n        | configtxlator proto_decode --type common.ConfigUpdate | jq . \u003e compute_update-$org.json\n\n      ## Create the update proposal\n      echo '{\"payload\":{\"header\":{\"channel_header\":{\"channel_id\": \"mychannel\", \"type\":2}},\"data\":{\"config_update\":'$(cat compute_update-$org.json)'}}}' | jq . \u003e proposal-$org.json\n      configtxlator proto_encode --input proposal-$org.json --type common.Envelope --output proposal-$org.pb\n\n      sleep 2\n    done\n\n    ## Validate proposal application version\n    PROPOSAL_APP_VERSION=$(cat channel-cfg.json | jq '.channel_group.groups.Application.version')\n    CHANNEL_APP_VERSION=$(configtxlator proto_decode --input proposal-$org.pb --type common.Envelope | jq '.payload.data.config_update.read_set.groups.Application.version')\n    printf \"[DEBUG] Proposal application version: $CHANNEL_APP_VERSION. Channel application version: $PROPOSAL_APP_VERSION\\n\"\n    if [ $CHANNEL_APP_VERSION != $PROPOSAL_APP_VERSION ] ; then\n      # Proposal update should have a readset application version matching config application version.\n      # That suggests the proposal update is not up to date with the latest ledger state.\n      printf \"[DEBUG] Application version mismatch. Delete proposal for '$org'.\\n\"\n      rm -f /data/proposal-$org.pb proposal-$org.pb\n      continue\n    fi\n\n    ## Sign update proposal\n    peer channel signconfigtx \\\n      -f proposal-$org.pb \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050\n\n    ## Update proposal in /data\n    cp proposal-$org.pb /data/proposal-$org.pb\n    chmod +r /data/proposal-$org.pb\n\n    ## Submit proposal\n    NUM_SIGNATURES=$(configtxlator proto_decode --input proposal-$org.pb --type common.Envelope | jq '.payload.data.signatures | map(.signature_header.creator.mspid) | unique | length')\n    NUM_APPLICATION_ORGS=$(wc -l /proposal/application-proposal-organizations | cut -c 1)\n    printf \"[DEBUG] Submit channel update for '$org' with $NUM_SIGNATURES signatures (out of $NUM_APPLICATION_ORGS organizations)\\n\"\n    peer channel update \\\n      -f proposal-$org.pb \\\n      -c mychannel \\\n      --tls \\\n      --clientauth \\\n      --cafile /var/hyperledger/tls/ord/cert/cacert.pem \\\n      --keyfile /var/hyperledger/tls/client/pair/tls.key \\\n      --certfile /var/hyperledger/tls/client/pair/tls.crt \\\n      -o orderer-hostname:7050\n\n    sleep 1\n\n  done \u003c /config/application-organizations\n  sleep 10\ndone\n"],"env":[{"name":"CORE_PEER_MSPCONFIGPATH","value":"XXXXXX"},{"name":"GODEBUG","value":"XXXXXX"}],"resources":{},"volumeMounts":[{"name":"fabric-config","readOnly":true,"mountPath":"/etc/hyperledger/fabric"},{"name":"application-organizations","readOnly":true,"mountPath":"/config"},{"name":"application-proposal-organizations","readOnly":true,"mountPath":"/proposal"},{"name":"id-cert","mountPath":"/var/hyperledger/msp/signcerts"},{"name":"id-key","mountPath":"/var/hyperledger/msp/keystore"},{"name":"cacert","mountPath":"/var/hyperledger/msp/cacerts"},{"name":"cacert","mountPath":"/var/hyperledger/msp/tlscacerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/msp/admincerts"},{"name":"tls","mountPath":"/var/hyperledger/tls/server/pair"},{"name":"tls-rootcert","mountPath":"/var/hyperledger/tls/server/cert"},{"name":"tls-client","mountPath":"/var/hyperledger/tls/client/pair"},{"name":"tls-clientrootcert","mountPath":"/var/hyperledger/tls/client/cert"},{"name":"ord-tls-rootcert","mountPath":"/var/hyperledger/tls/ord/cert"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/signcerts"},{"name":"admin-key","mountPath":"/var/hyperledger/admin_msp/keystore"},{"name":"cacert","mountPath":"/var/hyperledger/admin_msp/cacerts"},{"name":"cacert","mountPath":"/var/hyperledger/admin_msp/tlscacerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/admincerts"},{"name":"data","mountPath":"/data"}],"imagePullPolicy":"IfNotPresent"},{"name":"nginx","image":"nginx:1.17.6","ports":[{"containerPort":80}],"resources":{},"volumeMounts":[{"name":"data","mountPath":"/usr/share/nginx/html/proposal"}]}],"serviceAccountName":"release-name-hlf-k8s","volumes":[{"configMap":{"name":"release-name-hlf-k8s-application-organizations-mychannel"},"name":"application-organizations"},{"configMap":{"name":"release-name-hlf-k8s-application-proposal-organizations-mychannel"},"name":"application-proposal-organizations"},{"configMap":{"name":"release-name-hlf-k8s-fabric"},"name":"fabric-config"},{"name":"id-cert","secret":{"secretName":"hlf-msp-cert-user"}},{"name":"id-key","secret":{"secretName":"hlf-msp-key-user"}},{"name":"cacert","secret":{"secretName":"hlf-cacert"}},{"name":"tls","secret":{"secretName":"hlf-tls-admin"}},{"name":"tls-rootcert","secret":{"secretName":"hlf-cacert"}},{"name":"tls-client","secret":{"secretName":"hlf-tls-user"}},{"name":"tls-clientrootcert","secret":{"secretName":"hlf-cacert"}},{"name":"admin-cert","secret":{"secretName":"hlf-msp-cert-admin"}},{"name":"admin-key","secret":{"secretName":"hlf-msp-key-admin"}},{"name":"ord-tls-rootcert","secret":{"secretName":"ord-tls-rootcert"}},{"emptyDir":{},"name":"data"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1466015218/api=networking.k8s.io/v1//NetworkPolicy/release-name-couchdb","object":{"apiVersion":"networking.k8s.io/v1","kind":"NetworkPolicy","metadata":{"labels":{"app":"couchdb","chart":"couchdb-3.3.4","heritage":"Helm","release":"release-name"},"name":"release-name-couchdb"},"sourcePath":"templates/hlf-k8s_template.yaml:0","spec":{"ingress":[{"ports":[{"port":5984,"protocol":"TCP"}]},{"from":[{"podSelector":{"matchLabels":{"app":"couchdb","release":"release-name"}}}],"ports":[{"port":9100,"protocol":"TCP"},{"port":4369,"protocol":"TCP"}]}],"podSelector":{"matchLabels":{"app":"couchdb","release":"release-name"}},"policyTypes":["Ingress"]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1600236170/api=/v1//ConfigMap/release-name-hlf-ca--config","object":{"apiVersion":"v1","data":{"ca.yaml":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"hlf-ca","chart":"hlf-ca-2.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-ca--config"},"sourcePath":"templates/hlf-k8s_template.yaml:8"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1365349504/api=/v1//ConfigMap/release-name-couchdb","object":{"apiVersion":"v1","data":{"inifile":"XXXXXX","seedlistinifile":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"couchdb","chart":"couchdb-3.3.4","heritage":"Helm","release":"release-name"},"name":"release-name-couchdb"},"sourcePath":"templates/hlf-k8s_template.yaml:6"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3618532226/api=/v1//ConfigMap/release-name-hlf-k8s-enrollment","object":{"apiVersion":"v1","data":{"enrollments":"XXXXXX"},"kind":"ConfigMap","metadata":{"name":"release-name-hlf-k8s-enrollment"},"sourcePath":"templates/hlf-k8s_template.yaml:13"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s-enrollment-operator"},"sourcePath":"templates/hlf-k8s_template.yaml:29","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-enrollment-operator"}},"template":{"metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-enrollment-operator"}},"spec":{"containers":[{"name":"fabric-tools","image":"ghcr.io/substra/fabric-tools:0.2.4","command":["sh","-c"],"args":["## Update CA certs\nupdate-ca-certificates\n\n## Check connection with the Certificate Authority\nprintf \"[DEBUG] Testing the connection with this node's Certificate Authority (http://ca-hostname:7054)\\n\"\nuntil fabric-ca-client getcainfo -u http://ca-hostname:7054; do\n  printf \"[DEBUG] Certificate Authority (http://ca-hostname:7054) server is not reacheable, retry in 5s\\n\"\n  sleep 5\ndone\n\n## Enroll CA administrator\nprintf \"[DEBUG] Testing enrollment of CA admin\\n\"\nuntil fabric-ca-client identity list -u http://caAdmin:caPassword@ca-hostname:7054 --id caAdmin; do\n  printf \"[DEBUG] Certificate Authority admin is not enrolled, enrolling it now:\\n\"\n  fabric-ca-client enroll -d -u http://caAdmin:caPassword@ca-hostname:7054 -M /var/hyperledger/fabric-ca/msp\n  sleep 1\ndone\n\n## Create CA cert kubernetes secret\n## Note: The CA cert is shared between all identities (CA admin, admins, and users)\nuntil kubectl get secret hlf-cacert \u003e /dev/null; do\n  printf \"[DEBUG] CA cacerts k8s secret not found, creating it now:\\n\"\n  kubectl create secret generic hlf-cacert --from-file=cacert.pem=$(find /var/hyperledger/fabric-ca/msp/cacerts -type f)\n  sleep 1\ndone\n\n## Check connection with the Orderer Certificate Authority\nprintf \"[DEBUG] Testing the connection with the Orderer Certificate Authority (http://orderer-ca-hostname:7054)\\n\"\nuntil fabric-ca-client getcainfo -u http://orderer-ca-hostname:7054 -H /tmp/orderer; do\n  printf \"[DEBUG] Orderer Certificate Authority (http://orderer-ca-hostname:7054) server is not reacheable, retry in 5s\\n\"\n  sleep 5\ndone\n\n## Create Orderer CA Cert kubernetes secret\nuntil kubectl get secret ord-tls-rootcert \u003e /dev/null; do\n  printf \"[DEBUG] Orderer CA cacerts k8s secret not found, creating it now:\\n\"\n  kubectl create secret generic ord-tls-rootcert --from-file=cacert.pem=$(find /tmp/orderer/msp/cacerts -type f)\n  sleep 1\ndone\n\n## Enroll users\nwhile true; do\n\n  while IFS=\" \" read -r name secret options; do\n\n    printf \"[DEBUG] Checking enrollment of CA user $name\\n\"\n\n    ## Register user\n    until fabric-ca-client identity list -u http://caAdmin:caPassword@ca-hostname:7054 --id $name; do\n      printf \"[DEBUG] User $name is not registered, registering the user now:\\n\"\n      fabric-ca-client register -d -u http://caAdmin:caPassword@ca-hostname:7054 --id.name $name --id.secret $secret $options\n      sleep 1\n    done\n\n    ## Enroll user (MSP)\n    until [ -d \"/data/$name/msp\" ]; do\n      printf \"[DEBUG] MSP certificate not found: enrolling user '$name' now:\\n\"\n      fabric-ca-client enroll -d -u http://$name:$secret@ca-hostname:7054 -M /data/$name/msp\n      sleep 1\n    done\n\n    ## Enroll user (TLS)\n    until [ -d \"/data/$name/tls\" ]; do\n      printf \"[DEBUG] TLS certificate not found: enrolling user '$name' with TLS profile now:\\n\"\n      fabric-ca-client enroll -d --enrollment.profile tls -u http://$name:$secret@ca-hostname:7054 -M /data/$name/tls --csr.hosts \"localhost,127.0.0.1,service-hostname\"\n      sleep 1\n    done\n\n    ## Create secret: MSP cert\n    until kubectl get secret hlf-msp-cert-$name \u003e /dev/null; do\n      printf \"[DEBUG] User '$name' 'MSP cert' secret not found, creating it now:\\n\"\n      kubectl create secret generic hlf-msp-cert-$name --from-file=cert.pem=/data/$name/msp/signcerts/cert.pem\n      sleep 1\n    done\n\n    ## Create secret: MSP key\n    until kubectl get secret hlf-msp-key-$name \u003e /dev/null; do\n      printf \"[DEBUG] User '$name' 'MSP key' secret not found, creating it now:\\n\"\n      kubectl create secret generic hlf-msp-key-$name --from-file=key.pem=$(find /data/$name/msp/keystore -type f)\n      sleep 1\n    done\n\n    ## Create secret: TLS pair\n    until kubectl get secret hlf-tls-$name \u003e /dev/null; do\n      printf \"[DEBUG] User '$name' 'TLS pair' secret not found, creating it now:\\n\"\n      kubectl create secret tls hlf-tls-$name --key $(find /data/$name/tls/keystore -type f) --cert /data/$name/tls/signcerts/cert.pem\n      sleep 1\n    done\n\n  done \u003c /config/enrollments\n\n  sleep 10\ndone\n"],"resources":{},"volumeMounts":[{"name":"fabric-config","readOnly":true,"mountPath":"/etc/hyperledger/fabric"},{"name":"enrollment","readOnly":true,"mountPath":"/config"},{"name":"data","mountPath":"/data"}],"imagePullPolicy":"IfNotPresent"}],"serviceAccountName":"release-name-hlf-k8s","volumes":[{"configMap":{"name":"release-name-hlf-k8s-fabric"},"name":"fabric-config"},{"configMap":{"name":"release-name-hlf-k8s-enrollment"},"name":"enrollment"},{"emptyDir":{},"name":"data"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{"helm.sh/hook":"post-delete","helm.sh/hook-delete-policy":"hook-succeeded"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s-hook-delete-secrets","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s-hook-delete-secrets","namespace":"default"},"sourcePath":"templates/hlf-k8s_template.yaml:31","spec":{"template":{"spec":{"containers":[{"name":"fabric-tools","image":"ghcr.io/substra/fabric-tools:0.2.4","command":["kubectl"],"args":["delete","secrets","-n","default","hlf-msp-cert-user","hlf-msp-key-user","hlf-cacert","hlf-tls-admin","hlf-tls-user","hlf-cacert","hlf-cacert","hlf-msp-cert-admin","hlf-msp-key-admin","ord-tls-rootcert","hlf-genesis","--ignore-not-found=true","--wait=true","-v=4"],"resources":{},"imagePullPolicy":"IfNotPresent"}],"restartPolicy":"OnFailure","serviceAccountName":null}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"hlf-peer","chart":"hlf-peer-5.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-peer"},"sourcePath":"templates/hlf-k8s_template.yaml:26","spec":{"replicas":1,"selector":{"matchLabels":{"app":"hlf-peer","release":"release-name"}},"strategy":{"rollingUpdate":{"maxUnavailable":1}},"template":{"metadata":{"labels":{"app":"hlf-peer","chart":"hlf-peer-5.1.0","heritage":"Helm","release":"release-name"}},"spec":{"containers":[{"name":"peer","image":"ghcr.io/substra/fabric-peer:0.2.4","command":["sh","-c","# To avoid having separate secrets for CouchDB and HLF\nexport CORE_LEDGER_STATE_COUCHDBCONFIG_USERNAME=$COUCHDB_USER\nexport CORE_LEDGER_STATE_COUCHDBCONFIG_PASSWORD=$COUCHDB_PASSWORD\n\nwhile [ ! -d /var/hyperledger/admin_msp/admincerts ] || [ -z \"$(ls -A /var/hyperledger/admin_msp/admincerts)\" ];\ndo\n  echo \"\\033[0;31m /var/hyperledger/admin_msp/admincerts must contain Peer admin certificates files \\033[0m\"\n  sleep 60\ndone\n\nwhile [ ! -d ${CORE_PEER_MSPCONFIGPATH}/signcerts ];\ndo\n  echo \"\\033[0;31m ${CORE_PEER_MSPCONFIGPATH}/signcerts directory must exist \\033[0m\"\n  sleep 60\ndone\n\nif [ ! -d ${FABRIC_CFG_PATH} ]\nthen\n  mkdir -p ${FABRIC_CFG_PATH}\n  cp -r /etc/hyperledger/fabric/core.yaml ${FABRIC_CFG_PATH}\n  ls ${FABRIC_CFG_PATH}\nfi\n\nif [ $CORE_PEER_TLS_CLIENTAUTHREQUIRED ]\nthen\n  export CORE_PEER_TLS_CLIENTROOTCAS_FILES=$(ls -d $CORE_PEER_TLS_CLIENTROOTCAS_FILES)\nfi\n\necho \"\u003e\\033[0;35m peer node start \\033[0m\"\npeer node start\n"],"ports":[{"name":"request","containerPort":7051,"protocol":"TCP"},{"name":"event","containerPort":7053,"protocol":"TCP"}],"envFrom":[{"secretRef":{"name":"hlf-couchdb-credentials"}},{"configMapRef":{"name":"release-name-hlf-peer--peer"}}],"resources":{},"volumeMounts":[{"name":"data","mountPath":"/var/hyperledger"},{"name":"id-cert","mountPath":"/var/hyperledger/msp/signcerts"},{"name":"id-key","mountPath":"/var/hyperledger/msp/keystore"},{"name":"cacert","mountPath":"/var/hyperledger/msp/cacerts"},{"name":"cacert","mountPath":"/var/hyperledger/admin_msp/cacerts"},{"name":"tls","mountPath":"/var/hyperledger/tls/server/pair"},{"name":"tls-rootcert","mountPath":"/var/hyperledger/tls/server/cert"},{"name":"tls-client","mountPath":"/var/hyperledger/tls/client/pair"},{"name":"tls-clientrootcert","mountPath":"/var/hyperledger/tls/client/cert"},{"name":"ord-tls-rootcert","mountPath":"/var/hyperledger/tls/ord/cert"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/admincerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/signcerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/msp/admincerts"},{"name":"admin-key","mountPath":"/var/hyperledger/admin_msp/keystore"}],"livenessProbe":{"exec":{"command":["ls","/var/hyperledger"]},"initialDelaySeconds":5,"periodSeconds":5},"readinessProbe":{"exec":{"command":["ls","/var/hyperledger"]},"initialDelaySeconds":15},"imagePullPolicy":"IfNotPresent"}],"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"release-name-hlf-peer"}},{"name":"id-cert","secret":{"secretName":"hlf-msp-cert-user"}},{"name":"id-key","secret":{"secretName":"hlf-msp-key-user"}},{"name":"cacert","secret":{"secretName":"hlf-cacert"}},{"name":"tls","secret":{"secretName":"hlf-tls-admin"}},{"name":"tls-rootcert","secret":{"secretName":"hlf-cacert"}},{"name":"tls-client","secret":{"secretName":"hlf-tls-user"}},{"name":"tls-clientrootcert","secret":{"secretName":"hlf-cacert"}},{"name":"admin-cert","secret":{"secretName":"hlf-msp-cert-admin"}},{"name":"admin-key","secret":{"secretName":"hlf-msp-key-admin"}},{"name":"ord-tls-rootcert","secret":{"secretName":"ord-tls-rootcert"}}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","object":{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-hlf-k8s"},"sourcePath":"templates/hlf-k8s_template.yaml:18","subjects":[{"kind":"ServiceAccount","name":"release-name-hlf-k8s","namespace":"default"}]},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3534644131/api=/v1//ConfigMap/release-name-hlf-k8s-fabric","object":{"apiVersion":"v1","data":{"configtx.yaml":"XXXXXX","core.yaml":"XXXXXX","discoverConfig.yaml":"XXXXXX"},"kind":"ConfigMap","metadata":{"name":"release-name-hlf-k8s-fabric"},"sourcePath":"templates/hlf-k8s_template.yaml:14"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1482792837/api=/v1//ServiceAccount/release-name-couchdb","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app":"couchdb","chart":"couchdb-3.3.4","heritage":"Helm","release":"release-name"},"name":"release-name-couchdb"},"sourcePath":"templates/hlf-k8s_template.yaml:1"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3584976988/api=/v1//ConfigMap/release-name-hlf-k8s-application-organizations-mychannel","object":{"apiVersion":"v1","data":{"application-organizations":"XXXXXX"},"kind":"ConfigMap","metadata":{"name":"release-name-hlf-k8s-application-organizations-mychannel"},"sourcePath":"templates/hlf-k8s_template.yaml:11"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","object":{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"labels":{"app":"couchdb","chart":"couchdb-3.3.4","heritage":"Helm","release":"release-name"},"name":"release-name-couchdb"},"sourcePath":"templates/hlf-k8s_template.yaml:30","spec":{"podManagementPolicy":"Parallel","replicas":1,"selector":{"matchLabels":{"app":"couchdb","release":"release-name"}},"serviceName":"release-name-couchdb","template":{"metadata":{"labels":{"app":"couchdb","release":"release-name"}},"spec":{"containers":[{"name":"couchdb","image":"couchdb:3.1.1","ports":[{"name":"couchdb","containerPort":5984},{"name":"epmd","containerPort":4369},{"containerPort":9100}],"env":[{"name":"COUCHDB_USER","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-couchdb","key":"adminUsername"}}},{"name":"COUCHDB_PASSWORD","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-couchdb","key":"adminPassword"}}},{"name":"COUCHDB_SECRET","value":"XXXXXX","valueFrom":{"secretKeyRef":{"name":"release-name-couchdb","key":"cookieAuthSecret"}}},{"name":"ERL_FLAGS","value":"XXXXXX"}],"resources":{},"volumeMounts":[{"name":"config-storage","mountPath":"/opt/couchdb/etc/default.d"},{"name":"database-storage","mountPath":"/opt/couchdb/data"}],"livenessProbe":{"httpGet":{"path":"/_up","port":5984},"timeoutSeconds":1,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"readinessProbe":{"httpGet":{"path":"/_up","port":5984},"timeoutSeconds":1,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","cp /tmp/chart.ini /default.d; cp /tmp/seedlist.ini /default.d; ls -lrt /default.d;"],"image":"busybox:latest","imagePullPolicy":"Always","name":"init-copy","volumeMounts":[{"mountPath":"/tmp/","name":"config"},{"mountPath":"/default.d","name":"config-storage"}]}],"serviceAccountName":"release-name-couchdb","volumes":[{"emptyDir":{},"name":"config-storage"},{"configMap":{"items":[{"key":"inifile","path":"chart.ini"},{"key":"seedlistinifile","path":"seedlist.ini"}],"name":"release-name-couchdb"},"name":"config"}]}},"volumeClaimTemplates":[{"metadata":{"labels":{"app":"couchdb","release":"release-name"},"name":"database-storage"},"spec":{"accessModes":["ReadWriteOnce"],"resources":{"requests":{"storage":"10Gi"}}}}]}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","object":{"apiVersion":"batch/v1","kind":"Job","metadata":{"annotations":{"helm.sh/hook":"post-delete","helm.sh/hook-delete-policy":"hook-succeeded"},"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s-hook-chaincode-delete-secrets","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s-hook-chaincode-delete-secrets","namespace":"default"},"sourcePath":"templates/hlf-k8s_template.yaml:32","spec":{"template":{"spec":{"containers":[{"name":"fabric-tools","image":"ghcr.io/substra/fabric-tools:0.2.4","command":["kubectl"],"args":["delete","secrets","-n","default","--ignore-not-found=true","--wait=true","-v=4"],"resources":{},"imagePullPolicy":"IfNotPresent"}],"restartPolicy":"OnFailure","serviceAccountName":null}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app":"hlf-ca","chart":"hlf-ca-2.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-ca"},"sourcePath":"templates/hlf-k8s_template.yaml:25","spec":{"replicas":1,"selector":{"matchLabels":{"app":"hlf-ca","release":"release-name"}},"strategy":{"rollingUpdate":{"maxUnavailable":1}},"template":{"metadata":{"labels":{"app":"hlf-ca","chart":"hlf-ca-2.1.0","heritage":"Helm","release":"release-name"}},"spec":{"containers":[{"name":"ca","image":"hyperledger/fabric-ca:1.5.0","command":["sh","-c","if [ -n \"$DB_TYPE\" ]; then\n  while [ -z ${DB_PASSWORD+x} ];\n  do\n    echo \"\\033[0;31mDB_PASSWORD environmental variable must contain a value \\033[0m\"\n    sleep 60\n  done\n\n  case \"$DB_TYPE\" in\n    postgres)\n      export DB_DATASOURCE=\"host=${DB_HOST} port=${DB_PORT} user=${DB_USERNAME} password=${DB_PASSWORD} dbname=${DB_DATABASE} sslmode=${DB_SSL}\";;\n    mysql)\n      export DB_DATASOURCE=\"${DB_USERNAME}:${DB_PASSWORD}@tcp(${DB_HOST}:${DB_PORT})/${DB_DATABASE}?parseTime=true\" ;;\n    *)\n      echo \"\\033[0;31m Database type '$DB_TYPE' not supported\\033[0m\"; exit 1;;\n  esac\nfi\n\nmkdir -p $FABRIC_CA_HOME\ncp /var/hyperledger/ca_config/ca.yaml $FABRIC_CA_HOME/fabric-ca-server-config.yaml\nsed -i \"s|\u003c\u003c\u003cADMIN\u003e\u003e\u003e|${CA_ADMIN}|g\" ${FABRIC_CA_HOME}/fabric-ca-server-config.yaml\nsed -i \"s|\u003c\u003c\u003cADMINPW\u003e\u003e\u003e|${CA_PASSWORD}|g\" $FABRIC_CA_HOME/fabric-ca-server-config.yaml\nsed -i \"s|\u003c\u003c\u003cDB_TYPE\u003e\u003e\u003e|${DB_TYPE:-\"sqlite3\"}|g\" $FABRIC_CA_HOME/fabric-ca-server-config.yaml\nsed -i \"s|\u003c\u003c\u003cDB_DATASOURCE\u003e\u003e\u003e|${DB_DATASOURCE:-\"fabric-ca-server.db\"}|g\" $FABRIC_CA_HOME/fabric-ca-server-config.yaml\n\necho \"\u003e\\033[0;35m fabric-ca-server start \\033[0m\"\nfabric-ca-server start\n"],"ports":[{"name":"ca-port","containerPort":7054,"protocol":"TCP"}],"envFrom":[{"secretRef":{"name":"release-name-hlf-ca--ca"}},{"configMapRef":{"name":"release-name-hlf-ca--db"}},{"configMapRef":{"name":"release-name-hlf-ca--ca"}}],"resources":{},"volumeMounts":[{"name":"data","mountPath":"/var/hyperledger"},{"name":"ca-config","readOnly":true,"mountPath":"/var/hyperledger/ca_config"}],"livenessProbe":{"httpGet":{"path":"/cainfo","port":7054}},"readinessProbe":{"httpGet":{"path":"/cainfo","port":7054}},"imagePullPolicy":"IfNotPresent"}],"initContainers":[{"command":["sh","-c","if [ -n \"$DB_TYPE\" ]; then\n  dockerize -wait tcp://$DB_HOST:$DB_PORT -timeout 30s \u0026\u0026 echo \"Database $DB_TYPE on $DB_HOST:$DB_PORT is ready\"\nfi\n"],"envFrom":[{"configMapRef":{"name":"release-name-hlf-ca--db"}}],"image":"jwilder/dockerize:latest","imagePullPolicy":"IfNotPresent","name":"wait-for-db"}],"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"release-name-hlf-ca"}},{"configMap":{"name":"release-name-hlf-ca--config"},"name":"ca-config"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1617013789/api=/v1//ConfigMap/release-name-hlf-ca--db","object":{"apiVersion":"v1","data":{"DB_SSL":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"hlf-ca","chart":"hlf-ca-2.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-ca--db"},"sourcePath":"templates/hlf-k8s_template.yaml:9"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=3635309845/api=/v1//ConfigMap/release-name-hlf-k8s-application-proposal-organizations-mychannel","object":{"apiVersion":"v1","data":{"application-proposal-organizations":"XXXXXX"},"kind":"ConfigMap","metadata":{"name":"release-name-hlf-k8s-application-proposal-organizations-mychannel"},"sourcePath":"templates/hlf-k8s_template.yaml:12"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1382127123/api=/v1//ConfigMap/release-name-hlf-ca--ca","object":{"apiVersion":"v1","data":{"FABRIC_CA_HOME":"XXXXXX","FABRIC_CA_SERVER_CA_NAME":"XXXXXX","GODEBUG":"XXXXXX","SERVICE_DNS":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"hlf-ca","chart":"hlf-ca-2.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-ca--ca"},"sourcePath":"templates/hlf-k8s_template.yaml:7"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1432459980/api=/v1//ServiceAccount/release-name-hlf-k8s","object":{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s"},"sourcePath":"templates/hlf-k8s_template.yaml:2"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","object":{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s-config-operator"},"sourcePath":"templates/hlf-k8s_template.yaml:28","spec":{"replicas":1,"selector":{"matchLabels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-config-operator"}},"template":{"metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/name":"hlf-k8s-config-operator"}},"spec":{"containers":[{"name":"fabric-tools","image":"ghcr.io/substra/fabric-tools:0.2.4","command":["sh","-c"],"args":["## Create configuration files (public keys) for the organization\nwhile true; do\n\n  until [ -f \"/data/configOrg.json\" ]; do\n    printf \"[DEBUG] Create the organization config file\\n\"\n    configtxgen -printOrg MyOrganization \u003e /data/configOrg.json\n    sleep 1\n  done\n\n  until [ -f \"/data/configOrgWithAnchors.json\" ]; do\n    printf \"[DEBUG] Create the org config anchor file\\n\"\n    jq -s '.[0] * {\"values\":{\"AnchorPeers\":{\"mod_policy\":\"Admins\", \"value\":{\"anchor_peers\":[{\"host\":\"peer-hostname\", \"port\":\"7051\"}]}, \"version\": \"0\"}}}' /data/configOrg.json \u003e /data/configOrgWithAnchors.json\n    sleep 1\n  done\n\n  sleep 10\ndone\n"],"env":[{"name":"CORE_PEER_MSPCONFIGPATH","value":"XXXXXX"},{"name":"GODEBUG","value":"XXXXXX"}],"resources":{},"volumeMounts":[{"name":"fabric-config","readOnly":true,"mountPath":"/etc/hyperledger/fabric"},{"name":"id-cert","mountPath":"/var/hyperledger/msp/signcerts"},{"name":"id-key","mountPath":"/var/hyperledger/msp/keystore"},{"name":"cacert","mountPath":"/var/hyperledger/msp/cacerts"},{"name":"cacert","mountPath":"/var/hyperledger/msp/tlscacerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/msp/admincerts"},{"name":"tls","mountPath":"/var/hyperledger/tls/server/pair"},{"name":"tls-rootcert","mountPath":"/var/hyperledger/tls/server/cert"},{"name":"tls-client","mountPath":"/var/hyperledger/tls/client/pair"},{"name":"tls-clientrootcert","mountPath":"/var/hyperledger/tls/client/cert"},{"name":"ord-tls-rootcert","mountPath":"/var/hyperledger/tls/ord/cert"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/signcerts"},{"name":"admin-key","mountPath":"/var/hyperledger/admin_msp/keystore"},{"name":"cacert","mountPath":"/var/hyperledger/admin_msp/cacerts"},{"name":"cacert","mountPath":"/var/hyperledger/admin_msp/tlscacerts"},{"name":"admin-cert","mountPath":"/var/hyperledger/admin_msp/admincerts"},{"name":"data","mountPath":"/data"}],"imagePullPolicy":"IfNotPresent"},{"name":"nginx","image":"nginx:1.17.6","ports":[{"containerPort":80}],"resources":{},"volumeMounts":[{"name":"data","mountPath":"/usr/share/nginx/html/config"}]}],"serviceAccountName":"release-name-hlf-k8s","volumes":[{"configMap":{"name":"release-name-hlf-k8s-fabric"},"name":"fabric-config"},{"name":"id-cert","secret":{"secretName":"hlf-msp-cert-user"}},{"name":"id-key","secret":{"secretName":"hlf-msp-key-user"}},{"name":"cacert","secret":{"secretName":"hlf-cacert"}},{"name":"tls","secret":{"secretName":"hlf-tls-admin"}},{"name":"tls-rootcert","secret":{"secretName":"hlf-cacert"}},{"name":"tls-client","secret":{"secretName":"hlf-tls-user"}},{"name":"tls-clientrootcert","secret":{"secretName":"hlf-cacert"}},{"name":"admin-cert","secret":{"secretName":"hlf-msp-cert-admin"}},{"name":"admin-key","secret":{"secretName":"hlf-msp-key-admin"}},{"name":"ord-tls-rootcert","secret":{"secretName":"ord-tls-rootcert"}},{"emptyDir":{},"name":"data"}]}}}},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","object":{"kind":"ServiceAccount","name":"release-name-hlf-k8s","namespace":"default","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"RoleBinding","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"Role","name":"release-name-hlf-k8s"},"sourcePath":"templates/hlf-k8s_template.yaml:18","subjects":[{"kind":"ServiceAccount","name":"release-name-hlf-k8s","namespace":"default"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"Role","metadata":{"labels":{"app.kubernetes.io/instance":"release-name","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"hlf-k8s","app.kubernetes.io/part-of":"hlf-k8s","helm.sh/chart":"hlf-k8s-10.2.4"},"name":"release-name-hlf-k8s"},"rules":[{"apiGroups":[""],"resources":["secrets"],"verbs":["get","watch","list","create","delete"]}],"sourcePath":"templates/hlf-k8s_template.yaml:17"}]}},{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","object":{"apiVersion":"v1","data":{"ADMIN_MSP_PATH":"XXXXXX","CORE_CHAINCODE_BUILDER":"XXXXXX","CORE_CHAINCODE_GOLANG_RUNTIME":"XXXXXX","CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS":"XXXXXX","CORE_LEDGER_STATE_STATEDATABASE":"XXXXXX","CORE_LOGGING_CAUTHDSL":"XXXXXX","CORE_LOGGING_GOSSIP":"XXXXXX","CORE_LOGGING_GRPC":"XXXXXX","CORE_LOGGING_LEDGER":"XXXXXX","CORE_LOGGING_LEVEL":"XXXXXX","CORE_LOGGING_MSP":"XXXXXX","CORE_LOGGING_PEER":"XXXXXX","CORE_LOGGING_POLICIES":"XXXXXX","CORE_METRICS_PROVIDER":"XXXXXX","CORE_PEER_ADDRESSAUTODETECT":"XXXXXX","CORE_PEER_COMMITTER_ENABLED":"XXXXXX","CORE_PEER_DISCOVERY_PERIOD":"XXXXXX","CORE_PEER_DISCOVERY_TOUCHPERIOD":"XXXXXX","CORE_PEER_EVENTS_ADDRESS":"XXXXXX","CORE_PEER_GOSSIP_BOOTSTRAP":"XXXXXX","CORE_PEER_GOSSIP_ENDPOINT":"XXXXXX","CORE_PEER_GOSSIP_EXTERNALENDPOINT":"XXXXXX","CORE_PEER_GOSSIP_ORGLEADER":"XXXXXX","CORE_PEER_GOSSIP_USELEADERELECTION":"XXXXXX","CORE_PEER_ID":"XXXXXX","CORE_PEER_LISTENADDRESS":"XXXXXX","CORE_PEER_LOCALMSPID":"XXXXXX","CORE_PEER_MSPCONFIGPATH":"XXXXXX","CORE_PEER_NETWORKID":"XXXXXX","CORE_PEER_PROFILE_ENABLED":"XXXXXX","CORE_PEER_TLS_CERT_FILE":"XXXXXX","CORE_PEER_TLS_CLIENTAUTHREQUIRED":"XXXXXX","CORE_PEER_TLS_CLIENTCERT_FILE":"XXXXXX","CORE_PEER_TLS_CLIENTKEY_FILE":"XXXXXX","CORE_PEER_TLS_CLIENTROOTCAS_FILES":"XXXXXX","CORE_PEER_TLS_ENABLED":"XXXXXX","CORE_PEER_TLS_KEY_FILE":"XXXXXX","CORE_PEER_TLS_ROOTCERT_FILE":"XXXXXX","FABRIC_CFG_PATH":"XXXXXX","FABRIC_LOGGING_SPEC":"XXXXXX","GODEBUG":"XXXXXX","ORD_TLS_PATH":"XXXXXX","PEER_CFG_PATH":"XXXXXX"},"kind":"ConfigMap","metadata":{"labels":{"app":"hlf-peer","chart":"hlf-peer-5.1.0","heritage":"Helm","release":"release-name"},"name":"release-name-hlf-peer--peer"},"sourcePath":"templates/hlf-k8s_template.yaml:10"},"source":{"path":"/Applications/Utilities/repos/LLM-Helm-Fix","relativePath":"templates/hlf-k8s_template.yaml","fileType":"YAML","lastCommit":{"hash":"22425b39f798b4a650e9422f378873671f6eb8cd","date":"2024-05-18T19:04:42+02:00","committerName":"Francesco Minna","committerEmail":"fra1995m@gmail.com","message":"charts stats\n"}}}],"attributes":null,"results":[{"prioritizedResource":{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}},{"resourceID":"path=1671887137/api=apps/v1//Deployment/release-name-hlf-k8s-appchannel-operator-mychannel","fixPath":{"path":"spec.template.spec.containers[1].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=1466015218/api=networking.k8s.io/v1//NetworkPolicy/release-name-couchdb","controls":[{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"passed"},"rules":[{"name":"ingress-and-egress-blocked","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1600236170/api=/v1//ConfigMap/release-name-hlf-ca--config","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1365349504/api=/v1//ConfigMap/release-name-couchdb","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3618532226/api=/v1//ConfigMap/release-name-hlf-k8s-enrollment","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1571221423/api=apps/v1//Deployment/release-name-hlf-k8s-enrollment-operator","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1772699946/api=batch/v1/default/Job/release-name-hlf-k8s-hook-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1655109518/api=apps/v1//Deployment/release-name-hlf-peer","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","controls":[{"controlID":"C-0262","name":"Anonymous access enabled","status":{"status":"passed"},"rules":[{"name":"anonymous-access-enabled","status":"passed","subStatus":""}]}]},{"resourceID":"path=3534644131/api=/v1//ConfigMap/release-name-hlf-k8s-fabric","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1482792837/api=/v1//ServiceAccount/release-name-couchdb","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"resourceID":"path=3584976988/api=/v1//ConfigMap/release-name-hlf-k8s-application-organizations-mychannel","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":20.900000000000002,"severity":3},"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1789477565/api=apps/v1//StatefulSet/release-name-couchdb","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1755922327/api=batch/v1/default/Job/release-name-hlf-k8s-hook-chaincode-delete-secrets","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"prioritizedResource":{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1638331899/api=apps/v1//Deployment/release-name-hlf-ca","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"path=1617013789/api=/v1//ConfigMap/release-name-hlf-ca--db","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=3635309845/api=/v1//ConfigMap/release-name-hlf-k8s-application-proposal-organizations-mychannel","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1382127123/api=/v1//ConfigMap/release-name-hlf-ca--ca","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"passed","subStatus":""}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]},{"resourceID":"path=1432459980/api=/v1//ServiceAccount/release-name-hlf-k8s","controls":[{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]}]},{"prioritizedResource":{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","priorityVector":[{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0270","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"service-destruction","type":"control","vector":[{"controlID":"C-0271","category":"Denial of service","tags":["compliance","devops","security"]}],"score":8.8,"severity":3},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0260","category":"Lateral Movement (Network)","tags":["security"]}],"score":5.5,"severity":2},{"attackTrackName":"workload-external-track","type":"control","vector":[{"controlID":"C-0017","category":"Persistence","tags":["security","compliance","smartRemediation"]}],"score":3.3000000000000003,"severity":1}],"score":26.400000000000002,"severity":3},"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","controls":[{"controlID":"C-0057","name":"Privileged container","status":{"status":"passed"},"rules":[{"name":"rule-privilege-escalation","status":"passed","subStatus":""}]},{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-wl-v1","status":"passed","subStatus":""}]},{"controlID":"C-0020","name":"Mount service principal","status":{"status":"passed"},"rules":[{"name":"alert-mount-potential-credentials-paths","status":"passed","subStatus":""}]},{"controlID":"C-0030","name":"Ingress and Egress blocked","status":{"status":"failed"},"rules":[{"name":"ingress-and-egress-blocked","status":"failed","subStatus":""}]},{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"passed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-in-env-var","status":"passed","subStatus":""}]},{"controlID":"C-0016","name":"Allow privilege escalation","status":{"status":"failed"},"rules":[{"name":"rule-allow-privilege-escalation","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.allowPrivilegeEscalation","value":"false"}}]}]},{"controlID":"C-0046","name":"Insecure capabilities","status":{"status":"passed"},"rules":[{"controlConfigurations":{"insecureCapabilities":["SETPCAP","NET_ADMIN","NET_RAW","SYS_MODULE","SYS_RAWIO","SYS_PTRACE","SYS_ADMIN","SYS_BOOT","MAC_OVERRIDE","MAC_ADMIN","PERFMON","ALL","BPF"]},"name":"insecure-capabilities","status":"passed","subStatus":""}]},{"controlID":"C-0038","name":"Host PID/IPC privileges","status":{"status":"passed"},"rules":[{"name":"host-pid-ipc-privileges","status":"passed","subStatus":""}]},{"controlID":"C-0044","name":"Container hostPort","status":{"status":"passed"},"rules":[{"name":"container-hostPort","status":"passed","subStatus":""}]},{"controlID":"C-0055","name":"Linux hardening","status":{"status":"failed"},"rules":[{"name":"linux-hardening","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.seccompProfile","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.seLinuxOptions","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.capabilities.drop[0]","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0045","name":"Writable hostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-rw-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0034","name":"Automatic mapping of service account","status":{"status":"passed"},"rules":[{"name":"automount-service-account","status":"passed","subStatus":""}]},{"controlID":"C-0048","name":"HostPath mount","status":{"status":"passed"},"rules":[{"name":"alert-any-hostpath","status":"passed","subStatus":""}]},{"controlID":"C-0017","name":"Immutable container filesystem","status":{"status":"failed"},"rules":[{"name":"immutable-container-filesystem","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.readOnlyRootFilesystem","value":"true"}}]}]},{"controlID":"C-0013","name":"Non-root containers","status":{"status":"failed"},"rules":[{"name":"non-root-containers","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].securityContext.runAsGroup","value":"1000"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.runAsNonRoot","value":"true"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].securityContext.runAsGroup","value":"1000"}}]}]},{"controlID":"C-0271","name":"Ensure memory limits are set","status":{"status":"failed"},"rules":[{"name":"resources-memory-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].resources.limits.memory","value":"YOUR_VALUE"}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"failed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"failed","subStatus":""}]},{"controlID":"C-0041","name":"HostNetwork access","status":{"status":"passed"},"rules":[{"name":"host-network-access","status":"passed","subStatus":""}]},{"controlID":"C-0270","name":"Ensure CPU limits are set","status":{"status":"failed"},"rules":[{"name":"resources-cpu-limits","status":"failed","subStatus":"","paths":[{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}},{"resourceID":"path=1554443804/api=apps/v1//Deployment/release-name-hlf-k8s-config-operator","fixPath":{"path":"spec.template.spec.containers[1].resources.limits.cpu","value":"YOUR_VALUE"}}]}]}]},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","controls":[{"controlID":"C-0014","name":"Access Kubernetes dashboard","status":{"status":"passed"},"rules":[{"name":"rule-access-dashboard-subject-v1","status":"passed","subStatus":""}]},{"controlID":"C-0035","name":"Administrative Roles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0188","name":"Minimize access to create pods","status":{"status":"passed"},"rules":[{"name":"rule-can-create-pod","status":"passed","subStatus":""}]},{"controlID":"C-0015","name":"List Kubernetes secrets","status":{"status":"failed"},"rules":[{"name":"rule-can-list-get-secrets-v1","status":"failed","subStatus":"","paths":[{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].resources[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].verbs[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].verbs[1]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].verbs[2]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].apiGroups[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[0].subjects[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[0].roleRef.name","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].resources[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].verbs[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].verbs[1]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].verbs[2]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].apiGroups[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[0].subjects[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[0].roleRef.name","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0187","name":"Minimize wildcard use in Roles and ClusterRoles","status":{"status":"passed"},"rules":[{"name":"rule-list-all-cluster-admins-v1","status":"passed","subStatus":""}]},{"controlID":"C-0053","name":"Access container service account","status":{"status":"failed"},"rules":[{"name":"access-container-service-account-v1","status":"failed","subStatus":""}]},{"controlID":"C-0063","name":"Portforwarding privileges","status":{"status":"passed"},"rules":[{"name":"rule-can-portforward-v1","status":"passed","subStatus":""}]},{"controlID":"C-0002","name":"Prevent containers from allowing command execution","status":{"status":"passed"},"rules":[{"name":"exec-into-container-v1","status":"passed","subStatus":""}]},{"controlID":"C-0007","name":"Roles with delete capabilities","status":{"status":"failed"},"rules":[{"name":"rule-excessive-delete-rights-v1","status":"failed","subStatus":"","paths":[{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].resources[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].verbs[4]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[1].rules[0].apiGroups[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[0].subjects[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","failedPath":"relatedObjects[0].roleRef.name","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].resources[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].verbs[4]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[1].rules[0].apiGroups[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[0].subjects[0]","fixPath":{"path":"","value":""}},{"resourceID":"/default/ServiceAccount/release-name-hlf-k8s/path=3551421750/api=rbac.authorization.k8s.io/v1//Role/release-name-hlf-k8s/path=3735975559/api=rbac.authorization.k8s.io/v1//RoleBinding/release-name-hlf-k8s","reviewPath":"relatedObjects[0].roleRef.name","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0031","name":"Delete Kubernetes events","status":{"status":"passed"},"rules":[{"name":"rule-can-delete-k8s-events-v1","status":"passed","subStatus":""}]},{"controlID":"C-0037","name":"CoreDNS poisoning","status":{"status":"passed"},"rules":[{"name":"rule-can-update-configmap-v1","status":"passed","subStatus":""}]}]},{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","controls":[{"controlID":"C-0012","name":"Applications credentials in configuration files","status":{"status":"failed"},"rules":[{"controlConfigurations":{"sensitiveKeyNames":["aws_access_key_id","aws_secret_access_key","azure_batchai_storage_account","azure_batchai_storage_key","azure_batch_account","azure_batch_key","secret","key","password","pwd","token","jwt","bearer","credential"],"sensitiveKeyNamesAllowed":[],"sensitiveValues":["BEGIN \\w+ PRIVATE KEY","PRIVATE KEY","eyJhbGciO","JWT","Bearer","_key_","_secret_"],"sensitiveValuesAllowed":[]},"name":"rule-credentials-configmap","status":"failed","subStatus":"","paths":[{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","failedPath":"data[CORE_PEER_TLS_CLIENTKEY_FILE]","fixPath":{"path":"","value":""}},{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","deletePath":"data[CORE_PEER_TLS_CLIENTKEY_FILE]","fixPath":{"path":"","value":""}},{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","failedPath":"data[CORE_PEER_TLS_KEY_FILE]","fixPath":{"path":"","value":""}},{"resourceID":"path=3601754607/api=/v1//ConfigMap/release-name-hlf-peer--peer","deletePath":"data[CORE_PEER_TLS_KEY_FILE]","fixPath":{"path":"","value":""}}]}]},{"controlID":"C-0260","name":"Missing network policy","status":{"status":"passed"},"rules":[{"name":"ensure_network_policy_configured_in_labels","status":"passed","subStatus":""}]}]}],"metadata":{"targetMetadata":{"gitRepoContextMetadata":{"provider":"github","repo":"LLM-Helm-Fix","owner":"fminna","branch":"main","remoteURL":"https://github.com/fminna/LLM-Helm-Fix","lastCommit":{"hash":"58081b17c30dcf7edd5f95a1e7ba1d4057a23572","date":"0001-01-01T00:00:00Z"},"localRootPath":"/Applications/Utilities/repos/LLM-Helm-Fix"}},"clusterMetadata":{},"scanMetadata":{"targetType":"Framework","kubescapeVersion":"v3.0.1","formatVersion":"v2","formats":["json"],"targetNames":["clusterscan","mitre","nsa"],"failThreshold":100,"scanningTarget":3,"submit":true}},"paginationInfo":{"chunkNumber":0,"isLastChunk":false},"customerGUIDGenerated":false}