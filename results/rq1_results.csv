Chart,Tool,Alert_ID,Standard_ID,Description,Resource,Original_YAML
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}"
mysql,checkov,CKV_K8S_12,check_1,Memory requests should be set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}"
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}"
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}"
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['Service/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'type': 'ClusterIP', 'sessionAffinity': 'None', 'ports': [{'name': 'mysql', 'port': 3306, 'protocol': 'TCP', 'targetPort': 'mysql', 'nodePort': None}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}"
mysql,checkov,CKV_K8S_37,check_34,Minimize the admission of containers with capabilities assigned,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_31,check_31,Ensure that the seccomp profile is set to docker/default or runtime/default,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_20,check_22,Containers should not run with allowPrivilegeEscalation,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_15,check_25,Image Pull Policy should be Always,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_13,check_2,Memory limits should be set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_40,check_13,Containers should run as a high UID to avoid host conflict,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_10,check_4,CPU requests should be set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_22,check_27,Use read-only filesystem for containers where possible,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_35,check_33,Prefer using secrets as files over secrets as environment variables,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0/env/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_28,check_34,Minimize the admission of containers with the NET_RAW capability,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_38,check_35,Ensure that Service Account Tokens are only mounted where necessary,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_21,check_26,The default namespace should not be used,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_43,check_9,Image should use digest,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV_K8S_11,check_5,CPU limits should be set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,checkov,CKV2_K8S_6,check_40,Minimize the admission of pods which lack an associated NetworkPolicy,"['Pod/default/release-name-mysql', 'resource_type']",{}
mysql,datree,CONTAINERS_INCORRECT_READONLYROOTFILESYSTEM_VALUE,check_27,Ensure each container has a read-only root filesystem,"['StatefulSet/release-name-mysql', '/spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,CONTAINERS_MISSING_KEY_ALLOWPRIVILEGEESCALATION,check_22,Prevent containers from escalating privileges,"['StatefulSet/release-name-mysql', '/spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,CONTAINERS_INCORRECT_KEY_HOSTPORT,check_29,Prevent containers from insecurely exposing workload,"['StatefulSet/release-name-mysql', '/spec/template/spec']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,WORKLOAD_INCORRECT_NAMESPACE_VALUE_DEFAULT,check_26,Prevent workload from using the default namespace,"['StatefulSet/release-name-mysql', '/metadata']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,CONTAINERS_MISSING_MEMORY_REQUEST_KEY,check_1,Ensure each container has a configured memory request,"['StatefulSet/release-name-mysql', '/spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,CONTAINERS_MISSING_MEMORY_LIMIT_KEY,check_2,Ensure each container has a configured memory limit,"['StatefulSet/release-name-mysql', '/spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,datree,CONTAINERS_INCORRECT_RUNASUSER_VALUE_LOWUID,check_13,Prevent containers from accessing host files by using high UIDs,"['StatefulSet/release-name-mysql', '/spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d,check_22,Privilege Escalation Allowed,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,4ac0e2b7-d2d2-4af7-8799-e8de6721ccda,check_5,CPU Limits Not Set,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,ca469dd4-c736-448f-8ac1-30a642705e0a,check_4,CPU Requests Not Set,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,02323c00-cdc3-4fdc-a310-4f2b3e7a1660,check_13,Container Running With Low UID,"['StatefulSet/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,b14d1bc4-a208-45db-92f0-e21f8e2588e9,check_2,Memory Limits Not Defined,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,229588ef-8fde-40c8-8756-f4f2b5825ded,check_1,Memory Requests Not Defined,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,dbbc6705-d541-43b0-b166-dd4be8208b54,check_23,NET_RAW Capabilities Not Being Dropped,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,f377b83e-bd07-4f48-a591-60c82b14a78b,check_31,Seccomp Profile Is Not Configured,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,48471392-d4d0-47c0-b135-cdec95eb3eef,check_36,Service Account Token Automount Not Disabled,"['ServiceAccount/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['Secret/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['ConfigMap/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['StatefulSet/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['ServiceAccount/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['Service/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}"
mysql,kics,611ab018-c4aa-4ba2-b0f6-a448337509a6,check_26,Using Unrecommended Namespace,"['Service/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'type': 'ClusterIP', 'sessionAffinity': 'None', 'ports': [{'name': 'mysql', 'port': 3306, 'protocol': 'TCP', 'targetPort': 'mysql', 'nodePort': None}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}"
mysql,kics,caa3479d-885d-4882-9aac-95e5e78ef5c2,check_25,Image Pull Policy Of The Container Is Not Set To Always,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,7c81d34c-8e5a-402b-9798-9f442630e678,check_9,Image Without Digest,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,8b36775e-183d-4d46-b0f7-96a6f34a723f,check_32,Missing AppArmor Profile,"['StatefulSet/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,268ca686-7fb7-4ae9-b129-955a2a89064e,check_23,No Drop Capabilities for Containers,"['StatefulSet/release-name-mysql', 'spec/containers']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,4a20ebac-1060-4c81-95d1-1f7f620e983b,check_48,Pod or Container Without LimitRange,"['StatefulSet/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,48a5beba-e4c0-4584-a2aa-e6894e4cf424,check_49,Pod or Container Without ResourceQuota,"['StatefulSet/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,a9c2f49d-0671-4fc9-9ece-f4e261e128d0,check_27,Root Container Not Mounted Read-only,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,3d658f8b-d988-41a0-a841-40043121de1e,check_33,Secrets As Environment Variables,"['StatefulSet/release-name-mysql', 'spec/template/spec/containers/env']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kics,8cf4671a-cf3d-46fc-8389-21e7405063a2,check_52,StatefulSet Requests Storage,"['StatefulSet/release-name-mysql', 'spec/volumeClaimTemplates/0/spec/resources']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubelinter,no-read-only-root-fs,check_27,"container ""mysql"" does not have a read-only root file system. Set readOnlyRootFilesystem to true in the container securityContext.","['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubelinter,unset-cpu-requirements,check_4,"container ""mysql"" has cpu request 0. Set CPU requests and limits for your container based on its requirements","['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubelinter,unset-cpu-requirements,check_4,"container ""mysql"" has cpu limit 0. Set CPU requests and limits for your container based on its requirements","['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubelinter,unset-memory-requirements,check_1,"container ""mysql"" has memory request 0. Set memory requests and limits for your container based on its requirements","['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubelinter,unset-memory-requirements,check_1,"container ""mysql"" has memory limit 0. Set memory requests and limits for your container based on its requirements","['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubeaudit,AppArmorAnnotationMissing,check_32,AppArmor annotation missing. The annotation 'container.apparmor.security.beta.kubernetes.io/mysql' should be added.,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubeaudit,CapabilityOrSecurityContextMissing,check_34,Security Context not set. The Security Context should be specified and all Capabilities should be dropped by setting the Drop list to ALL.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubeaudit,AllowPrivilegeEscalationNil,check_22,allowPrivilegeEscalation not set which allows privilege escalation. It should be set to 'false'.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubeaudit,ReadOnlyRootFilesystemNil,check_27,readOnlyRootFilesystem is not set in container SecurityContext. It should be set to 'true'.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubeaudit,SeccompProfileMissing,check_31,Pod Seccomp profile is missing. Seccomp profile should be added to the pod SecurityContext.,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0034,check_35,Automatic mapping of service account,"['StatefulSet/default/release-name-mysql', 'spec/template']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0055,check_30,Linux hardening,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0270,,Ensure CPU limits are set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0013,check_22,Non-root containers,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0271,,Ensure memory limits are set,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0030,check_40,Ingress and Egress blocked,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0260,,Missing network policy,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0017,check_27,Immutable container filesystem,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0016,check_22,Allow privilege escalation,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,kubescape,C-0034,check_35,Automatic mapping of service account,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}"
mysql,terrascan,AC_K8S_0086,check_26,Default Namespace Should Not be Used,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0099,check_1,Memory Request Not Set in config file.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0097,check_4,CPU Request Not Set in config file.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0098,check_5,CPU Limits Not Set in config file.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0051,check_33,Prefer using secrets as files over secrets as environment variables,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0045,check_35,Ensure that Service Account Tokens are only mounted where necessary,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}"
mysql,terrascan,AC_K8S_0078,check_27,Container images with readOnlyRootFileSystem set as false mounts the container root file system with write permissions,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0100,check_2,Memory Limits Not Set in config file.,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0085,check_22,Containers Should Not Run with AllowPrivilegeEscalation,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
mysql,terrascan,AC_K8S_0073,check_32,AppArmor profile not set to default or custom profile will make the container vulnerable to kernel level threats,"['StatefulSet/default/release-name-mysql', '']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}"
