Chart,Tool,Alert_ID,Resource,Original_YAML,LLM,Refactored_YAML,Tool.1,Fixed
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': None, 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['Secret/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'Secret', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}}, 'type': 'Opaque', 'data': {'mysql-root-password': 'OVB6aHBscmQ2aA==', 'mysql-password': 'enVSVDd6eVJpSA=='}}",chatgpt,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ConfigMap/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'data': {'my.cnf': '[mysqld]\ndefault_authentication_plugin=mysql_native_password\nskip-name-resolve\nexplicit_defaults_for_timestamp\nbasedir=/opt/bitnami/mysql\nplugin_dir=/opt/bitnami/mysql/lib/plugin\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndatadir=/bitnami/mysql/data\ntmpdir=/opt/bitnami/mysql/tmp\nmax_allowed_packet=16M\nbind-address=*\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid\nlog-error=/opt/bitnami/mysql/logs/mysqld.log\ncharacter-set-server=UTF8\ncollation-server=utf8_general_ci\nslow_query_log=0\nslow_query_log_file=/opt/bitnami/mysql/logs/mysqld.log\nlong_query_time=10.0\n\n[client]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\ndefault-character-set=UTF8\nplugin_dir=/opt/bitnami/mysql/lib/plugin\n\n[manager]\nport=3306\nsocket=/opt/bitnami/mysql/tmp/mysql.sock\npid-file=/opt/bitnami/mysql/tmp/mysqld.pid'}}",gemini,"{'apiVersion': 'v1', 'automountServiceAccountToken': True, 'kind': 'ServiceAccount', 'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql'}}",checkov,no
mysql,checkov,CKV_K8S_21,"['Service/default/release-name-mysql-headless', '']","{'apiVersion': 'v1', 'kind': 'Service', 'metadata': {'name': 'release-name-mysql-headless', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'type': 'ClusterIP', 'clusterIP': 'None', 'publishNotReadyAddresses': True, 'ports': [{'name': 'mysql', 'port': 3306, 'targetPort': 'mysql'}], 'selector': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}}",gemini,"{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec - ""password_aux=\\""${MYSQL_ROOT_PASSWORD:-}\\""\\nif [[ -f \\""${MYSQL_ROOT_PASSWORD_FILE:-}\\""\\ \\ ]]; then\\n\xa0\xa0password_aux=$(cat \\""$MYSQL_ROOT_PASSWORD_FILE\\"")\\nfi\\nmysqladmin\\ \\ status -uroot -p\\""${password_aux}\\""\\n""']}}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",chatgpt,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'your-desired-namespace', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",checkov,yes
mysql,checkov,CKV_K8S_12,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}",chatgpt,"{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql', 'namespace': 'default'}, 'spec': {'podManagementPolicy': '', 'replicas': 1, 'selector': {'matchLabels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}}, 'serviceName': 'release-name-mysql', 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}}, 'spec': {'affinity': {'nodeAffinity': 'None', 'podAffinity': 'None', 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}}, 'containers': [{'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'key': 'mysql-root-password', 'name': 'release-name-mysql'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': 'None', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'livenessProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'name': 'mysql', 'ports': [{'containerPort': 3306, 'name': 'mysql'}], 'readinessProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'resources': {'limits': {'memory': '512Mi'}, 'requests': {'memory': '256Mi'}}, 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'startupProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'volumeMounts': [{'mountPath': '/bitnami/mysql', 'name': 'data'}, {'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'name': 'config', 'subPath': 'my.cnf'}]}], 'initContainers': 'None', 'securityContext': {'fsGroup': 1001}, 'serviceAccountName': 'release-name-mysql', 'volumes': [{'configMap': {'name': 'release-name-mysql'}, 'name': 'config'}]}}, 'updateStrategy': {'type': 'RollingUpdate'}, 'volumeClaimTemplates': [{'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}, 'name': 'data'}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}",checkov,yes
mysql,checkov,CKV_K8S_21,"['ServiceAccount/default/release-name-mysql', '']","{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': None}, 'automountServiceAccountToken': True, 'secrets': [{'name': 'release-name-mysql'}]}",gemini,"{'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'release-name-mysql', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm'}, 'annotations': 'None'}, 'automountServiceAccountToken': True}",checkov,no
mysql,checkov,CKV_K8S_12,"['StatefulSet/default/release-name-mysql', 'spec/template/spec/containers/0']","{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'name': 'release-name-mysql', 'namespace': 'default', 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'replicas': 1, 'podManagementPolicy': '', 'selector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}}, 'serviceName': 'release-name-mysql', 'updateStrategy': {'type': 'RollingUpdate'}, 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/component': 'primary'}}, 'spec': {'serviceAccountName': 'release-name-mysql', 'affinity': {'podAffinity': None, 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}, 'nodeAffinity': None}, 'securityContext': {'fsGroup': 1001}, 'initContainers': None, 'containers': [{'name': 'mysql', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'name': 'release-name-mysql', 'key': 'mysql-root-password'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': None, 'ports': [{'name': 'mysql', 'containerPort': 3306}], 'livenessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'readinessProbe': {'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'startupProbe': {'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1, 'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\nfi\nmysqladmin status -uroot -p""${password_aux}""\n']}}, 'resources': {'limits': {}, 'requests': {}}, 'volumeMounts': [{'name': 'data', 'mountPath': '/bitnami/mysql'}, {'name': 'config', 'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'subPath': 'my.cnf'}]}], 'volumes': [{'name': 'config', 'configMap': {'name': 'release-name-mysql'}}]}}, 'volumeClaimTemplates': [{'metadata': {'name': 'data', 'labels': {'app.kubernetes.io/name': 'mysql', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/component': 'primary'}, 'annotations': None}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}",gemini,"{'apiVersion': 'apps/v1', 'kind': 'StatefulSet', 'metadata': {'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}, 'name': 'release-name-mysql', 'namespace': 'default'}, 'spec': {'podManagementPolicy': '', 'replicas': 1, 'selector': {'matchLabels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}}, 'serviceName': 'release-name-mysql', 'template': {'metadata': {'annotations': {'checksum/configuration': '74f6d694934e49250ce5cfc5e93637df13431c704ef8367a3f69b565dd4aee71'}, 'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/managed-by': 'Helm', 'app.kubernetes.io/name': 'mysql', 'helm.sh/chart': 'mysql-9.7.1'}}, 'spec': {'affinity': {'nodeAffinity': 'None', 'podAffinity': 'None', 'podAntiAffinity': {'preferredDuringSchedulingIgnoredDuringExecution': [{'podAffinityTerm': {'labelSelector': {'matchLabels': {'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}}, 'topologyKey': 'kubernetes.io/hostname'}, 'weight': 1}]}}, 'containers': [{'env': [{'name': 'BITNAMI_DEBUG', 'value': 'false'}, {'name': 'MYSQL_ROOT_PASSWORD', 'valueFrom': {'secretKeyRef': {'key': 'mysql-root-password', 'name': 'release-name-mysql'}}}, {'name': 'MYSQL_DATABASE', 'value': 'my_database'}], 'envFrom': 'None', 'image': 'docker.io/bitnami/mysql:8.0.32-debian-11-r21', 'imagePullPolicy': 'IfNotPresent', 'livenessProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'name': 'mysql', 'ports': [{'containerPort': 3306, 'name': 'mysql'}], 'readinessProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 3, 'initialDelaySeconds': 5, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'resources': {'limits': {'memory': '500Mi'}, 'requests': {}}, 'securityContext': {'runAsNonRoot': True, 'runAsUser': 1001}, 'startupProbe': {'exec': {'command': ['/bin/bash', '-ec', 'password_aux=""${MYSQL_ROOT_PASSWORD:-}""\\nif [[ -f ""${MYSQL_ROOT_PASSWORD_FILE:-}"" ]]; then\\n    password_aux=$(cat ""$MYSQL_ROOT_PASSWORD_FILE"")\\nfi\\nmysqladmin status -uroot -p""${password_aux}""\\n']}, 'failureThreshold': 10, 'initialDelaySeconds': 15, 'periodSeconds': 10, 'successThreshold': 1, 'timeoutSeconds': 1}, 'volumeMounts': [{'mountPath': '/bitnami/mysql', 'name': 'data'}, {'mountPath': '/opt/bitnami/mysql/conf/my.cnf', 'name': 'config', 'subPath': 'my.cnf'}]}], 'initContainers': 'None', 'securityContext': {'fsGroup': 1001}, 'serviceAccountName': 'release-name-mysql', 'volumes': [{'configMap': {'name': 'release-name-mysql'}, 'name': 'config'}]}}, 'updateStrategy': {'type': 'RollingUpdate'}, 'volumeClaimTemplates': [{'metadata': {'annotations': 'None', 'labels': {'app.kubernetes.io/component': 'primary', 'app.kubernetes.io/instance': 'release-name', 'app.kubernetes.io/name': 'mysql'}, 'name': 'data'}, 'spec': {'accessModes': ['ReadWriteOnce'], 'resources': {'requests': {'storage': '8Gi'}}}}]}}",checkov,no
