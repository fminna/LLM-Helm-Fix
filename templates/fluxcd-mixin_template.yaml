---
# Source: fluxcd-mixin/templates/rules.yaml
# Copyright (C) Nicolas Lamirault <nicolas.lamirault@gmail.com>
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# SPDX-License-Identifier: Apache-2.0
---
# Source: fluxcd-mixin/templates/configmap-dashboards.yaml
apiVersion: v1
kind: ConfigMapList
items:
- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: dashboard-fluxcd-mixin-cluster
    namespace: default
    annotations:
      grafana-folder: monitoring      
      a8r.io/description: Monitoring Mixin for FluxCD
      a8r.io/owner: portefaix
      a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
      a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
      a8r.io/repository: https://github.com/portefaix/portefaix-hub
      a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
    labels:
      grafana-dashboard: cluster      
      helm.sh/chart: fluxcd-mixin-1.2.0
      app.kubernetes.io/name: fluxcd-mixin
      app.kubernetes.io/instance: release-name
      app.kubernetes.io/version: "master"
      app.kubernetes.io/component: monitoring-mixin
      app.kubernetes.io/part-of: fluxcd-mixin
      app.kubernetes.io/managed-by: Helm
  data:
    cluster.json: |-
      {
          "annotations": {
              "list": [
                  {
                      "builtIn": 1,
                      "datasource": "-- Grafana --",
                      "enable": true,
                      "hide": true,
                      "iconColor": "rgba(0, 211, 255, 1)",
                      "name": "Annotations & Alerts",
                      "type": "dashboard"
                  },
                  {
                      "datasource": {
                          "type": "datasource",
                          "uid": "grafana"
                      },
                      "enable": true,
                      "iconColor": "red",
                      "name": "flux events",
                      "target": {
                          "limit": 100,
                          "matchAny": false,
                          "tags": [
                              "flux"
                          ],
                          "type": "tags"
                      }
                  }
              ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "iteration": 1652337714814,
          "links": [],
          "panels": [
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 0,
                      "y": 0
                  },
                  "id": 24,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "count(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"True\",kind=~\"Kustomization|HelmRelease\"})\n-\nsum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"Deleted\",kind=~\"Kustomization|HelmRelease\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Cluster Reconcilers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "red",
                                      "value": null
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 6,
                      "y": 0
                  },
                  "id": 28,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "sum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"Kustomization|HelmRelease\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Failing Reconcilers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 12,
                      "y": 0
                  },
                  "id": 29,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "count(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"True\",kind=~\"GitRepository|HelmRepository|Bucket\"})\n-\nsum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"Deleted\",kind=~\"GitRepository|HelmRepository|Bucket\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Kubernetes Manifests Sources",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "red",
                                      "value": null
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 18,
                      "y": 0
                  },
                  "id": 30,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "sum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"GitRepository|HelmRepository|Bucket\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Failing Sources",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "green",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 1
                                  },
                                  {
                                      "color": "red",
                                      "value": 61
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 4,
                      "w": 12,
                      "x": 0,
                      "y": 5
                  },
                  "id": 8,
                  "options": {
                      "displayMode": "gradient",
                      "minVizHeight": 10,
                      "minVizWidth": 0,
                      "orientation": "horizontal",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showUnfilled": true,
                      "text": {}
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind)",
                          "interval": "",
                          "legendFormat": "{{kind}}",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Reconciler ops avg. duration",
                  "type": "bargauge"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "green",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 1
                                  },
                                  {
                                      "color": "red",
                                      "value": 61
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 4,
                      "w": 12,
                      "x": 12,
                      "y": 5
                  },
                  "id": 31,
                  "options": {
                      "displayMode": "gradient",
                      "minVizHeight": 10,
                      "minVizWidth": 0,
                      "orientation": "horizontal",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showUnfilled": true,
                      "text": {}
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind)",
                          "interval": "",
                          "legendFormat": "{{kind}}",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Source ops avg. duration",
                  "type": "bargauge"
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 9
                  },
                  "id": 15,
                  "panels": [],
                  "title": "Status",
                  "type": "row"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "custom": {
                              "displayMode": "auto",
                              "filterable": true,
                              "inspect": false
                          },
                          "mappings": [
                              {
                                  "options": {
                                      "0": {
                                          "text": "Ready"
                                      },
                                      "1": {
                                          "text": "Not Ready"
                                      }
                                  },
                                  "type": "value"
                              }
                          ],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "blue",
                                      "value": 0
                                  },
                                  {
                                      "color": "red",
                                      "value": 1
                                  }
                              ]
                          }
                      },
                      "overrides": [
                          {
                              "matcher": {
                                  "id": "byName",
                                  "options": "Status"
                              },
                              "properties": [
                                  {
                                      "id": "custom.displayMode",
                                      "value": "color-background"
                                  }
                              ]
                          }
                      ]
                  },
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 0,
                      "y": 10
                  },
                  "id": 33,
                  "options": {
                      "footer": {
                          "fields": "",
                          "reducer": [
                              "sum"
                          ],
                          "show": false
                      },
                      "showHeader": true,
                      "sortBy": [
                          {
                              "desc": true,
                              "displayName": "Status"
                          }
                      ]
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"Kustomization|HelmRelease\"}",
                          "format": "table",
                          "instant": true,
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Cluster reconciliation readiness ",
                  "transformations": [
                      {
                          "id": "organize",
                          "options": {
                              "excludeByName": {
                                  "Time": true,
                                  "__name__": true,
                                  "app": true,
                                  "container": true,
                                  "endpoint": true,
                                  "exported_namespace": false,
                                  "instance": true,
                                  "job": true,
                                  "kubernetes_namespace": true,
                                  "kubernetes_pod_name": true,
                                  "namespace": true,
                                  "pod": true,
                                  "pod_template_hash": true,
                                  "status": true,
                                  "type": true
                              },
                              "indexByName": {},
                              "renameByName": {
                                  "Value": "Status",
                                  "exported_namespace": "Namespace",
                                  "kind": "Kind",
                                  "name": "Name",
                                  "namespace": "Operator Namespace"
                              }
                          }
                      }
                  ],
                  "type": "table"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "custom": {
                              "displayMode": "auto",
                              "filterable": true,
                              "inspect": false
                          },
                          "mappings": [
                              {
                                  "options": {
                                      "0": {
                                          "text": "Ready"
                                      },
                                      "1": {
                                          "text": "Not Ready"
                                      }
                                  },
                                  "type": "value"
                              }
                          ],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "blue",
                                      "value": 0
                                  },
                                  {
                                      "color": "red",
                                      "value": 1
                                  }
                              ]
                          }
                      },
                      "overrides": [
                          {
                              "matcher": {
                                  "id": "byName",
                                  "options": "Status"
                              },
                              "properties": [
                                  {
                                      "id": "custom.displayMode",
                                      "value": "color-background"
                                  }
                              ]
                          }
                      ]
                  },
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 12,
                      "y": 10
                  },
                  "id": 34,
                  "options": {
                      "footer": {
                          "fields": "",
                          "reducer": [
                              "sum"
                          ],
                          "show": false
                      },
                      "showHeader": true,
                      "sortBy": [
                          {
                              "desc": true,
                              "displayName": "Status"
                          }
                      ]
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"GitRepository|HelmRepository|Bucket\"}",
                          "format": "table",
                          "instant": true,
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Source acquisition readiness ",
                  "transformations": [
                      {
                          "id": "organize",
                          "options": {
                              "excludeByName": {
                                  "Time": true,
                                  "__name__": true,
                                  "app": true,
                                  "container": true,
                                  "endpoint": true,
                                  "exported_namespace": false,
                                  "instance": true,
                                  "job": true,
                                  "kubernetes_namespace": true,
                                  "kubernetes_pod_name": true,
                                  "namespace": true,
                                  "pod": true,
                                  "pod_template_hash": true,
                                  "status": true,
                                  "type": true
                              },
                              "indexByName": {},
                              "renameByName": {
                                  "Value": "Status",
                                  "exported_namespace": "Namespace",
                                  "kind": "Kind",
                                  "name": "Name",
                                  "namespace": "Operator Namespace"
                              }
                          }
                      }
                  ],
                  "type": "table"
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 21
                  },
                  "id": 17,
                  "panels": [],
                  "title": "Timing",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 22
                  },
                  "hiddenSeries": false,
                  "id": 27,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": false,
                      "hideEmpty": true,
                      "hideZero": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.5.5",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind, name)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind, name)",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{kind}}/{{name}}",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster reconciliation duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 30
                  },
                  "hiddenSeries": false,
                  "id": 35,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": false,
                      "hideEmpty": true,
                      "hideZero": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.5.5",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind, name)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind, name)",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{kind}}/{{name}}",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Source acquisition duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              }
          ],
          "refresh": "30s",
          "schemaVersion": 36,
          "style": "light",
          "tags": [
              "flux",
              "fluxcd",
              "fluxcd-mixin",
              "gitops",
              "portefaix"
          ],
          "templating": {
              "list": [
                  {
                      "allValue": "",
                      "current": {
                          "selected": true,
                          "text": [
                              "All"
                          ],
                          "value": [
                              "$__all"
                          ]
                      },
                      "datasource": "$DS_PROMETHEUS",
                      "definition": "label_values(gotk_reconcile_condition, namespace)",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": true,
                      "label": null,
                      "multi": true,
                      "name": "operator_namespace",
                      "options": [],
                      "query": {
                          "query": "label_values(gotk_reconcile_condition, namespace)",
                          "refId": "StandardVariableQuery"
                      },
                      "refresh": 2,
                      "regex": "",
                      "skipUrlSync": false,
                      "sort": 5,
                      "tagValuesQuery": "",
                      "tags": [],
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  },
                  {
                      "allValue": null,
                      "current": {
                          "selected": true,
                          "tags": [],
                          "text": [
                              "All"
                          ],
                          "value": [
                              "$__all"
                          ]
                      },
                      "datasource": "$DS_PROMETHEUS",
                      "definition": "label_values(gotk_reconcile_condition, exported_namespace)",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": true,
                      "label": null,
                      "multi": true,
                      "name": "namespace",
                      "options": [],
                      "query": {
                          "query": "label_values(gotk_reconcile_condition, exported_namespace)",
                          "refId": "StandardVariableQuery"
                      },
                      "refresh": 2,
                      "regex": "",
                      "skipUrlSync": false,
                      "sort": 0,
                      "tagValuesQuery": "",
                      "tags": [],
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  },
                  {
                      "current": {
                          "selected": false,
                          "text": "Prometheus",
                          "value": "Prometheus"
                      },
                      "hide": 0,
                      "includeAll": false,
                      "label": "Datasource",
                      "multi": false,
                      "name": "DS_PROMETHEUS",
                      "options": [],
                      "query": "prometheus",
                      "refresh": 1,
                      "regex": "",
                      "skipUrlSync": false,
                      "type": "datasource"
                  }
              ]
          },
          "time": {
              "from": "now-15m",
              "to": "now"
          },
          "timepicker": {
              "refresh_intervals": [
                  "10s",
                  "30s",
                  "1m",
                  "5m",
                  "15m",
                  "30m",
                  "1h",
                  "2h",
                  "1d"
              ]
          },
          "title": "Flux Cluster Stats",
          "uid": "flux-cluster",
          "version": 3
      }
- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: dashboard-fluxcd-mixin-control-plane
    namespace: default
    annotations:
      grafana-folder: monitoring      
      a8r.io/description: Monitoring Mixin for FluxCD
      a8r.io/owner: portefaix
      a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
      a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
      a8r.io/repository: https://github.com/portefaix/portefaix-hub
      a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
    labels:
      grafana-dashboard: control-plane      
      helm.sh/chart: fluxcd-mixin-1.2.0
      app.kubernetes.io/name: fluxcd-mixin
      app.kubernetes.io/instance: release-name
      app.kubernetes.io/version: "master"
      app.kubernetes.io/component: monitoring-mixin
      app.kubernetes.io/part-of: fluxcd-mixin
      app.kubernetes.io/managed-by: Helm
  data:
    control-plane.json: |-
      {
          "annotations": {
              "list": [
                  {
                      "builtIn": 1,
                      "datasource": "-- Grafana --",
                      "enable": true,
                      "hide": true,
                      "iconColor": "rgba(0, 211, 255, 1)",
                      "name": "Annotations & Alerts",
                      "target": {
                          "limit": 100,
                          "matchAny": false,
                          "tags": [],
                          "type": "dashboard"
                      },
                      "type": "dashboard"
                  },
                  {
                      "datasource": {
                          "type": "datasource",
                          "uid": "grafana"
                      },
                      "enable": true,
                      "iconColor": "red",
                      "name": "flux events",
                      "target": {
                          "limit": 100,
                          "matchAny": false,
                          "tags": [
                              "flux"
                          ],
                          "type": "tags"
                      }
                  }
              ]
          },
          "editable": true,
          "fiscalYearStartMonth": 0,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 29,
          "iteration": 1639041352219,
          "links": [],
          "liveNow": false,
          "panels": [
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 0,
                      "y": 0
                  },
                  "id": 24,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(go_info{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "interval": "",
                          "legendFormat": "pods",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Controllers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 50
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 6,
                      "y": 0
                  },
                  "id": 23,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "lastNotNull"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "auto"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "max(workqueue_longest_running_processor_seconds{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "seconds",
                          "refId": "B"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Max Work Queue",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 500000000
                                  },
                                  {
                                      "color": "red",
                                      "value": 900000000
                                  }
                              ]
                          },
                          "unit": "decbits"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 12,
                      "y": 0
                  },
                  "id": 25,
                  "options": {
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "lastNotNull"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showThresholdLabels": false,
                      "showThresholdMarkers": true,
                      "text": {}
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(go_memstats_alloc_bytes{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Memory",
                  "type": "gauge"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 50
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          }
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 18,
                      "y": 0
                  },
                  "id": 26,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "auto"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m]))",
                          "interval": "",
                          "legendFormat": "requests",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "API Requests",
                  "type": "stat"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": null,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 5
                  },
                  "hiddenSeries": false,
                  "id": 21,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\"}[1m]))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "total",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\",code!~\"2..\"}[1m]))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "errors",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Kubernetes API Requests",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:912",
                          "decimals": null,
                          "format": "short",
                          "label": "",
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:913",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 13
                  },
                  "id": 15,
                  "panels": [],
                  "title": "Resource Usage",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 0,
                      "y": 14
                  },
                  "hiddenSeries": false,
                  "id": 11,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": true,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "rate(process_cpu_seconds_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m])",
                          "interval": "",
                          "legendFormat": "{{pod}}",
                          "refId": "A"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "CPU Usage",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:93",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:94",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 12,
                      "y": 14
                  },
                  "hiddenSeries": false,
                  "id": 13,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": true,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "rate(go_memstats_alloc_bytes_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m])",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{pod}}",
                          "refId": "A"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Memory Usage",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:93",
                          "decimals": 0,
                          "format": "bytes",
                          "label": "",
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:94",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 25
                  },
                  "id": 17,
                  "panels": [],
                  "title": "Reconciliation Stats",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 26
                  },
                  "hiddenSeries": false,
                  "id": 27,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "workqueue_longest_running_processor_seconds{name=\"kustomization\"}",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "kustomizations",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster Reconciliation Duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:912",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:913",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 0,
                      "y": 34
                  },
                  "hiddenSeries": false,
                  "id": 2,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"kustomization\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful reconciliations ",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"kustomization\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed reconciliations ",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster Reconciliations ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1171",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1172",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 12,
                      "y": 34
                  },
                  "hiddenSeries": false,
                  "id": 4,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"gitrepository\",result!=\"error\"}[1m]))",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful git pulls",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"gitrepository\",result=\"error\"}[1m]))",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed git pulls",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Git Sources ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:285",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:286",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 43
                  },
                  "id": 19,
                  "panels": [],
                  "title": "Helm Stats",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 44
                  },
                  "hiddenSeries": false,
                  "id": 9,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": false,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null as zero",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "histogram_quantile(0.50, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": true,
                          "interval": "",
                          "legendFormat": "P50",
                          "refId": "A"
                      },
                      {
                          "expr": "histogram_quantile(0.90, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": true,
                          "interval": "",
                          "legendFormat": "P90",
                          "refId": "B"
                      },
                      {
                          "expr": "histogram_quantile(0.99, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "P99",
                          "refId": "C"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Release Duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1612",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1613",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 0,
                      "y": 52
                  },
                  "hiddenSeries": false,
                  "id": 5,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmrelease\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful reconciliations ",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmrelease\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed reconciliations ",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Releases ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1102",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1103",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 12,
                      "y": 52
                  },
                  "hiddenSeries": false,
                  "id": 6,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmchart\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful chart pulls",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmchart\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed chart pulls",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Charts ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1892",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1893",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              }
          ],
          "refresh": "10s",
          "schemaVersion": 31,
          "style": "light",
          "tags": [
              "flux",
              "fluxcd",
              "fluxcd-mixin",
              "gitops",
              "portefaix"
          ],
          "templating": {
              "list": [
                  {
                      "current": {
                          "selected": false,
                          "text": "Prometheus",
                          "value": "Prometheus"
                      },
                      "description": null,
                      "error": null,
                      "hide": 2,
                      "includeAll": false,
                      "label": null,
                      "multi": false,
                      "name": "DS_PROMETHEUS",
                      "options": [],
                      "query": "prometheus",
                      "refresh": 1,
                      "regex": "",
                      "skipUrlSync": false,
                      "type": "datasource"
                  },
                  {
                      "allValue": null,
                      "current": {
                          "selected": false,
                          "text": "flux-system",
                          "value": "flux-system"
                      },
                      "datasource": "${DS_PROMETHEUS}",
                      "definition": "workqueue_work_duration_seconds_count",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": false,
                      "label": null,
                      "multi": false,
                      "name": "namespace",
                      "options": [],
                      "query": {
                          "query": "workqueue_work_duration_seconds_count",
                          "refId": "Prometheus-namespace-Variable-Query"
                      },
                      "refresh": 2,
                      "regex": "/.*namespace=\"([^\"]*).*/",
                      "skipUrlSync": false,
                      "sort": 0,
                      "tagValuesQuery": "",
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  }
              ]
          },
          "time": {
              "from": "now-15m",
              "to": "now"
          },
          "timepicker": {
              "refresh_intervals": [
                  "10s",
                  "30s",
                  "1m",
                  "5m",
                  "15m",
                  "30m",
                  "1h",
                  "2h",
                  "1d"
              ]
          },
          "timezone": "",
          "title": "Flux Control Plane",
          "uid": "flux-control-plane",
          "version": 2
      }
- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: dashboard-fluxcd-mixin-fluxcd-cluster
    namespace: default
    annotations:
      grafana-folder: monitoring      
      a8r.io/description: Monitoring Mixin for FluxCD
      a8r.io/owner: portefaix
      a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
      a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
      a8r.io/repository: https://github.com/portefaix/portefaix-hub
      a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
    labels:
      grafana-dashboard: fluxcd-cluster      
      helm.sh/chart: fluxcd-mixin-1.2.0
      app.kubernetes.io/name: fluxcd-mixin
      app.kubernetes.io/instance: release-name
      app.kubernetes.io/version: "master"
      app.kubernetes.io/component: monitoring-mixin
      app.kubernetes.io/part-of: fluxcd-mixin
      app.kubernetes.io/managed-by: Helm
  data:
    fluxcd-cluster.json: |-
      {
          "annotations": {
              "list": [
                  {
                      "builtIn": 1,
                      "datasource": "-- Grafana --",
                      "enable": true,
                      "hide": true,
                      "iconColor": "rgba(0, 211, 255, 1)",
                      "name": "Annotations & Alerts",
                      "type": "dashboard"
                  }
              ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "iteration": 1636369574387,
          "links": [],
          "panels": [
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 0,
                      "y": 0
                  },
                  "id": 24,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "count(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"True\",kind=~\"Kustomization|HelmRelease\"})\n-\nsum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"Deleted\",kind=~\"Kustomization|HelmRelease\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Cluster Reconcilers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "red",
                                      "value": null
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 6,
                      "y": 0
                  },
                  "id": 28,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "sum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"Kustomization|HelmRelease\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Failing Reconcilers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 12,
                      "y": 0
                  },
                  "id": 29,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "count(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"True\",kind=~\"GitRepository|HelmRepository|Bucket\"})\n-\nsum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"Deleted\",kind=~\"GitRepository|HelmRepository|Bucket\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Kubernetes Manifests Sources",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "red",
                                      "value": null
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 18,
                      "y": 0
                  },
                  "id": 30,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "sum(gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"GitRepository|HelmRepository|Bucket\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Failing Sources",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "green",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 1
                                  },
                                  {
                                      "color": "red",
                                      "value": 61
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 4,
                      "w": 12,
                      "x": 0,
                      "y": 5
                  },
                  "id": 8,
                  "options": {
                      "displayMode": "gradient",
                      "orientation": "horizontal",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showUnfilled": true,
                      "text": {}
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind)",
                          "interval": "",
                          "legendFormat": "{{kind}}",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Reconciler ops avg. duration",
                  "type": "bargauge"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "green",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 1
                                  },
                                  {
                                      "color": "red",
                                      "value": 61
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 4,
                      "w": 12,
                      "x": 12,
                      "y": 5
                  },
                  "id": 31,
                  "options": {
                      "displayMode": "gradient",
                      "orientation": "horizontal",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showUnfilled": true,
                      "text": {}
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind)",
                          "interval": "",
                          "legendFormat": "{{kind}}",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Source ops avg. duration",
                  "type": "bargauge"
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 9
                  },
                  "id": 15,
                  "panels": [],
                  "title": "Status",
                  "type": "row"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "custom": {
                              "align": null,
                              "filterable": true
                          },
                          "mappings": [
                              {
                                  "from": "",
                                  "id": 1,
                                  "text": "Ready",
                                  "to": "",
                                  "type": 1,
                                  "value": "0"
                              },
                              {
                                  "from": "",
                                  "id": 2,
                                  "text": "Not Ready",
                                  "to": "",
                                  "type": 1,
                                  "value": "1"
                              }
                          ],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "blue",
                                      "value": 0
                                  },
                                  {
                                      "color": "red",
                                      "value": 1
                                  }
                              ]
                          }
                      },
                      "overrides": [
                          {
                              "matcher": {
                                  "id": "byName",
                                  "options": "Status"
                              },
                              "properties": [
                                  {
                                      "id": "custom.displayMode",
                                      "value": "color-background"
                                  }
                              ]
                          }
                      ]
                  },
                  "gridPos": {
                      "h": 8,
                      "w": 12,
                      "x": 0,
                      "y": 10
                  },
                  "id": 33,
                  "options": {
                      "showHeader": true
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"Kustomization|HelmRelease\"}",
                          "format": "table",
                          "instant": true,
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Cluster reconciliation readiness ",
                  "transformations": [
                      {
                          "id": "organize",
                          "options": {
                              "excludeByName": {
                                  "Time": true,
                                  "__name__": true,
                                  "app": true,
                                  "container": true,
                                  "endpoint": true,
                                  "exported_namespace": true,
                                  "instance": true,
                                  "job": true,
                                  "kubernetes_namespace": true,
                                  "kubernetes_pod_name": true,
                                  "pod": true,
                                  "pod_template_hash": true,
                                  "status": true,
                                  "type": true
                              },
                              "indexByName": {},
                              "renameByName": {
                                  "Value": "Status",
                                  "kind": "Kind",
                                  "name": "Name",
                                  "namespace": "Namespace"
                              }
                          }
                      }
                  ],
                  "type": "table"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "custom": {
                              "align": null,
                              "filterable": true
                          },
                          "mappings": [
                              {
                                  "from": "",
                                  "id": 1,
                                  "text": "Ready",
                                  "to": "",
                                  "type": 1,
                                  "value": "0"
                              },
                              {
                                  "from": "",
                                  "id": 2,
                                  "text": "Not Ready",
                                  "to": "",
                                  "type": 1,
                                  "value": "1"
                              }
                          ],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "blue",
                                      "value": 0
                                  },
                                  {
                                      "color": "red",
                                      "value": 1
                                  }
                              ]
                          }
                      },
                      "overrides": [
                          {
                              "matcher": {
                                  "id": "byName",
                                  "options": "Status"
                              },
                              "properties": [
                                  {
                                      "id": "custom.displayMode",
                                      "value": "color-background"
                                  }
                              ]
                          }
                      ]
                  },
                  "gridPos": {
                      "h": 8,
                      "w": 12,
                      "x": 12,
                      "y": 10
                  },
                  "id": 34,
                  "options": {
                      "showHeader": true
                  },
                  "pluginVersion": "7.5.5",
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "gotk_reconcile_condition{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",type=\"Ready\",status=\"False\",kind=~\"GitRepository|HelmRepository|Bucket\"}",
                          "format": "table",
                          "instant": true,
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Source acquisition readiness ",
                  "transformations": [
                      {
                          "id": "organize",
                          "options": {
                              "excludeByName": {
                                  "Time": true,
                                  "__name__": true,
                                  "app": true,
                                  "container": true,
                                  "endpoint": true,
                                  "exported_namespace": true,
                                  "instance": true,
                                  "job": true,
                                  "kubernetes_namespace": true,
                                  "kubernetes_pod_name": true,
                                  "pod": true,
                                  "pod_template_hash": true,
                                  "status": true,
                                  "type": true
                              },
                              "indexByName": {},
                              "renameByName": {
                                  "Value": "Status",
                                  "kind": "Kind",
                                  "name": "Name",
                                  "namespace": "Namespace"
                              }
                          }
                      }
                  ],
                  "type": "table"
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 18
                  },
                  "id": 17,
                  "panels": [],
                  "title": "Timing",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 19
                  },
                  "hiddenSeries": false,
                  "id": 27,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": false,
                      "hideEmpty": true,
                      "hideZero": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.5.5",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind, name)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"Kustomization|HelmRelease\"}[5m])) by (kind, name)",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{kind}}/{{name}}",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster reconciliation duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 27
                  },
                  "hiddenSeries": false,
                  "id": 35,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": false,
                      "hideEmpty": true,
                      "hideZero": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "7.5.5",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "exemplar": true,
                          "expr": "  sum(rate(gotk_reconcile_duration_seconds_sum{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind, name)\n/\n  sum(rate(gotk_reconcile_duration_seconds_count{namespace=~\"$operator_namespace\",exported_namespace=~\"$namespace\",kind=~\"GitRepository|HelmRepository|Bucket\"}[5m])) by (kind, name)",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{kind}}/{{name}}",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Source acquisition duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              }
          ],
          "refresh": "",
          "schemaVersion": 27,
          "style": "light",
          "tags": [
              "flux",
              "fluxcd",
              "fluxcd-mixin",
              "gitops",
              "portefaix"
          ],
          "templating": {
              "list": [
                  {
                      "current": {
                          "selected": false,
                          "text": "Prometheus",
                          "value": "Prometheus"
                      },
                      "description": null,
                      "error": null,
                      "hide": 2,
                      "includeAll": false,
                      "label": null,
                      "multi": false,
                      "name": "DS_PROMETHEUS",
                      "options": [],
                      "query": "prometheus",
                      "refresh": 1,
                      "regex": "",
                      "skipUrlSync": false,
                      "type": "datasource"
                  },
                  {
                      "allValue": "",
                      "current": {
                          "selected": true,
                          "text": [
                              "All"
                          ],
                          "value": [
                              "$__all"
                          ]
                      },
                      "datasource": "$DS_PROMETHEUS",
                      "definition": "label_values(gotk_reconcile_condition, namespace)",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": true,
                      "label": null,
                      "multi": true,
                      "name": "operator_namespace",
                      "options": [],
                      "query": {
                          "query": "label_values(gotk_reconcile_condition, namespace)",
                          "refId": "StandardVariableQuery"
                      },
                      "refresh": 2,
                      "regex": "",
                      "skipUrlSync": false,
                      "sort": 5,
                      "tagValuesQuery": "",
                      "tags": [],
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  },
                  {
                      "allValue": null,
                      "current": {
                          "selected": true,
                          "tags": [],
                          "text": [
                              "All"
                          ],
                          "value": [
                              "$__all"
                          ]
                      },
                      "datasource": null,
                      "definition": "label_values(gotk_reconcile_condition, exported_namespace)",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": true,
                      "label": null,
                      "multi": true,
                      "name": "namespace",
                      "options": [],
                      "query": {
                          "query": "label_values(gotk_reconcile_condition, exported_namespace)",
                          "refId": "StandardVariableQuery"
                      },
                      "refresh": 2,
                      "regex": "",
                      "skipUrlSync": false,
                      "sort": 0,
                      "tagValuesQuery": "",
                      "tags": [],
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  }
              ]
          },
          "time": {
              "from": "now-15m",
              "to": "now"
          },
          "timepicker": {
              "refresh_intervals": [
                  "10s",
                  "30s",
                  "1m",
                  "5m",
                  "15m",
                  "30m",
                  "1h",
                  "2h",
                  "1d"
              ]
          },
          "timezone": "",
          "title": "Flux Cluster Stats",
          "uid": "flux-cluster",
          "version": 1
      }
- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: dashboard-fluxcd-mixin-fluxcd-control-plane
    namespace: default
    annotations:
      grafana-folder: monitoring      
      a8r.io/description: Monitoring Mixin for FluxCD
      a8r.io/owner: portefaix
      a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
      a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
      a8r.io/repository: https://github.com/portefaix/portefaix-hub
      a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
    labels:
      grafana-dashboard: fluxcd-control-plane      
      helm.sh/chart: fluxcd-mixin-1.2.0
      app.kubernetes.io/name: fluxcd-mixin
      app.kubernetes.io/instance: release-name
      app.kubernetes.io/version: "master"
      app.kubernetes.io/component: monitoring-mixin
      app.kubernetes.io/part-of: fluxcd-mixin
      app.kubernetes.io/managed-by: Helm
  data:
    fluxcd-control-plane.json: |-
      {
          "annotations": {
              "list": [
                  {
                      "builtIn": 1,
                      "datasource": "-- Grafana --",
                      "enable": true,
                      "hide": true,
                      "iconColor": "rgba(0, 211, 255, 1)",
                      "name": "Annotations & Alerts",
                      "target": {
                          "limit": 100,
                          "matchAny": false,
                          "tags": [],
                          "type": "dashboard"
                      },
                      "type": "dashboard"
                  }
              ]
          },
          "editable": true,
          "fiscalYearStartMonth": 0,
          "gnetId": null,
          "graphTooltip": 0,
          "id": 29,
          "iteration": 1639041352219,
          "links": [],
          "liveNow": false,
          "panels": [
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "decimals": 0,
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "short"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 0,
                      "y": 0
                  },
                  "id": 24,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "none",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "last"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "value"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(go_info{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "interval": "",
                          "legendFormat": "pods",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Controllers",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 50
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          },
                          "unit": "s"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 6,
                      "y": 0
                  },
                  "id": 23,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "lastNotNull"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "auto"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "max(workqueue_longest_running_processor_seconds{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "seconds",
                          "refId": "B"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Max Work Queue",
                  "type": "stat"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 500000000
                                  },
                                  {
                                      "color": "red",
                                      "value": 900000000
                                  }
                              ]
                          },
                          "unit": "decbits"
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 12,
                      "y": 0
                  },
                  "id": 25,
                  "options": {
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "lastNotNull"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "showThresholdLabels": false,
                      "showThresholdMarkers": true,
                      "text": {}
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(go_memstats_alloc_bytes{namespace=\"$namespace\",pod=~\".*-controller-.*\"})",
                          "interval": "",
                          "legendFormat": "",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "Memory",
                  "type": "gauge"
              },
              {
                  "datasource": "${DS_PROMETHEUS}",
                  "description": "",
                  "fieldConfig": {
                      "defaults": {
                          "mappings": [],
                          "thresholds": {
                              "mode": "absolute",
                              "steps": [
                                  {
                                      "color": "blue",
                                      "value": null
                                  },
                                  {
                                      "color": "#EAB839",
                                      "value": 50
                                  },
                                  {
                                      "color": "red",
                                      "value": 100
                                  }
                              ]
                          }
                      },
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 5,
                      "w": 6,
                      "x": 18,
                      "y": 0
                  },
                  "id": 26,
                  "options": {
                      "colorMode": "value",
                      "graphMode": "area",
                      "justifyMode": "auto",
                      "orientation": "auto",
                      "reduceOptions": {
                          "calcs": [
                              "mean"
                          ],
                          "fields": "",
                          "values": false
                      },
                      "text": {},
                      "textMode": "auto"
                  },
                  "pluginVersion": "8.2.3",
                  "targets": [
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m]))",
                          "interval": "",
                          "legendFormat": "requests",
                          "refId": "A"
                      }
                  ],
                  "timeFrom": null,
                  "timeShift": null,
                  "title": "API Requests",
                  "type": "stat"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": null,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 5
                  },
                  "hiddenSeries": false,
                  "id": 21,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\"}[1m]))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "total",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(rate(rest_client_requests_total{namespace=\"$namespace\",code!~\"2..\"}[1m]))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "errors",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Kubernetes API Requests",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:912",
                          "decimals": null,
                          "format": "short",
                          "label": "",
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:913",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 13
                  },
                  "id": 15,
                  "panels": [],
                  "title": "Resource Usage",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 0,
                      "y": 14
                  },
                  "hiddenSeries": false,
                  "id": 11,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": true,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "rate(process_cpu_seconds_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m])",
                          "interval": "",
                          "legendFormat": "{{pod}}",
                          "refId": "A"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "CPU Usage",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:93",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:94",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 11,
                      "w": 12,
                      "x": 12,
                      "y": 14
                  },
                  "hiddenSeries": false,
                  "id": 13,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": true,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "rate(go_memstats_alloc_bytes_total{namespace=\"$namespace\",pod=~\".*-controller-.*\"}[1m])",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "{{pod}}",
                          "refId": "A"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Memory Usage",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:93",
                          "decimals": 0,
                          "format": "bytes",
                          "label": "",
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:94",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 25
                  },
                  "id": 17,
                  "panels": [],
                  "title": "Reconciliation Stats",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 26
                  },
                  "hiddenSeries": false,
                  "id": 27,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "options": {
                      "alertThreshold": true
                  },
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "workqueue_longest_running_processor_seconds{name=\"kustomization\"}",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "kustomizations",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster Reconciliation Duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:912",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:913",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 0,
                      "y": 34
                  },
                  "hiddenSeries": false,
                  "id": 2,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"kustomization\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful reconciliations ",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"kustomization\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed reconciliations ",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Cluster Reconciliations ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1171",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1172",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 12,
                      "y": 34
                  },
                  "hiddenSeries": false,
                  "id": 4,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"gitrepository\",result!=\"error\"}[1m]))",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful git pulls",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"gitrepository\",result=\"error\"}[1m]))",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed git pulls",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Git Sources ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:285",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:286",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "collapsed": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fieldConfig": {
                      "defaults": {},
                      "overrides": []
                  },
                  "gridPos": {
                      "h": 1,
                      "w": 24,
                      "x": 0,
                      "y": 43
                  },
                  "id": 19,
                  "panels": [],
                  "title": "Helm Stats",
                  "type": "row"
              },
              {
                  "aliasColors": {},
                  "bars": false,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 8,
                      "w": 24,
                      "x": 0,
                      "y": 44
                  },
                  "hiddenSeries": false,
                  "id": 9,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": true,
                      "show": false,
                      "total": false,
                      "values": true
                  },
                  "lines": true,
                  "linewidth": 1,
                  "nullPointMode": "null as zero",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": false,
                  "targets": [
                      {
                          "expr": "histogram_quantile(0.50, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": true,
                          "interval": "",
                          "legendFormat": "P50",
                          "refId": "A"
                      },
                      {
                          "expr": "histogram_quantile(0.90, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": true,
                          "interval": "",
                          "legendFormat": "P90",
                          "refId": "B"
                      },
                      {
                          "expr": "histogram_quantile(0.99, sum(rate(controller_runtime_reconcile_time_seconds_bucket{controller=\"helmrelease\"}[5m])) by (le))",
                          "hide": false,
                          "interval": "",
                          "legendFormat": "P99",
                          "refId": "C"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Release Duration",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1612",
                          "format": "s",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1613",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 0,
                      "y": 52
                  },
                  "hiddenSeries": false,
                  "id": 5,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmrelease\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful reconciliations ",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmrelease\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed reconciliations ",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Releases ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1102",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1103",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              },
              {
                  "aliasColors": {},
                  "bars": true,
                  "dashLength": 10,
                  "dashes": false,
                  "datasource": "${DS_PROMETHEUS}",
                  "decimals": 2,
                  "description": "",
                  "fill": 1,
                  "fillGradient": 0,
                  "gridPos": {
                      "h": 9,
                      "w": 12,
                      "x": 12,
                      "y": 52
                  },
                  "hiddenSeries": false,
                  "id": 6,
                  "legend": {
                      "alignAsTable": true,
                      "avg": true,
                      "current": true,
                      "max": false,
                      "min": false,
                      "rightSide": false,
                      "show": true,
                      "total": false,
                      "values": true
                  },
                  "lines": false,
                  "linewidth": 1,
                  "nullPointMode": "null",
                  "percentage": false,
                  "pluginVersion": "8.2.3",
                  "pointradius": 2,
                  "points": false,
                  "renderer": "flot",
                  "seriesOverrides": [],
                  "spaceLength": 10,
                  "stack": false,
                  "steppedLine": true,
                  "targets": [
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmchart\",result!=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "successful chart pulls",
                          "refId": "A"
                      },
                      {
                          "expr": "sum(increase(controller_runtime_reconcile_total{controller=\"helmchart\",result=\"error\"}[1m])) by (controller)",
                          "format": "time_series",
                          "interval": "",
                          "legendFormat": "failed chart pulls",
                          "refId": "B"
                      }
                  ],
                  "thresholds": [],
                  "timeFrom": null,
                  "timeRegions": [],
                  "timeShift": null,
                  "title": "Helm Charts ops/min",
                  "tooltip": {
                      "shared": true,
                      "sort": 0,
                      "value_type": "individual"
                  },
                  "type": "graph",
                  "xaxis": {
                      "buckets": null,
                      "mode": "time",
                      "name": null,
                      "show": true,
                      "values": []
                  },
                  "yaxes": [
                      {
                          "$$hashKey": "object:1892",
                          "format": "opm",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      },
                      {
                          "$$hashKey": "object:1893",
                          "format": "short",
                          "label": null,
                          "logBase": 1,
                          "max": null,
                          "min": null,
                          "show": true
                      }
                  ],
                  "yaxis": {
                      "align": false,
                      "alignLevel": null
                  }
              }
          ],
          "refresh": "10s",
          "schemaVersion": 31,
          "style": "light",
          "tags": [
              "flux",
              "fluxcd",
              "fluxcd-mixin",
              "gitops",
              "portefaix"
          ],
          "templating": {
              "list": [
                  {
                      "current": {
                          "selected": false,
                          "text": "Prometheus",
                          "value": "Prometheus"
                      },
                      "description": null,
                      "error": null,
                      "hide": 2,
                      "includeAll": false,
                      "label": null,
                      "multi": false,
                      "name": "DS_PROMETHEUS",
                      "options": [],
                      "query": "prometheus",
                      "refresh": 1,
                      "regex": "",
                      "skipUrlSync": false,
                      "type": "datasource"
                  },
                  {
                      "allValue": null,
                      "current": {
                          "selected": false,
                          "text": "flux-system",
                          "value": "flux-system"
                      },
                      "datasource": "${DS_PROMETHEUS}",
                      "definition": "workqueue_work_duration_seconds_count",
                      "description": null,
                      "error": null,
                      "hide": 0,
                      "includeAll": false,
                      "label": null,
                      "multi": false,
                      "name": "namespace",
                      "options": [],
                      "query": {
                          "query": "workqueue_work_duration_seconds_count",
                          "refId": "Prometheus-namespace-Variable-Query"
                      },
                      "refresh": 2,
                      "regex": "/.*namespace=\"([^\"]*).*/",
                      "skipUrlSync": false,
                      "sort": 0,
                      "tagValuesQuery": "",
                      "tagsQuery": "",
                      "type": "query",
                      "useTags": false
                  }
              ]
          },
          "time": {
              "from": "now-15m",
              "to": "now"
          },
          "timepicker": {
              "refresh_intervals": [
                  "10s",
                  "30s",
                  "1m",
                  "5m",
                  "15m",
                  "30m",
                  "1h",
                  "2h",
                  "1d"
              ]
          },
          "timezone": "",
          "title": "Flux Control Plane",
          "uid": "flux-control-plane",
          "version": 2
      }
---
# Source: fluxcd-mixin/templates/alerts.yaml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: release-name-fluxcd-mixin-alerts
  namespace: default
  annotations:    
    a8r.io/description: Monitoring Mixin for FluxCD
    a8r.io/owner: portefaix
    a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
    a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
    a8r.io/repository: https://github.com/portefaix/portefaix-hub
    a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
  labels:    
    helm.sh/chart: fluxcd-mixin-1.2.0
    app.kubernetes.io/name: fluxcd-mixin
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "master"
    app.kubernetes.io/component: monitoring-mixin
    app.kubernetes.io/part-of: fluxcd-mixin
    app.kubernetes.io/managed-by: Helm
spec:
  groups:
      - name: fluxcd
        rules:
          - alert: ReconciliationFailure
            annotations:
              message: '{{ $labels.kind }} {{ $labels.namespace }}/{{ $labels.name }} reconciliation has been failing.'
              runbook_url: https://github.com/nlamirault/monitoring-mixin/tree/master/runbook.md#alert-name-reconciliationfailure
              summary: Reconciliation failure.
            expr: max(gotk_reconcile_condition{status="False",type="Ready"}) by (namespace, name, kind) + on(namespace, name, kind) (max(gotk_reconcile_condition{status="Deleted"}) by (namespace, name, kind)) * 2 == 1
            for: 10m
            labels:
              severity: warning
---
# Source: fluxcd-mixin/templates/rules.yaml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: release-name-fluxcd-mixin-rules
  namespace: default
  annotations:
    
    a8r.io/description: Monitoring Mixin for FluxCD
    a8r.io/owner: portefaix
    a8r.io/bugs: https://github.com/portefaix/portefaix-hub/issues
    a8r.io/documentation: https://artifacthub.io/packages/helm/portefaix-hub/fluxcd-mixin
    a8r.io/repository: https://github.com/portefaix/portefaix-hub
    a8r.io/support: https://github.com/portefaix/portefaix-hub/issues
  labels:
    
    helm.sh/chart: fluxcd-mixin-1.2.0
    app.kubernetes.io/name: fluxcd-mixin
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "master"
    app.kubernetes.io/component: monitoring-mixin
    app.kubernetes.io/part-of: fluxcd-mixin
    app.kubernetes.io/managed-by: Helm
spec:
  groups: []
