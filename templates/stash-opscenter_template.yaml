---
# Source: stash-opscenter/charts/stash-ui-server/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: release-name-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
apiVersion: v1
kind: Secret
metadata:
  name: release-name-stash-ui-server-apiserver-cert
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURlekNDQW1PZ0F3SUJBZ0lRZkM5bGtSTUFvbm9OR01qQUhDRnRzekFOQmdrcWhraUc5dzBCQVFzRkFEQU4KTVFzd0NRWURWUVFERXdKallUQWVGdzB5TkRBMU1UUXlNek0wTkRSYUZ3MHpOREExTVRJeU16TTBORFJhTUNjeApKVEFqQmdOVkJBTVRISEpsYkdWaGMyVXRibUZ0WlMxemRHRnphQzExYVMxelpYSjJaWEl3Z2dFaU1BMEdDU3FHClNJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUM5TlFxbys0RWVuSHBlaW56clNaWjZKUnpqSE9rUnlSL0MKKzJ6OUJaamFWdUd3QndCRGxOcXlGMXRreHBCamVGTnVyTmpwc24vZVFmVEFmdzlteEhhS25WUEpBQ2l3YVRWRwp2c2hjQy9OZE9udml0N3dLa1dCNTI3dDdGTmJjcmJJNmpKK2MxRHV4bzlUaWhuaEpZd0NHdE1vR1J1ZmhDRzVpCjNTTDlYVzBFZllSd2xUNThnYVBlUFM4NGZCNmZlQ2ZKT29aSjFLbmM2cFBsUUFMRDF6ZEZQQ2RFTkdDaTB3MjAKamtJWmpSRk5TUHhFaEwyNkwyenZlbVJGcGtYZHUybndUc0M4U1N1emhzVU9EbVJUZmxrdlM5OUxUZFNJbGdxWApTTnRFWVNCeU8wYStWVWV4UkZQZUVSd0JyOWk0eHM5S2JQbzcwUDNDbFM4b3pOZC9TOHpkQWdNQkFBR2pnYnd3Cmdia3dEZ1lEVlIwUEFRSC9CQVFEQWdXZ01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0QKQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkdXYk9lcFNOVWhqdU1YTk03Y0hHZVFNVXV3eQpNRmtHQTFVZEVRUlNNRkNDSkhKbGJHVmhjMlV0Ym1GdFpTMXpkR0Z6YUMxMWFTMXpaWEoyWlhJdVpHVm1ZWFZzCmRJSW9jbVZzWldGelpTMXVZVzFsTFhOMFlYTm9MWFZwTFhObGNuWmxjaTVrWldaaGRXeDBMbk4yWXpBTkJna3EKaGtpRzl3MEJBUXNGQUFPQ0FRRUFCQWFJd0Y5SXIzZ2VrRnZKRFNqY3ozUkVzS2NoRHBHZThvemQySUo2cENNdwpsVVRFTzNQZ3JUZ05nTEdCSmZNRmxySVlXV1U3amV1cFFuNklXaWh6ODBYQ0RVZXpKU1ZCdk1NMUsyaWFqVm1DCmx5Vkk3S2ZCRXhLbCtwb1RaQW5pczFEdjJmeXhjcE1YcWVqUU1xV1BVUm95OFpGeHBNRVQyYkprbmtOaWVqdVAKM0xlOENZUHdUdDNiY1gycFlsSjMvdWNXemJteXNyVHBvRVliRnJwa3BObU1rL0gzOEZWUUJ3Wk5qSFhJcXUrRApxaEFQaC9OeEFCTmlWTmZDQlZjTDZKNmxERUtzTDVGRThqV1pGNEk2ZCtQY3FoRk5sbmxpK1FzSzZwajlBRnIzCjRGcnlyRFFkZXlQczh1TWh6RzVmVlVwb1JXemdYZjhRS3VyWitvRW5sdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdlRVS3FQdUJIcHg2WG9wODYwbVdlaVVjNHh6cEVja2Z3dnRzL1FXWTJsYmhzQWNBClE1VGFzaGRiWk1hUVkzaFRicXpZNmJKLzNrSDB3SDhQWnNSMmlwMVR5UUFvc0drMVJyN0lYQXZ6WFRwNzRyZTgKQ3BGZ2VkdTdleFRXM0syeU9veWZuTlE3c2FQVTRvWjRTV01BaHJUS0JrYm40UWh1WXQwaS9WMXRCSDJFY0pVKwpmSUdqM2owdk9Id2VuM2dueVRxR1NkU3AzT3FUNVVBQ3c5YzNSVHduUkRSZ290TU50STVDR1kwUlRVajhSSVM5CnVpOXM3M3BrUmFaRjNidHA4RTdBdkVrcnM0YkZEZzVrVTM1WkwwdmZTMDNVaUpZS2wwamJSR0VnY2p0R3ZsVkgKc1VSVDNoRWNBYS9ZdU1iUFNtejZPOUQ5d3BVdktNelhmMHZNM1FJREFRQUJBb0lCQVFDZUpnYTZCamIvMmpWaQpib2xKdGFHa2lQN2pTdGY1ZU00bWtUZWhLaHVBYk55SjRPQTBuT2hMc2NBL3RNVWRqNGJWWEg2V29BL0hQQVFUCkhtRkdPZk1IbThkYm05bG0weG1uLzNIRGxtMmR3SE9xcG43enFsNGtuU2pSRVRNakU4Q0V0ZVA0RjJHcDh0SFAKWWl5SzBzaXV6OUNKZkp6MitMQWp6TWtoVkFUNm1XczhkUWkzc1IyNjVFbjYza2IvRnllZncxWUVOUTcyelRyUgo1TkhMeE5LSW03WEtJUDlqSGFEY1ZMNlh1bCtYdzBTanMxRm4zaGkzOTRHUVVpbmo2YTliT1I5MkR6dTVGNzR2CmhrOFF1RFdvOHAva2M2TTJaUDYyR2E1T2VnRUlnQWRBMHhOanBveCtPRTIySUorNGl1akhxUkVGNkZTSWFEL00KQ0QwUDZCRVZBb0dCQU9mckxJajdycVc1ZVluRmxZTHpEb0FhV214YnRCN2l0ZkdPa2Vaeko1NkYyUDc2RGRKOAp4NzJkQzdTQUlZSnRHTlJ4cnFycmZndHhYWXByMWxYMVgvOE94V3R3NVFVbE51SjF0YUNBaVpvU0VKYnhJaDFoCkJ2K3kxODQ0YUhuS0VBRDh3c2kzSUZnUFlpWWhWZ2tQVHRNemRqYjNaajNnSmxyVk9IK2V1WjV6QW9HQkFORGEKaExFcHVUcytHNHJ5RiswakhCa052QlhEZ3I5UFZYNTVsUW9vRk1sbmZGTjNuUnNSUnA5RFJ3bm9VZTJZRWUwMwpMOHZPQWh3WklEUTEyWmRiYmlwbUh2OXpDVlNMYUdHalhtbUgxeVlMSEp6QzdpQ1ZwYlAzMUZNUkFmZWNUR3EyCnBpOElKc2NRdCt5WkNmeWg4a1VqODZsQmNxR2lvMjV1eE1sWVNFTnZBb0dBSXg4OWRsMVBQSy9URlNkRUZqbkMKOTJtR1NpUzFLWHhCKzV3UXdtcXNGRmpHM1E1M2Eyb1VRY1gzME5VYXZnclJtTkxDbGdYbDU4dTZVODB5LzMrUwpreWprZ3ZuczVST1d0VU1JUjQ5UHgzSjI2clVINnBVWUh6OHhhWHluYmRKSkRDMDdQblJsUkpESDEyaHpCQm82CllNZkpYbGVuTnpXcitWT1RJOWlnMmJzQ2dZQitFcnF3MnpmbWpDcENLTHZLdVR2MzM3T2ZDNk04YXQ1MzkxckIKZzhwd2ZaaXVKZkZmYW9GUUdHT2tsbW9HVzVyT3NGYVkxMldzb25vdktpYU1XSFBiQWtSSi9aNHZPK3dwckYyTQpwS1I2WVpESERHQ0VxUEVhLzBwYlRsUDZyWTN2aVF3dUxlU0NuQlA2cmJNNm5tUEoydGIyWC95Ymw3ckNLZmwrCmRWMUIzd0tCZ1FDa3VjNUFCRkcvUEk2VUtGZGJ5TUI4eVQvMkJGalR2c3lNdVdEZUdUc3ZOcUgwdGttTGxnenMKT3Uxc28wYmxSNjR3clVLV0dIWDFzZ2pHMlh3dXBVYzdyWkNNbWZiSElkZkdqalVpTFRGbURIR2dZRjZXS0s1VQorS2lXSEo2Wm9Hd2FwMTZncFBCZjRsTmgzc3hOYStrQW5DclpJYWdHQ2szTUdMMXZidFNOOEE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
---
# Source: stash-opscenter/charts/stash-ui-server/templates/cluster-role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: release-name-stash-ui-server
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
rules:
- apiGroups:
  - ui.stash.appscode.com
  resources:
  - "*"
  verbs: ["*"]
- apiGroups:
  - stash.appscode.com
  - repositories.stash.appscode.com
  - kubedb.com
  - appcatalog.appscode.com
  resources:
  - "*"
  verbs: ["get", "list", "watch"]
- apiGroups:
  - ""
  resources:
  - nodes
  verbs: ["list"]
- apiGroups:
  - ""
  resources:
  - pods
  verbs: ["get", "list"]
- apiGroups:
  - ""
  resources:
  - events
  verbs: ["create"]
- apiGroups:
  - ""
  resources:
  - configmaps
  - secrets
  verbs: ["get", "list", "watch"]
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  - roles
  - rolebindings
  verbs: ["get", "list", "watch"]
- nonResourceURLs:
  - ""
  - "/apis/ui.stash.appscode.com/v1alpha1"
  verbs: ["get"]
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# to delegate authentication and authorization
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: release-name-stash-ui-server-apiserver-auth-delegator
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  kind: ClusterRole
  apiGroup: rbac.authorization.k8s.io
  name: system:auth-delegator
subjects:
- kind: ServiceAccount
  name: release-name-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/cluster-role-binding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: release-name-stash-ui-server
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: release-name-stash-ui-server
subjects:
- kind: ServiceAccount
  name: release-name-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# to read the config for terminating authentication
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: release-name-stash-ui-server-apiserver-extension-server-authentication-reader
  namespace: kube-system
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  kind: Role
  apiGroup: rbac.authorization.k8s.io
  name: extension-apiserver-authentication-reader
subjects:
- kind: ServiceAccount
  name: release-name-stash-ui-server
  namespace: default
---
# Source: stash-opscenter/charts/stash-ui-server/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: release-name-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
spec:
  ports:
  # Port used to expose admission webhook apiserver
  - name: api
    port: 443
    targetPort: 8443
  selector:
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
---
# Source: stash-opscenter/charts/stash-ui-server/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-name-stash-ui-server
  namespace: default
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: stash-ui-server
      app.kubernetes.io/instance: release-name
  template:
    metadata:
      labels:
        app.kubernetes.io/name: stash-ui-server
        app.kubernetes.io/instance: release-name
      annotations:
        checksum/apiregistration.yaml: 8d670da28132be534109e535ee03a4c815d5296715870e73ba85ac4133eaba37
    spec:
      
      serviceAccountName: release-name-stash-ui-server
      containers:
      - name: server
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          runAsUser: 65534
        image: ghcr.io/stashed/stash-ui-server:v0.15.0
        imagePullPolicy: Always
        args:
        - run
        - --v=3
        - --secure-port=8443
        - --audit-log-path=-
        - --tls-cert-file=/var/serving-cert/tls.crt
        - --tls-private-key-file=/var/serving-cert/tls.key
        - --use-kubeapiserver-fqdn-for-aks=true
        ports:
        - containerPort: 8443
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        resources:
          {}
        volumeMounts:
        - mountPath: /var/serving-cert
          name: serving-cert
      volumes:
      - name: serving-cert
        secret:
          defaultMode: 420
          secretName: release-name-stash-ui-server-apiserver-cert
      securityContext:
        fsGroup: 65535
---
# Source: stash-opscenter/charts/stash-ui-server/templates/apiregistration.yaml
# register as aggregated apiserver
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  name: v1alpha1.ui.stash.appscode.com
  labels:
    helm.sh/chart: stash-ui-server-v0.15.0
    app.kubernetes.io/name: stash-ui-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v0.15.0"
    app.kubernetes.io/managed-by: Helm
spec:
  group: ui.stash.appscode.com
  version: v1alpha1
  service:
    namespace: default
    name: release-name-stash-ui-server
  caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCakNDQWU2Z0F3SUJBZ0lSQU5PYklzeElvMXFGa0ppOElucTB5elF3RFFZSktvWklodmNOQVFFTEJRQXcKRFRFTE1Ba0dBMVVFQXhNQ1kyRXdIaGNOTWpRd05URTBNak16TkRRMFdoY05NelF3TlRFeU1qTXpORFEwV2pBTgpNUXN3Q1FZRFZRUURFd0pqWVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTHZPCnB3NnhnZXgzQysyNDhVYU9DYmd6RDRLVG84YjhUVGdOdTRTcE0yUXhuYXIza1dTYjUvZWEvUWtyREI3K2RDMkUKaldzaVdhMVpiQVI4QnZPajRRWkpuUHN3MHMrTHBVTDluSVA3RHRvVjR3WW55dVFQZTQ5aTBYQ2FHMExxWHI0UApxMVMrZDJwRDUzYWNKQTJDWkEzMFRLRXNOaTg0SHpabVIyUzRGRmlFenEvUUtobUNTbExGR3NFUGJRM0YvZUZsCnFmU09PTytyaVF0RDBBU0xldUdyTkZ6aCs3US9mZ3NrcDhheVpaZUV0TUxyM0djZDc0a1RtSE1tck00bGtYVTcKMmZiM25GclVkQm5vekdMa0hRTkZKanl3a3hXR0FXdm1Ec24yeVpDSzhFNG1HcGJZYTdWYlhTVWdOR0c2czBxSApDaEliWi9GczVWN0o2eTM2enprQ0F3RUFBYU5oTUY4d0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUJCZ2dyQmdFRkJRY0RBakFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQjBHQTFVZERnUVcKQkJSbG16bnFValZJWTdqRnpUTzNCeG5rREZMc01qQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFMZUxGQmcxQwpZQTBqZTZ3aGpQLzFvYStWQXEyaUwzWUVNa3d2b3VJVEI3SlhWV0lDMXBtZTNVM2l2eUxCWG96V1VsOUxkcUhLClo0SnZRb29vZkVWVlV0V1llU3ZVSXBqMk0wMmVxaGlaaFlKTDAxVERjVDJaUlUwR1pUQkhsUEZZVzJnV3hlZEwKU0UyQmRMcXU2d2wyc0ozaGgxeGRPVFNXb1UwUm96SVJZaTY0NVlTYUEwRFNodlptaE95cEd6ZW91SUR1T0wvUwpOU1E1bXRTVzV4KzZ2Nk5SLzhlM1RxODlzQXlDQlRSZDQ1TjRESzI4RVhhSFlZZ3lmeUgrL0lML2t2bWd3ZUFiCitmS1JicmtJcUxNd04zc29pRHdxdWhzdFVxSVd4bndkLzdvcG9MQ2NpMk95aEFGSWZ6VHRSWjZyLzBoL0s4bEYKMjZHSHFVcThuUWJOTkE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  groupPriorityMinimum: 10000
  versionPriority: 15
---
# Source: stash-opscenter/charts/stash-grafana-dashboards/templates/dashboard.yaml
apiVersion: openviz.dev/v1alpha1
kind: GrafanaDashboard
metadata:
  name: stash-dashboard
  namespace: default
  labels:
    k8s.io/group: stash.appscode.com
    helm.sh/chart: stash-grafana-dashboards-v2024.4.8
    app.kubernetes.io/name: stash-grafana-dashboards
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "v2024.4.8"
    app.kubernetes.io/managed-by: Helm
spec:
  model:
    annotations:
      list:
      - builtIn: 1
        datasource: -- Grafana --
        enable: true
        hide: true
        iconColor: rgba(0, 211, 255, 1)
        name: Annotations & Alerts
        target:
          limit: 100
          matchAny: false
          tags: []
          type: dashboard
        type: dashboard
    description: Grafana dashboard for Stash Enterprise edition
    editable: true
    fiscalYearStartMonth: 0
    gnetId: null
    graphTooltip: 0
    iteration: 1637585064532
    links: []
    liveNow: false
    panels:
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 0
      id: 23
      panels: []
      title: Overview
      type: row
    - datasource: ${datasource}
      description: Number of applications that has been configured for backup
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 0
        "y": 1
      id: 8
      options:
        colorMode: none
        graphMode: area
        justifyMode: center
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"})
        format: time_series
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Total Applications
      type: stat
    - datasource: ${datasource}
      description: Total number of successful backup
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: green
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 4
        "y": 1
      id: 10
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Succeeded"})
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Successful Backups
      type: stat
    - datasource: ${datasource}
      description: Number of backup sessions that are currently running
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 8
        "y": 1
      id: 14
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}",phase="Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Running Backups
      type: stat
    - datasource: ${datasource}
      description: Number of backup sessions that have been skipped
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: dark-purple
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 12
        "y": 1
      id: 13
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Skipped"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Skipped Backup
      type: stat
    - datasource: ${datasource}
      description: Number of backups that have failed
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: red
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 16
        "y": 1
      id: 12
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}", phase="Failed"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Failed Backups
      type: stat
    - datasource: ${datasource}
      description: Total size of the backed up data
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 20
        "y": 1
      id: 21
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 48
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: sum(stash_appscode_com_repository_size_bytes{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}",})
        format: time_series
        instant: false
        interval: ""
        intervalFactor: 3
        legendFormat: ""
        refId: A
      title: Total Backup Size
      type: stat
    - datasource: ${datasource}
      description: A list of backup targets
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 247
        - matcher:
            id: byName
            options: BackupConfiguration
          properties:
          - id: custom.width
            value: 350
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 283
        - matcher:
            id: byName
            options: Kind
          properties:
          - id: custom.width
            value: 162
        - matcher:
            id: byName
            options: Schedule
          properties:
          - id: custom.width
            value: 126
        - matcher:
            id: byName
            options: Driver
          properties:
          - id: custom.width
            value: 109
        - matcher:
            id: byName
            options: Namespace
          properties:
          - id: custom.width
            value: 151
        - matcher:
            id: byName
            options: Ready
          properties:
          - id: mappings
            value:
            - options:
                "False":
                  color: dark-red
                  index: 1
                  text: "No"
                "True":
                  color: dark-green
                  index: 0
                  text: "Yes"
              type: value
          - id: custom.width
            value: 96
          - id: noValue
            value: "False"
        - matcher:
            id: byName
            options: Last Successful Backup
          properties:
          - id: unit
            value: dateTimeFromNow
          - id: noValue
            value: No backup yet
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 311
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 4
      id: 25
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}", target_kind=~"${target_kind}",
          target_name=~"${target_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_backupconfiguration_conditions{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}",
          condition="CronJobCreated", status="True"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_backupsession_last_success_time_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
          * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Backup Targets
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations: []
              operation: null
            'Value #A':
              aggregations:
              - lastNotNull
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: null
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            backupconfiguration:
              aggregations:
              - lastNotNull
              operation: null
            condition:
              aggregations:
              - lastNotNull
              operation: null
            driver:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
            schedule:
              aggregations:
              - lastNotNull
              operation: aggregate
            status:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_kind:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_name:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName:
            __name__: true
            __name__ 1: true
            __name__ 2: true
            Time: true
            Time 1: true
            Time 2: true
            Value: true
            'Value #A': true
            'Value #B': true
            condition: true
            container: true
            container 1: true
            container 2: true
            instance: true
            instance 1: true
            instance 2: true
            invoker_kind: false
            invoker_name: false
            job: true
            job 1: true
            job 2: true
            namespace 2: true
            status: false
            target_api_version: true
          indexByName:
            'Value #C (lastNotNull)': 9
            driver (lastNotNull): 6
            invoker_kind: 3
            invoker_name: 4
            namespace: 2
            repository (lastNotNull): 5
            schedule (lastNotNull): 7
            status (lastNotNull): 8
            target_kind (lastNotNull): 0
            target_name (lastNotNull): 1
          renameByName:
            __name__: ""
            Time: ""
            Time 1: ""
            Value: ""
            'Value #A': ""
            'Value #C (lastNotNull)': Last Successful Backup
            backupconfiguration: BackupConfiguration
            backupconfiguration (lastNotNull): BackupConfiguration
            driver: Driver
            driver (lastNotNull): Driver
            instance: ""
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            namespace 1: Namespace
            repository: Repository
            repository (lastNotNull): Repository
            schedule: Schedule
            schedule (lastNotNull): Schedule
            status: Ready
            status (lastNotNull): Ready
            target_api_version: API Version
            target_kind: Kind
            target_kind (lastNotNull): Kind
            target_name: Name
            target_name (lastNotNull): Name
      type: table
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 13
      id: 37
      panels: []
      title: Backups
      type: row
    - datasource: ${datasource}
      description: CPU Usage by the backup pods
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 14
      id: 35
      interval: null
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      pluginVersion: 8.1.2
      targets:
      - exemplar: false
        expr: sum(rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container!="",
          pod=~"stash-backup-.*",image!=""}[$__rate_interval])) by(pod)
        format: time_series
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container="stash",image!=""}[$__rate_interval])
        hide: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: B
      timeFrom: null
      timeShift: null
      title: CPU Usage (Backup Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: Memory usage by backup containers
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            axisSoftMin: 0
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 22
      id: 33
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: right
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace!="", container!="",pod=~"stash-backup-.*",image!=""})by(pod)
          > 0
        hide: false
        instant: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace!="", container="stash",image!=""})by(pod)
          > 0
        hide: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: C
      title: Memory Usage (Backup Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: List of BackupSessions
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Phase
          properties:
          - id: custom.width
            value: 138
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 373
        - matcher:
            id: byName
            options: Invoker Kind
          properties:
          - id: custom.width
            value: 192
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 279
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 251
        - matcher:
            id: byName
            options: Session Duration
          properties:
          - id: unit
            value: dtdurations
        - matcher:
            id: byName
            options: Creation Time
          properties:
          - id: unit
            value: dateTimeFromNow
        - matcher:
            id: byName
            options: BackupSession Name
          properties:
          - id: custom.width
            value: 464
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 32
      id: 27
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_backupsession_info{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_backupsession_duration_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_backupsession_created{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"} * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Recent Backups
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations:
              - lastNotNull
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            backupsession:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            phase:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName:
            Time: true
            container: true
            driver: true
            endpoint: true
            job: true
            pod: true
            repository: true
            service: true
          indexByName:
            'Value #B (lastNotNull)': 6
            backupsession (lastNotNull): 0
            invoker_kind: 2
            invoker_name: 3
            namespace: 1
            phase (lastNotNull): 5
            repository (lastNotNull): 4
          renameByName:
            __name__: Name
            Time: ""
            'Value #B': Duration
            'Value #B (lastNotNull)': Session Duration
            'Value #C (lastNotNull)': Creation Time
            backupsession (lastNotNull): BackupSession Name
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            phase (lastNotNull): Phase
            repository (lastNotNull): Repository
      type: table
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 40
      id: 41
      panels: []
      title: Repository
      type: row
    - datasource: ${datasource}
      description: List of Repositories currently exist in the cluster
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          noValue: '-'
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Integrity
          properties:
          - id: mappings
            value:
            - options:
                "0":
                  color: dark-red
                  index: 1
                  text: "No"
                "1":
                  color: dark-green
                  index: 0
                  text: "Yes"
              type: value
          - id: custom.width
            value: 112
        - matcher:
            id: byName
            options: Size
          properties:
          - id: unit
            value: decbytes
          - id: custom.width
            value: 118
        - matcher:
            id: byName
            options: Last Backup Time
          properties:
          - id: unit
            value: dateTimeFromNow
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 268
        - matcher:
            id: byName
            options: Backend
          properties:
          - id: custom.width
            value: 116
        - matcher:
            id: byName
            options: Bucket/Container
          properties:
          - id: custom.width
            value: 215
        - matcher:
            id: byName
            options: Prefix
          properties:
          - id: custom.width
            value: 392
        - matcher:
            id: byName
            options: Snapshot Count
          properties:
          - id: custom.width
            value: 134
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 41
      id: 31
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_repository_integrity{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_repository_snapshot_count{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_repository_size_bytes{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      - exemplar: false
        expr: stash_appscode_com_backupsession_last_success_time_seconds{namespace=~"${namespace}",
          invoker_kind=~"${backup_invoker_kind}", invoker_name=~"${backup_invoker_name}"}
          * 1000
        format: table
        instant: true
        interval: ""
        legendFormat: ""
        refId: D
      title: Repositories
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            'Value #A':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #D':
              aggregations:
              - lastNotNull
              operation: aggregate
            backend:
              aggregations:
              - lastNotNull
              operation: aggregate
            bucket:
              aggregations:
              - lastNotNull
              operation: aggregate
            namespace:
              aggregations: []
              operation: groupby
            prefix:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations: []
              operation: groupby
      - id: organize
        options:
          excludeByName: {}
          indexByName:
            'Value #A (lastNotNull)': 5
            'Value #B (lastNotNull)': 6
            'Value #C (lastNotNull)': 7
            'Value #D (lastNotNull)': 8
            backend (lastNotNull): 2
            bucket (lastNotNull): 3
            namespace: 1
            prefix (lastNotNull): 4
            repository: 0
          renameByName:
            'Value #A (lastNotNull)': Integrity
            'Value #B (lastNotNull)': Snapshot Count
            'Value #C (lastNotNull)': Size
            'Value #D (lastNotNull)': Last Backup Time
            backend (lastNotNull): Backend
            bucket (lastNotNull): Bucket/Container
            namespace: Namespace
            prefix (lastNotNull): Prefix
            repository: Name
      type: table
    - datasource: ${datasource}
      description: Graph showing how repository size grows over time
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: linear
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 51
      id: 43
      options:
        legend:
          calcs:
          - lastNotNull
          displayMode: table
          placement: right
        tooltip:
          mode: single
      pluginVersion: 8.1.2
      targets:
      - exemplar: false
        expr: stash_appscode_com_repository_size_bytes{namespace=~"${namespace}", invoker_kind=~"${backup_invoker_kind}",
          invoker_name=~"${backup_invoker_name}"}
        format: time_series
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{namespace}}/{{name}}'
        refId: A
      title: Repository Sizes
      transformations: []
      type: graph
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 60
      id: 39
      panels: []
      title: Restores
      type: row
    - datasource: ${datasource}
      description: Number of total restore done within the time-frame
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 0
        "y": 61
      id: 44
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Total Restore Count
      type: stat
    - datasource: ${datasource}
      description: Total number of successful restores
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: semi-dark-green
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 5
        "y": 61
      id: 15
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Succeeded"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Successful Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that are currently running
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: light-blue
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 10
        "y": 61
      id: 17
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Running Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that are currently pending to run
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: semi-dark-purple
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 5
        x: 15
        "y": 61
      id: 18
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 53
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"})
          - count(stash_appscode_com_restoresession_info{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}", phase=~"Succeeded|Failed|Running"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Pending Restores
      type: stat
    - datasource: ${datasource}
      description: Number of restore sessions that have failed
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: text
              value: null
            - color: red
              value: 1
        overrides: []
      gridPos:
        h: 3
        w: 4
        x: 20
        "y": 61
      id: 16
      options:
        colorMode: none
        graphMode: none
        justifyMode: auto
        orientation: auto
        reduceOptions:
          calcs:
          - lastNotNull
          fields: ""
          values: false
        text:
          valueSize: 56
        textMode: auto
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: count(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}",
          phase="Failed"})
        instant: true
        interval: ""
        legendFormat: ""
        refId: A
      title: Failed Restores
      type: stat
    - datasource: ${datasource}
      description: List of current RestoreSession in the cluster
      fieldConfig:
        defaults:
          color:
            mode: thresholds
          custom:
            align: auto
            displayMode: auto
            filterable: false
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides:
        - matcher:
            id: byName
            options: Phase
          properties:
          - id: noValue
            value: Pending
          - id: custom.width
            value: 117
        - matcher:
            id: byName
            options: Name
          properties:
          - id: custom.width
            value: 277
        - matcher:
            id: byName
            options: Namespace
          properties:
          - id: custom.width
            value: 120
        - matcher:
            id: byName
            options: Invoker Name
          properties:
          - id: custom.width
            value: 285
        - matcher:
            id: byName
            options: Driver
          properties:
          - id: custom.width
            value: 108
        - matcher:
            id: byName
            options: Repository
          properties:
          - id: custom.width
            value: 265
        - matcher:
            id: byName
            options: Session Duration
          properties:
          - id: unit
            value: dtdurations
        - matcher:
            id: byName
            options: Restored At
          properties:
          - id: unit
            value: dateTimeFromNow
      gridPos:
        h: 9
        w: 24
        x: 0
        "y": 64
      id: 29
      options:
        showHeader: true
        sortBy: []
      pluginVersion: 8.2.3
      targets:
      - exemplar: false
        expr: stash_appscode_com_restoresession_info{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        intervalFactor: 1
        legendFormat: ""
        refId: A
      - exemplar: false
        expr: stash_appscode_com_restoresession_duration_seconds{namespace=~"${namespace}",
          invoker_kind=~"${restore_invoker_kind}", invoker_name=~"${restore_invoker_name}"}
        format: table
        hide: false
        instant: true
        interval: ""
        intervalFactor: 1
        legendFormat: ""
        refId: B
      - exemplar: false
        expr: stash_appscode_com_restoresession_created{namespace=~"${namespace}", invoker_kind=~"${restore_invoker_kind}",
          invoker_name=~"${restore_invoker_name}"} * 1000
        format: table
        hide: false
        instant: true
        interval: ""
        legendFormat: ""
        refId: C
      title: Recent Restores
      transformations:
      - id: merge
        options: {}
      - id: groupBy
        options:
          fields:
            __name__:
              aggregations:
              - lastNotNull
              operation: null
            Time:
              aggregations: []
              operation: null
            'Value #B':
              aggregations:
              - lastNotNull
              operation: aggregate
            'Value #C':
              aggregations:
              - lastNotNull
              operation: aggregate
            driver:
              aggregations:
              - lastNotNull
              operation: aggregate
            invoker_kind:
              aggregations: []
              operation: groupby
            invoker_name:
              aggregations: []
              operation: groupby
            namespace:
              aggregations: []
              operation: groupby
            phase:
              aggregations:
              - lastNotNull
              operation: aggregate
            repository:
              aggregations:
              - lastNotNull
              operation: aggregate
            restoresession:
              aggregations: []
              operation: null
            target_kind:
              aggregations:
              - lastNotNull
              operation: aggregate
            target_name:
              aggregations:
              - lastNotNull
              operation: aggregate
      - id: organize
        options:
          excludeByName: {}
          indexByName:
            'Value #B (lastNotNull)': 8
            driver (lastNotNull): 6
            invoker_kind: 3
            invoker_name: 4
            namespace: 2
            phase (lastNotNull): 7
            repository (lastNotNull): 5
            target_kind (lastNotNull): 0
            target_name (lastNotNull): 1
          renameByName:
            'Value #B (lastNotNull)': Session Duration
            'Value #C (lastNotNull)': Restored At
            driver (lastNotNull): Driver
            invoker_kind: Invoker Kind
            invoker_name: Invoker Name
            namespace: Namespace
            phase (lastNotNull): Phase
            repository (lastNotNull): Repository
            target_kind (lastNotNull): Kind
            target_name (lastNotNull): Name
      type: table
    - datasource: ${datasource}
      description: CPU Usage by the  restore pods
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          noValue: "0"
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 73
      id: 45
      interval: null
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(rate(container_cpu_usage_seconds_total{namespace=~"${namespace}", container!="",
          pod=~"stash-restore-.*",image!=""}[$__rate_interval])) by(pod)
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: rate(container_cpu_usage_seconds_total{namespace=~"${namespace}",container="stash-init"}[$__rate_interval])
        format: time_series
        hide: false
        instant: false
        interval: ""
        intervalFactor: 1
        legendFormat: '{{container}}'
        refId: B
      timeFrom: null
      timeShift: null
      title: CPU Usage (Restore Job/Sidecar)
      transformations: []
      type: graph
    - datasource: ${datasource}
      description: Memory usage by  restore containers
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            axisSoftMin: 0
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: normal
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
          unit: decbytes
        overrides: []
      gridPos:
        h: 10
        w: 24
        x: 0
        "y": 81
      id: 46
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: right
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace=~"${namespace}", container!="",pod=~"stash-restore-.*",image!=""})by(pod)
          > 0
        hide: false
        instant: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: A
      - exemplar: false
        expr: sum(container_memory_usage_bytes{namespace=~"${namespace}", container="stash-init",image!=""})by(pod)
          > 0
        hide: false
        interval: ""
        intervalFactor: 2
        legendFormat: '{{pod}}'
        refId: C
      title: Memory Usage (Restore Job/Sidecar)
      transformations: []
      type: graph
    - collapsed: false
      datasource: null
      gridPos:
        h: 1
        w: 24
        x: 0
        "y": 91
      id: 2
      panels: []
      title: Operator & Pushgateway
      type: row
    - datasource: ${datasource}
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
        overrides: []
      gridPos:
        h: 7
        w: 24
        x: 0
        "y": 92
      id: 6
      options:
        legend:
          calcs: []
          displayMode: list
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(irate(container_cpu_usage_seconds_total{container=~"operator|pushgateway",
          pod=~".*stash-enterprise.*"}[$__rate_interval])) by(container)
        instant: false
        interval: ""
        intervalFactor: 3
        legendFormat: '{{container}}'
        refId: A
      title: CPU Usage
      type: graph
    - datasource: ${datasource}
      description: Memory Usage of Stash Operator
      fieldConfig:
        defaults:
          color:
            mode: palette-classic
          custom:
            axisLabel: ""
            axisPlacement: auto
            barAlignment: 0
            drawStyle: line
            fillOpacity: 20
            gradientMode: none
            hideFrom:
              legend: false
              tooltip: false
              viz: false
            lineInterpolation: smooth
            lineStyle:
              fill: solid
            lineWidth: 1
            pointSize: 5
            scaleDistribution:
              type: linear
            showPoints: never
            spanNulls: false
            stacking:
              group: A
              mode: none
            thresholdsStyle:
              mode: "off"
          mappings: []
          thresholds:
            mode: absolute
            steps:
            - color: green
              value: null
            - color: red
              value: 80
          unit: decbytes
        overrides: []
      gridPos:
        h: 8
        w: 24
        x: 0
        "y": 99
      id: 4
      options:
        legend:
          calcs:
          - lastNotNull
          - max
          displayMode: table
          placement: bottom
        tooltip:
          mode: single
      targets:
      - exemplar: false
        expr: sum(container_memory_usage_bytes{container=~"operator|pushgateway", pod=~".*stash-enterprise.*"})by(container)
        interval: ""
        intervalFactor: 2
        legendFormat: '{{container}}'
        refId: A
      title: Memory Usage
      type: graph
    refresh: 10s
    schemaVersion: 31
    style: dark
    tags: []
    templating:
      list:
      - current:
          selected: false
          text: Prometheus
          value: Prometheus
        description: null
        error: null
        hide: 0
        includeAll: false
        label: Data Source
        multi: false
        name: datasource
        options: []
        query: prometheus
        queryValue: ""
        refresh: 1
        regex: ""
        skipUrlSync: false
        type: datasource
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info,namespace)
        description: List of namespaces where the backups are running
        error: null
        hide: 0
        includeAll: true
        label: Namespace
        multi: false
        name: namespace
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info,namespace)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}"},target_kind)
        description: Kind of the targeted application
        error: null
        hide: 0
        includeAll: true
        label: Target Kind
        multi: false
        name: target_kind
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}"},target_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: .+
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}"},target_name)
        description: Name of the targeted application
        error: null
        hide: 0
        includeAll: true
        label: Target Name
        multi: false
        name: target_name
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}"},target_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        description: Kind of the backup invoker object
        error: null
        hide: 2
        includeAll: true
        label: ""
        multi: false
        name: backup_invoker_kind
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        description: Name of the respective backup invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: backup_invoker_name
        options: []
        query: label_values(stash_appscode_com_backupconfiguration_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 0
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        description: Kind of the restore invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: restore_invoker_kind
        options: []
        query: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_kind)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
      - allValue: ""
        current:
          selected: false
          text: All
          value: $__all
        datasource: ${datasource}
        definition: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        description: Name of the respective restore invoker object
        error: null
        hide: 2
        includeAll: true
        label: null
        multi: false
        name: restore_invoker_name
        options: []
        query: label_values(stash_appscode_com_restoresession_info{namespace=~"${namespace}",
          target_kind=~"${target_kind}", target_name=~"${target_name}"},invoker_name)
        refresh: 2
        regex: ""
        skipUrlSync: false
        sort: 1
        type: query
    time:
      from: now-1h
      to: now
    timepicker: {}
    timezone: ""
    title: Stash / Dashboard
    version: 6
  overwrite: true
  templatize:
    title: false
    datasource: false
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-backupconfiguration.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-backupconfiguration
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: BackupConfiguration
  commonLabels:
    - key: invoker_kind
      value: "BackupConfiguration"
    - key: invoker_name
      valuePath: .metadata.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this BackupConfiguration object"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about this BackupConfiguration"
      type: gauge
      labels:
        - key: driver
          valuePath: .spec.driver
        - key: repository
          valuePath: .spec.repository.name
        - key: schedule
          valuePath: .spec.schedule
        - key: target_api_version
          valuePath: .spec.target.ref.apiVersion
        - key: target_kind
          valuePath: .spec.target.ref.kind
        - key: target_name
          valuePath: .spec.target.ref.name
      metricValue:
        value: 1
    - name: conditions
      help: "Current conditions of this BackupConfiguration"
      type: gauge
      field:
        path: .status.conditions
        type: Array
      labels:
        - key: condition
          valuePath: .status.conditions[*].type
        - key: status
          valuePath: .status.conditions[*].status
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-backupsession.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-backupsession
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: BackupSession
  commonLabels:
    - key: invoker_api_group
      valuePath: .spec.invoker.apiGroup
    - key: invoker_kind
      valuePath: .spec.invoker.kind
    - key: invoker_name
      valuePath: .spec.invoker.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this BackupSession"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about BackupSession"
      type: gauge
      labels:
        - key: phase
          valuePath: .status.phase
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-repository.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-repository
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1alpha1
    kind: Repository
  metrics:
    - name: created
      help: "Unix creation timestamp of this Repository"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
---
# Source: stash-opscenter/charts/stash-metrics/templates/metricsconfig-restoresession.yaml
apiVersion: metrics.appscode.com/v1alpha1
kind: MetricsConfiguration
metadata:
  name: stash-appscode-com-restoresession
spec:
  targetRef:
    apiVersion: stash.appscode.com/v1beta1
    kind: RestoreSession
  commonLabels:
    - key: invoker_kind
      value: "RestoreSession"
    - key: invoker_name
      valuePath: .metadata.name
  metrics:
    - name: created
      help: "Unix creation timestamp of this RestoreSession object"
      type: gauge
      field:
        path: .metadata.creationTimestamp
        type: DateTime
      metricValue:
        valueFromPath: .metadata.creationTimestamp
    - name: info
      help: "General information about this RestoreSession"
      type: gauge
      labels:
        - key: driver
          valuePath: .spec.driver
        - key: repository
          valuePath: .spec.repository.name
        - key: target_api_version
          valuePath: .spec.target.ref.apiVersion
        - key: target_kind
          valuePath: .spec.target.ref.kind
        - key: target_name
          valuePath: .spec.target.ref.name
        - key: phase
          valuePath: .status.phase
      metricValue:
        value: 1
---
# Source: stash-opscenter/charts/stash-metrics/templates/metrics-user-roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: appscode:metrics:edit
  labels:
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - metrics.appscode.com
  resources:
  - "*"
  verbs: ["*"]
---
# Source: stash-opscenter/charts/stash-metrics/templates/metrics-user-roles.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: appscode:metrics:view
  labels:
    rbac.authorization.k8s.io/aggregate-to-view: "true"
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - metrics.appscode.com
  resources:
  - "*"
  verbs: ["get", "list", "watch"]
---
# Source: stash-opscenter/charts/stash-ui-server/templates/user-roles.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: stash:ui:viewer
  labels:
    rbac.authorization.k8s.io/aggregate-to-admin: "true"
    rbac.authorization.k8s.io/aggregate-to-edit: "true"
    rbac.authorization.k8s.io/aggregate-to-view: "true"
  annotations:
    "helm.sh/hook": post-install,post-upgrade
    "helm.sh/hook-delete-policy": before-hook-creation
rules:
- apiGroups:
  - ui.stash.appscode.com
  resources:
  - "*"
  verbs: ["get", "list"]
