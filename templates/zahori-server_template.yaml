---
# Source: zahori-server/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: release-name-zahori-server
  labels:
    helm.sh/chart: zahori-server-1.0.1
    app.kubernetes.io/name: zahori-server
    app.kubernetes.io/instance: release-name
    app.kubernetes.io/version: "0.1.17"
    app.kubernetes.io/managed-by: Helm
---
# Source: zahori-server/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: zahori-server-secret
  namespace: zahori
type: Opaque
data:
  POSTGRES_PASSWORD: emFob3Jp
---
# Source: zahori-server/templates/configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: zahori-server
  name: zahori-server-scripts
  namespace: zahori
data:
  V0.1.0.1__init_schema.sql: "-- Roles\n\n-- CREATE ROLE zahori NOSUPERUSER NOCREATEDB
    NOCREATEROLE NOINHERIT LOGIN PASSWORD 'zahori';\n\n\n-- Schemas\n\n-- DROP SCHEMA
    public;\n-- CREATE SCHEMA public AUTHORIZATION zahori;\n\n\n-- Permissions\n\nGRANT
    ALL ON SCHEMA public TO zahori;\n\n\n-- public.authentication_types definition\n\n--
    Drop table\n\n-- DROP TABLE public.authentication_types;\n\nCREATE TABLE public.authentication_types
    (\n    auth_id serial NOT NULL,\n    \"name\" varchar NOT NULL,\n    \"default\"
    int2 NULL,\n    \"order\" int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n
    \   CONSTRAINT authentication_types_pkey PRIMARY KEY (auth_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.authentication_types OWNER TO zahori;\nGRANT ALL ON TABLE public.authentication_types
    TO zahori;\n\n\n-- public.browsers definition\n\n-- Drop table\n\n-- DROP TABLE
    public.browsers;\n\nCREATE TABLE public.browsers (\n    browser_name varchar NOT
    NULL,\n    icon varchar NULL,\n    default_version varchar NULL,\n    \"order\"
    int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT browsers_pkey
    PRIMARY KEY (browser_name)\n);\n\n-- Permissions\n\nALTER TABLE public.browsers
    OWNER TO zahori;\nGRANT ALL ON TABLE public.browsers TO zahori;\n\n\n-- public.clients
    definition\n\n-- Drop table\n\n-- DROP TABLE public.clients;\n\nCREATE TABLE public.clients
    (\n    client_id serial NOT NULL,\n    \"name\" varchar NULL,\n    logo varchar
    NULL,\n    css varchar NULL,\n    num_parallel int4 NOT NULL,\n    active bool NOT
    NULL DEFAULT true,\n    CONSTRAINT clients_pkey PRIMARY KEY (client_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.clients OWNER TO zahori;\nGRANT ALL ON TABLE public.clients
    TO zahori;\n\n\n-- public.customerconfig definition\n\n-- Drop table\n\n-- DROP
    TABLE public.customerconfig;\n\nCREATE TABLE public.customerconfig (\n    id serial
    NOT NULL,\n    \"name\" varchar NULL,\n    CONSTRAINT customerconfig_pk PRIMARY
    KEY (id)\n);\n\n-- Permissions\n\nALTER TABLE public.customerconfig OWNER TO zahori;\nGRANT
    ALL ON TABLE public.customerconfig TO zahori;\n\n\n-- public.evidence_cases definition\n\n--
    Drop table\n\n-- DROP TABLE public.evidence_cases;\n\nCREATE TABLE public.evidence_cases
    (\n    evi_case_id serial NOT NULL,\n    \"name\" varchar NOT NULL,\n    \"order\"
    int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT evidence_cases_pkey
    PRIMARY KEY (evi_case_id)\n);\n\n-- Permissions\n\nALTER TABLE public.evidence_cases
    OWNER TO zahori;\nGRANT ALL ON TABLE public.evidence_cases TO zahori;\n\n\n-- public.evidence_types
    definition\n\n-- Drop table\n\n-- DROP TABLE public.evidence_types;\n\nCREATE TABLE
    public.evidence_types (\n    evi_type_id serial NOT NULL,\n    \"name\" varchar
    NOT NULL,\n    \"order\" int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n
    \   CONSTRAINT evidence_type_pkey PRIMARY KEY (evi_type_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.evidence_types OWNER TO zahori;\nGRANT ALL ON TABLE public.evidence_types
    TO zahori;\n\n\n-- public.languages definition\n\n-- Drop table\n\n-- DROP TABLE
    public.languages;\n\nCREATE TABLE public.languages (\n    lang_id serial NOT NULL,\n
    \   \"name\" varchar NOT NULL,\n    \"order\" int8 NOT NULL,\n    active bool NOT
    NULL DEFAULT true,\n    CONSTRAINT languages_pkey PRIMARY KEY (lang_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.languages OWNER TO zahori;\nGRANT ALL ON TABLE
    public.languages TO zahori;\n\n\n-- public.periodic_executions definition\n\n--
    Drop table\n\n-- DROP TABLE public.periodic_executions;\n\nCREATE TABLE public.periodic_executions
    (\n    periodic_execution_id serial NOT NULL,\n    \"time\" time NOT NULL,\n    days
    varchar NOT NULL,\n    active bool NOT NULL,\n    CONSTRAINT periodic_executions_pk
    PRIMARY KEY (periodic_execution_id)\n);\n\n-- Permissions\n\nALTER TABLE public.periodic_executions
    OWNER TO zahori;\nGRANT ALL ON TABLE public.periodic_executions TO zahori;\n\n\n--
    public.platforms definition\n\n-- Drop table\n\n-- DROP TABLE public.platforms;\n\nCREATE
    TABLE public.platforms (\n    platform_name varchar NOT NULL,\n    \"order\" int8
    NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT platforms_pkey
    PRIMARY KEY (platform_name)\n);\n\n-- Permissions\n\nALTER TABLE public.platforms
    OWNER TO zahori;\nGRANT ALL ON TABLE public.platforms TO zahori;\n\n\n-- public.processes_types
    definition\n\n-- Drop table\n\n-- DROP TABLE public.processes_types;\n\nCREATE TABLE
    public.processes_types (\n    proc_type_id serial NOT NULL,\n    \"name\" varchar
    NOT NULL,\n    \"order\" int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n
    \   CONSTRAINT processes_types_pkey PRIMARY KEY (proc_type_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.processes_types OWNER TO zahori;\nGRANT ALL ON TABLE public.processes_types
    TO zahori;\n\n\n-- public.retries definition\n\n-- Drop table\n\n-- DROP TABLE public.retries;\n\nCREATE
    TABLE public.retries (\n    retry_id int4 NOT NULL,\n    active bool NOT NULL DEFAULT
    true,\n    CONSTRAINT configurations_retries_pkey PRIMARY KEY (retry_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.retries OWNER TO zahori;\nGRANT ALL ON TABLE public.retries
    TO zahori;\n\n\n-- public.roles definition\n\n-- Drop table\n\n-- DROP TABLE public.roles;\n\nCREATE
    TABLE public.roles (\n    id serial NOT NULL,\n    code varchar NOT NULL,\n    \"label\"
    varchar NOT NULL,\n    CONSTRAINT roles_pkey PRIMARY KEY (id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.roles OWNER TO zahori;\nGRANT ALL ON TABLE public.roles TO zahori;\n\n\n--
    public.test_repositories definition\n\n-- Drop table\n\n-- DROP TABLE public.test_repositories;\n\nCREATE
    TABLE public.test_repositories (\n    test_repo_id serial NOT NULL,\n    \"name\"
    varchar NOT NULL,\n    \"order\" int8 NOT NULL,\n    active bool NOT NULL DEFAULT
    true,\n    CONSTRAINT test_repositories_pkey PRIMARY KEY (test_repo_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.test_repositories OWNER TO zahori;\nGRANT ALL
    ON TABLE public.test_repositories TO zahori;\n\n\n-- public.timeouts definition\n\n--
    Drop table\n\n-- DROP TABLE public.timeouts;\n\nCREATE TABLE public.timeouts (\n
    \   timeout_id int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT
    timeouts_pkey PRIMARY KEY (timeout_id)\n);\n\n-- Permissions\n\nALTER TABLE public.timeouts
    OWNER TO zahori;\nGRANT ALL ON TABLE public.timeouts TO zahori;\n\n\n-- public.accounts
    definition\n\n-- Drop table\n\n-- DROP TABLE public.accounts;\n\nCREATE TABLE public.accounts
    (\n    id serial NOT NULL,\n    client_id int8 NOT NULL,\n    username varchar NOT
    NULL,\n    \"password\" varchar NOT NULL,\n    enabled bool NOT NULL DEFAULT true,\n
    \   credentialsexpired bool NOT NULL DEFAULT false,\n    expired bool NOT NULL DEFAULT
    false,\n    \"locked\" bool NOT NULL DEFAULT false,\n    CONSTRAINT accounts_pkey
    PRIMARY KEY (id),\n    CONSTRAINT accounts_fk FOREIGN KEY (client_id) REFERENCES
    clients(client_id)\n);\n\n-- Permissions\n\nALTER TABLE public.accounts OWNER TO
    zahori;\nGRANT ALL ON TABLE public.accounts TO zahori;\n\n\n-- public.accounts_roles
    definition\n\n-- Drop table\n\n-- DROP TABLE public.accounts_roles;\n\nCREATE TABLE
    public.accounts_roles (\n    account_id int8 NOT NULL,\n    role_id int8 NOT NULL,\n
    \   CONSTRAINT accounts_roles_pk PRIMARY KEY (account_id, role_id),\n    CONSTRAINT
    accounts_fk FOREIGN KEY (account_id) REFERENCES accounts(id),\n    CONSTRAINT roles_fk
    FOREIGN KEY (role_id) REFERENCES roles(id)\n);\n\n-- Permissions\n\nALTER TABLE
    public.accounts_roles OWNER TO zahori;\nGRANT ALL ON TABLE public.accounts_roles
    TO zahori;\n\n\n-- public.client_evidence_cases definition\n\n-- Drop table\n\n--
    DROP TABLE public.client_evidence_cases;\n\nCREATE TABLE public.client_evidence_cases
    (\n    client_id int8 NOT NULL,\n    evi_case_id int8 NOT NULL,\n    CONSTRAINT
    rel_cli_evidence_cases_pkey PRIMARY KEY (client_id, evi_case_id),\n    CONSTRAINT
    rel_cli_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n    CONSTRAINT
    rel_evidence_cases_fk FOREIGN KEY (evi_case_id) REFERENCES evidence_cases(evi_case_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.client_evidence_cases OWNER TO zahori;\nGRANT
    ALL ON TABLE public.client_evidence_cases TO zahori;\n\n\n-- public.client_evidence_types
    definition\n\n-- Drop table\n\n-- DROP TABLE public.client_evidence_types;\n\nCREATE
    TABLE public.client_evidence_types (\n    client_id int8 NOT NULL,\n    evi_type_id
    int8 NOT NULL,\n    CONSTRAINT rel_cli_evidence_type_pkey PRIMARY KEY (client_id,
    evi_type_id),\n    CONSTRAINT rel_cli_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n
    \   CONSTRAINT rel_evidence_type_fk FOREIGN KEY (evi_type_id) REFERENCES evidence_types(evi_type_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.client_evidence_types OWNER TO zahori;\nGRANT
    ALL ON TABLE public.client_evidence_types TO zahori;\n\n\n-- public.client_languages
    definition\n\n-- Drop table\n\n-- DROP TABLE public.client_languages;\n\nCREATE
    TABLE public.client_languages (\n    client_id int8 NOT NULL,\n    lang_id int8
    NOT NULL,\n    CONSTRAINT client_languages_pkey PRIMARY KEY (client_id, lang_id),\n
    \   CONSTRAINT client_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n
    \   CONSTRAINT client_languages_fk FOREIGN KEY (lang_id) REFERENCES languages(lang_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.client_languages OWNER TO zahori;\nGRANT ALL ON
    TABLE public.client_languages TO zahori;\n\n\n-- public.client_retries definition\n\n--
    Drop table\n\n-- DROP TABLE public.client_retries;\n\nCREATE TABLE public.client_retries
    (\n    client_id int8 NOT NULL,\n    retry_id int8 NOT NULL,\n    CONSTRAINT client_retries_pkey
    PRIMARY KEY (client_id, retry_id),\n    CONSTRAINT client_retries_client_id_fkey
    FOREIGN KEY (client_id) REFERENCES clients(client_id),\n    CONSTRAINT client_retries_fk
    FOREIGN KEY (retry_id) REFERENCES retries(retry_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.client_retries OWNER TO zahori;\nGRANT ALL ON TABLE public.client_retries
    TO zahori;\n\n\n-- public.client_teams definition\n\n-- Drop table\n\n-- DROP TABLE
    public.client_teams;\n\nCREATE TABLE public.client_teams (\n    client_id int8 NOT
    NULL,\n    team_id int8 NOT NULL,\n    \"name\" varchar NOT NULL,\n    \"admin\"
    bool NOT NULL DEFAULT false,\n    favorite bool NOT NULL DEFAULT false,\n    CONSTRAINT
    teams_pkey PRIMARY KEY (client_id, team_id),\n    CONSTRAINT teams_fk FOREIGN KEY
    (client_id) REFERENCES clients(client_id)\n);\n\n-- Permissions\n\nALTER TABLE public.client_teams
    OWNER TO zahori;\nGRANT ALL ON TABLE public.client_teams TO zahori;\n\n\n-- public.client_test_repos
    definition\n\n-- Drop table\n\n-- DROP TABLE public.client_test_repos;\n\nCREATE
    TABLE public.client_test_repos (\n    client_id int8 NOT NULL,\n    test_repo_id
    int8 NOT NULL,\n    url varchar NOT NULL,\n    \"user\" varchar NOT NULL,\n    \"password\"
    varchar NOT NULL,\n    CONSTRAINT client_test_repos_pkey PRIMARY KEY (client_id,
    test_repo_id),\n    CONSTRAINT client_test_repos_fk FOREIGN KEY (test_repo_id) REFERENCES
    test_repositories(test_repo_id),\n    CONSTRAINT rel_cli_test_repos_fk FOREIGN KEY
    (client_id) REFERENCES clients(client_id)\n);\n\n-- Permissions\n\nALTER TABLE public.client_test_repos
    OWNER TO zahori;\nGRANT ALL ON TABLE public.client_test_repos TO zahori;\n\n\n--
    public.client_timeouts definition\n\n-- Drop table\n\n-- DROP TABLE public.client_timeouts;\n\nCREATE
    TABLE public.client_timeouts (\n    client_id int8 NOT NULL,\n    timeout_id int8
    NOT NULL,\n    CONSTRAINT client_timeout_pkey PRIMARY KEY (client_id, timeout_id),\n
    \   CONSTRAINT client_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n
    \   CONSTRAINT client_timeouts_fk FOREIGN KEY (timeout_id) REFERENCES timeouts(timeout_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.client_timeouts OWNER TO zahori;\nGRANT ALL ON
    TABLE public.client_timeouts TO zahori;\n\n\n-- public.customer definition\n\n--
    Drop table\n\n-- DROP TABLE public.customer;\n\nCREATE TABLE public.customer (\n
    \   id serial NOT NULL,\n    \"name\" varchar NOT NULL,\n    customerconfig_id int4
    NOT NULL,\n    CONSTRAINT customer_pk PRIMARY KEY (id),\n    CONSTRAINT customer_fk
    FOREIGN KEY (customerconfig_id) REFERENCES customerconfig(id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.customer OWNER TO zahori;\nGRANT ALL ON TABLE public.customer TO zahori;\n\n\n--
    public.platform_browsers_versions definition\n\n-- Drop table\n\n-- DROP TABLE public.platform_browsers_versions;\n\nCREATE
    TABLE public.platform_browsers_versions (\n    platform_name varchar NOT NULL,\n
    \   browser_name varchar NOT NULL,\n    browser_version varchar NOT NULL,\n    CONSTRAINT
    rel_platform_browsers_versions_pkey PRIMARY KEY (platform_name, browser_name, browser_version),\n
    \   CONSTRAINT rel_platform_browsers_version_fk FOREIGN KEY (browser_name) REFERENCES
    browsers(browser_name),\n    CONSTRAINT rel_platform_browsers_versions_fk FOREIGN
    KEY (platform_name) REFERENCES platforms(platform_name)\n);\n\n-- Permissions\n\nALTER
    TABLE public.platform_browsers_versions OWNER TO zahori;\nGRANT ALL ON TABLE public.platform_browsers_versions
    TO zahori;\n\n\n-- public.processes definition\n\n-- Drop table\n\n-- DROP TABLE
    public.processes;\n\nCREATE TABLE public.processes (\n    process_id serial NOT
    NULL,\n    \"name\" varchar NOT NULL,\n    client_id int8 NOT NULL,\n    team_id
    int8 NOT NULL,\n    proc_type_id int8 NOT NULL,\n    jenkins_token varchar NULL,\n
    \   jenkins_job varchar NULL,\n    jenkins_job_parameter_name varchar NULL,\n    CONSTRAINT
    processes_pk PRIMARY KEY (process_id),\n    CONSTRAINT processes_fk FOREIGN KEY
    (proc_type_id) REFERENCES processes_types(proc_type_id),\n    CONSTRAINT rel_client_processes_fk
    FOREIGN KEY (client_id) REFERENCES clients(client_id),\n    CONSTRAINT rel_teams_processes_fk
    FOREIGN KEY (client_id, team_id) REFERENCES client_teams(client_id, team_id),\n
    \   CONSTRAINT processes_unique UNIQUE (client_id,\"name\",team_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.processes OWNER TO zahori;\nGRANT ALL ON TABLE public.processes TO
    zahori;\n\n\n\n-- public.client_environments definition\n\n-- Drop table\n\n-- DROP
    TABLE public.client_environments;\n\nCREATE TABLE public.client_environments (\n
    \   environment_id serial NOT NULL,\n    client_id int8 NOT NULL,\n\tprocess_id
    int8 NOT NULL,\n    \"name\" varchar NOT NULL,\n    url varchar NOT NULL,\n    \"order\"
    int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT client_environments_pk
    PRIMARY KEY (environment_id),\n    CONSTRAINT client_environments_fk FOREIGN KEY
    (client_id) REFERENCES clients(client_id),\n\tCONSTRAINT client_environments_processes_fk
    FOREIGN KEY (process_id) REFERENCES processes(process_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.client_environments OWNER TO zahori;\nGRANT ALL ON TABLE public.client_environments
    TO zahori;\n\n\n-- public.client_tags definition\n\n-- Drop table\n\n-- DROP TABLE
    public.client_tags;\n\nCREATE TABLE public.client_tags (\n    tag_id serial NOT
    NULL,\n    client_id int8 NOT NULL,\n\tprocess_id int8 NOT NULL,\n    \"name\" varchar
    NOT NULL,\n\t\"color\" varchar NOT NULL,\n    \"order\" int8 NOT NULL,\n    active
    bool NOT NULL DEFAULT true,\n    CONSTRAINT client_tags_pk PRIMARY KEY (tag_id),\n
    \   CONSTRAINT client_tags_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n\tCONSTRAINT
    client_tags_processes_fk FOREIGN KEY (process_id) REFERENCES processes(process_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.client_tags OWNER TO zahori;\nGRANT ALL ON TABLE
    public.client_tags TO zahori;\n\n\n-- public.users definition\n\n-- Drop table\n\n--
    DROP TABLE public.users;\n\nCREATE TABLE public.users (\n    user_id serial NOT
    NULL,\n    \"name\" varchar NOT NULL,\n    surnames varchar NOT NULL,\n    email
    varchar NOT NULL,\n    authentication int2 NOT NULL,\n    \"password\" varchar NOT
    NULL,\n    \"admin\" bool NOT NULL,\n    active int4 NOT NULL DEFAULT 1,\n    lang_id
    int8 NOT NULL DEFAULT 1,\n    credentialsexpired bool NOT NULL DEFAULT false,\n
    \   expired bool NOT NULL DEFAULT false,\n    \"locked\" bool NOT NULL DEFAULT false,\n
    \   CONSTRAINT users_pkey PRIMARY KEY (user_id),\n    CONSTRAINT fk_user_auth_type
    FOREIGN KEY (authentication) REFERENCES authentication_types(auth_id) NOT VALID,\n
    \   CONSTRAINT languages_fk FOREIGN KEY (lang_id) REFERENCES languages(lang_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.users OWNER TO zahori;\nGRANT ALL ON TABLE public.users
    TO zahori;\n\n\n-- public.address definition\n\n-- Drop table\n\n-- DROP TABLE public.address;\n\nCREATE
    TABLE public.address (\n    id serial NOT NULL,\n    street varchar NULL,\n    customer_id
    int8 NULL,\n    CONSTRAINT address_pk PRIMARY KEY (id),\n    CONSTRAINT customer_fk
    FOREIGN KEY (customer_id) REFERENCES customer(id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.address OWNER TO zahori;\nGRANT ALL ON TABLE public.address TO zahori;\n\n\n--
    public.cases definition\n\n-- Drop table\n\n-- DROP TABLE public.cases;\n\nCREATE
    TABLE public.cases (\n    case_id serial NOT NULL,\n    \"name\" varchar NOT NULL,\n
    \   process_id int8 NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    \"data\"
    varchar NULL,\n    CONSTRAINT cases_pk PRIMARY KEY (case_id),\n    CONSTRAINT cases_fk
    FOREIGN KEY (process_id) REFERENCES processes(process_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.cases OWNER TO zahori;\nGRANT ALL ON TABLE public.cases TO zahori;\n\n\n--
    public.cases_tags definition\n\n-- Drop table\n\n-- DROP TABLE public.cases_tags;\n\nCREATE
    TABLE public.cases_tags (\n    case_id int8 NOT NULL,\n    tag_id int8 NOT NULL,\n
    \   CONSTRAINT cases_tags_pk PRIMARY KEY (case_id, tag_id),\n    CONSTRAINT rel_cases_tags_fk
    FOREIGN KEY (case_id) REFERENCES cases(case_id),\n    CONSTRAINT rel_cases_tags_tags_fk
    FOREIGN KEY (tag_id) REFERENCES client_tags(tag_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.cases_tags OWNER TO zahori;\nGRANT ALL ON TABLE public.cases_tags TO
    zahori;\n\n\n-- public.client_plat_brow_versions definition\n\n-- Drop table\n\n--
    DROP TABLE public.client_plat_brow_versions;\n\nCREATE TABLE public.client_plat_brow_versions
    (\n    client_id int8 NOT NULL,\n    platform_name varchar NOT NULL,\n    browser_name
    varchar NOT NULL,\n    browser_version varchar NOT NULL,\n    CONSTRAINT rel_cli_plat_brow_versions_pkey
    PRIMARY KEY (client_id, browser_version, browser_name),\n    CONSTRAINT rel_cli_fk
    FOREIGN KEY (client_id) REFERENCES clients(client_id),\n    CONSTRAINT rel_plat_brow_versions_fk
    FOREIGN KEY (platform_name, browser_name, browser_version) REFERENCES platform_browsers_versions(platform_name,
    browser_name, browser_version)\n);\n\n-- Permissions\n\nALTER TABLE public.client_plat_brow_versions
    OWNER TO zahori;\nGRANT ALL ON TABLE public.client_plat_brow_versions TO zahori;\n\n\n--
    public.client_teams_users definition\n\n-- Drop table\n\n-- DROP TABLE public.client_teams_users;\n\nCREATE
    TABLE public.client_teams_users (\n    client_id int8 NOT NULL,\n    team_id int8
    NOT NULL,\n    user_id int8 NOT NULL,\n    CONSTRAINT rel_teams_users_pkey PRIMARY
    KEY (client_id, team_id),\n    CONSTRAINT rel_teams_users_fk FOREIGN KEY (client_id,
    team_id) REFERENCES client_teams(client_id, team_id),\n    CONSTRAINT rel_users_fk
    FOREIGN KEY (user_id) REFERENCES users(user_id)\n);\n\n-- Permissions\n\nALTER TABLE
    public.client_teams_users OWNER TO zahori;\nGRANT ALL ON TABLE public.client_teams_users
    TO zahori;\n\n\n-- public.configurations definition\n\n-- Drop table\n\n-- DROP
    TABLE public.configurations;\n\nCREATE TABLE public.configurations (\n    configuration_id
    serial NOT NULL,\n    \"name\" varchar NOT NULL,\n    process_id int8 NOT NULL,\n
    \   retry_id int8 NOT NULL,\n    timeout_id int8 NOT NULL,\n    environment_id int8
    NOT NULL,\n    upload_results bool NOT NULL DEFAULT false,\n    evi_case_id int8
    NOT NULL,\n    active bool NOT NULL DEFAULT true,\n    CONSTRAINT configurations_pk
    PRIMARY KEY (configuration_id),\n    CONSTRAINT configurations_fk FOREIGN KEY (process_id)
    REFERENCES processes(process_id),\n    CONSTRAINT environments_fk FOREIGN KEY (environment_id)
    REFERENCES client_environments(environment_id),\n    CONSTRAINT evidence_cases_fk
    FOREIGN KEY (evi_case_id) REFERENCES evidence_cases(evi_case_id),\n    CONSTRAINT
    retries_fk FOREIGN KEY (retry_id) REFERENCES retries(retry_id),\n    CONSTRAINT
    configurations_timeouts_fk FOREIGN KEY (timeout_id) REFERENCES timeouts(timeout_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.configurations OWNER TO zahori;\nGRANT ALL ON
    TABLE public.configurations TO zahori;\n\n\n-- public.configurations_evidence_types
    definition\n\n-- Drop table\n\n-- DROP TABLE public.configurations_evidence_types;\n\nCREATE
    TABLE public.configurations_evidence_types (\n    configuration_id int8 NOT NULL,\n
    \   evi_type_id int8 NOT NULL,\n    CONSTRAINT configurations_evidence_types_pk
    PRIMARY KEY (configuration_id, evi_type_id),\n    CONSTRAINT configurations_fk FOREIGN
    KEY (configuration_id) REFERENCES configurations(configuration_id),\n    CONSTRAINT
    evidence_types_fk FOREIGN KEY (evi_type_id) REFERENCES evidence_types(evi_type_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.configurations_evidence_types OWNER TO zahori;\nGRANT
    ALL ON TABLE public.configurations_evidence_types TO zahori;\n\n\n-- public.configurations_test_repositories
    definition\n\n-- Drop table\n\n-- DROP TABLE public.configurations_test_repositories;\n\nCREATE
    TABLE public.configurations_test_repositories (\n    configuration_id int8 NOT NULL,\n
    \   test_repo_id int8 NOT NULL,\n    CONSTRAINT configurations_test_repositories_pk
    PRIMARY KEY (configuration_id, test_repo_id),\n    CONSTRAINT configurations_fk
    FOREIGN KEY (configuration_id) REFERENCES configurations(configuration_id),\n    CONSTRAINT
    test_repositories_fk FOREIGN KEY (test_repo_id) REFERENCES test_repositories(test_repo_id)\n);\n\n--
    Permissions\n\nALTER TABLE public.configurations_test_repositories OWNER TO zahori;\nGRANT
    ALL ON TABLE public.configurations_test_repositories TO zahori;\n\n\n-- public.executions
    definition\n\n-- Drop table\n\n-- DROP TABLE public.executions;\n\nCREATE TABLE
    public.executions (\n    execution_id serial NOT NULL,\n    process_id int8 NOT
    NULL,\n    \"name\" varchar NOT NULL,\n    status varchar NULL,\n    total_passed
    int4 NOT NULL DEFAULT 0,\n    total_failed int4 NOT NULL DEFAULT 0,\n    duration_seconds
    int4 NULL DEFAULT 0,\n    \"date\" varchar NULL,\n    configuration_id int8 NOT
    NULL,\n    periodic_execution_id int8 NULL,\n    user_id int8 NULL,\n    jenkins_build
    varchar NULL,\n    CONSTRAINT executions_pk PRIMARY KEY (execution_id),\n    CONSTRAINT
    rel_configurations_executions_fk FOREIGN KEY (configuration_id) REFERENCES configurations(configuration_id),\n
    \   CONSTRAINT rel_executions_fk FOREIGN KEY (user_id) REFERENCES users(user_id),\n
    \   CONSTRAINT rel_periodic_executions_executions_fk FOREIGN KEY (periodic_execution_id)
    REFERENCES periodic_executions(periodic_execution_id),\n    CONSTRAINT rel_processes_executions_fk
    FOREIGN KEY (process_id) REFERENCES processes(process_id)\n);\n\n-- Permissions\n\nALTER
    TABLE public.executions OWNER TO zahori;\nGRANT ALL ON TABLE public.executions TO
    zahori;\n\n\n-- public.cases_executions definition\n\n-- Drop table\n\n-- DROP TABLE
    public.cases_executions;\n\nCREATE TABLE public.cases_executions (\n    case_execution_id
    serial NOT NULL,\n    case_id int8 NOT NULL,\n    execution_id int8 NOT NULL,\n
    \   browser_name varchar NOT NULL,\n    status varchar NULL,\n    \"date\" varchar
    NULL,\n    notes varchar NULL,\n    steps varchar NULL,\n    log varchar NULL,\n
    \   video varchar NULL,\n    doc varchar NULL,\n    har varchar NULL,\n    duration_seconds
    int4 NULL,\n    selenoid_id varchar NULL,\n    screen_resolution varchar NULL,\n
    \   browser_version varchar NULL,\n    CONSTRAINT cases_executions_pk PRIMARY KEY
    (case_execution_id),\n    CONSTRAINT cases_executions_unique UNIQUE (case_id, execution_id,
    browser_name),\n    CONSTRAINT rel_browsers_fk FOREIGN KEY (browser_name) REFERENCES
    browsers(browser_name),\n    CONSTRAINT rel_cases_fk FOREIGN KEY (case_id) REFERENCES
    cases(case_id),\n    CONSTRAINT rel_executions_fk FOREIGN KEY (execution_id) REFERENCES
    executions(execution_id)\n);\n\n-- Permissions\n\nALTER TABLE public.cases_executions
    OWNER TO zahori;\nGRANT ALL ON TABLE public.cases_executions TO zahori;\n\n\n\n\n\n"
  V0.1.0.2__init_data.sql: |+
    INSERT INTO public.clients ("name", logo, css, num_parallel, active) VALUES('Company name', 'company-logo.png', NULL, 1, true);
  
    INSERT INTO public.accounts (client_id, username, "password", enabled, credentialsexpired, expired, "locked") VALUES(1, 'zahori', '$2a$10$wD4rGH7qCj/sCR1VyfG/8uagQF0YkHfPThiBTN7MdmLzLlTA2nr3.', true, false, false, false);
  
    INSERT INTO public.roles (code, "label") VALUES('ADMIN', 'rol admin');
  
    INSERT INTO public.accounts_roles (account_id, role_id) VALUES(1, 1);
  
    INSERT INTO public.processes_types ("name", "order", active) VALUES('BROWSER', 1, true);
    INSERT INTO public.processes_types ("name", "order", active) VALUES('SERVICE', 2, true);
  
    INSERT INTO public.languages ("name", "order", active) VALUES('Español', 1, true);
    INSERT INTO public.languages ("name", "order", active) VALUES('Inglés', 2, true);
  
    INSERT INTO public.client_languages (client_id, lang_id) VALUES(1, 1);
  
    INSERT INTO public.authentication_types ("name", "default", "order", active) VALUES('Estandar', 1, 1, true);
    INSERT INTO public.authentication_types ("name", "default", "order", active) VALUES('Directorio Activo', 0, 2, true);
  
    INSERT INTO public.users ("name", surnames, email, authentication, "password", "admin", active, lang_id, credentialsexpired, expired, "locked") VALUES('zahori', 'bot', 'info@zahori.io', 1, '$2a$10$wD4rGH7qCj/sCR1VyfG/8uagQF0YkHfPThiBTN7MdmLzLlTA2nr3.', true, 1, 1, false, false, false);
  
    INSERT INTO public.client_teams (client_id, team_id, "name", "admin", favorite) VALUES(1, 1, 'Desarrollo', false, true);
  
    INSERT INTO public.client_teams_users (client_id, team_id, user_id) VALUES(1, 1, 1);
  
    INSERT INTO public.processes ("name", client_id, team_id, proc_type_id, jenkins_token, jenkins_job, jenkins_job_parameter_name) VALUES('Search Wikipedia', 1, 1, 1, '', '', '');
  
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('chrome', 'chrome.webp', '86.0', 1, true);
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('firefox', 'firefox.webp', '81.0', 2, true);
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('edge', 'edge.webp', '88.0', 4, true);
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('safari', 'safari.webp', '13.0', 3, true);
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('opera', NULL, '71.0', 5, true);
    INSERT INTO public.browsers (browser_name, icon, default_version, "order", active) VALUES('NULLBROWSER', NULL, NULL, 6, false);
  
    INSERT INTO public.cases ("name", process_id, active, "data") VALUES('Search RPA', 1, true, '{"Search": "Robotic process automation","Language": "English"}');
    INSERT INTO public.cases ("name", process_id, active, "data") VALUES('Search test automation', 1, true, '{"Search": "Test automation","Language": "English"}');
    INSERT INTO public.cases ("name", process_id, active, "data") VALUES('Search viajes extraordinarios', 1, true, '{"Search": "Viajes extraordinarios","Language": "Español"}');
    INSERT INTO public.cases ("name", process_id, active, "data") VALUES('Search gastronomía España', 1, true, '{"Search": "Gastronomía de España","Language": "Español"}');
  
    INSERT INTO public.client_environments (client_id, process_id, "name", url, "order", active) VALUES(1, 1, 'preproducción', 'https://pre.url', 1, true);
    INSERT INTO public.client_environments (client_id, process_id, "name", url, "order", active) VALUES(1, 1, 'producción', 'https://pro.url', 2, true);
  
    INSERT INTO public.evidence_cases ("name", "order", active) VALUES('Nunca', 1, true);
    INSERT INTO public.evidence_cases ("name", "order", active) VALUES('Sólo si el proceso falla o tiene alertas', 2, true);
    INSERT INTO public.evidence_cases ("name", "order", active) VALUES('Sólo si el proceso falla', 3, true);
    INSERT INTO public.evidence_cases ("name", "order", active) VALUES('Sólo si el proceso tiene alertas', 4, true);
  
    INSERT INTO public.client_evidence_cases (client_id, evi_case_id) VALUES(1, 1);
    INSERT INTO public.client_evidence_cases (client_id, evi_case_id) VALUES(1, 2);
    INSERT INTO public.client_evidence_cases (client_id, evi_case_id) VALUES(1, 3);
  
    INSERT INTO public.evidence_types ("name", "order", active) VALUES('Log', 1, true);
    INSERT INTO public.evidence_types ("name", "order", active) VALUES('Screenshot', 2, true);
    INSERT INTO public.evidence_types ("name", "order", active) VALUES('Video', 3, true);
    INSERT INTO public.evidence_types ("name", "order", active) VALUES('Doc', 4, true);
    INSERT INTO public.evidence_types ("name", "order", active) VALUES('Har', 5, true);
  
    INSERT INTO public.client_evidence_types (client_id, evi_type_id) VALUES(1, 1);
    INSERT INTO public.client_evidence_types (client_id, evi_type_id) VALUES(1, 2);
    INSERT INTO public.client_evidence_types (client_id, evi_type_id) VALUES(1, 3);
    INSERT INTO public.client_evidence_types (client_id, evi_type_id) VALUES(1, 4);
    INSERT INTO public.client_evidence_types (client_id, evi_type_id) VALUES(1, 5);
  
    INSERT INTO public.retries (retry_id, active) VALUES(0, true);
    INSERT INTO public.retries (retry_id, active) VALUES(1, true);
    INSERT INTO public.retries (retry_id, active) VALUES(2, true);
    INSERT INTO public.retries (retry_id, active) VALUES(3, true);
  
    INSERT INTO public.client_retries (client_id, retry_id) VALUES(1, 0);
    INSERT INTO public.client_retries (client_id, retry_id) VALUES(1, 1);
    INSERT INTO public.client_retries (client_id, retry_id) VALUES(1, 2);
  
    INSERT INTO public.client_tags (client_id, process_id, "name", "color", "order", active) VALUES(1, 1, 'Tag 1', '#00ffff',1, true);
    INSERT INTO public.client_tags (client_id, process_id, "name", "color", "order", active) VALUES(1, 1, 'Tag 2','#ffaa00', 2, true);
  
    INSERT INTO public.cases_tags (case_id, tag_id) VALUES(3, 1);
    INSERT INTO public.cases_tags (case_id, tag_id) VALUES(4, 1);
    INSERT INTO public.cases_tags (case_id, tag_id) VALUES(4, 2);
  
    INSERT INTO public.test_repositories ("name", "order", active) VALUES('Xray Server', 1, true);
    INSERT INTO public.test_repositories ("name", "order", active) VALUES('Xray Cloud', 2, true);
    INSERT INTO public.test_repositories ("name", "order", active) VALUES('Azure Test Plans', 3, true);
    INSERT INTO public.test_repositories ("name", "order", active) VALUES('Hp Alm', 4, true);
    INSERT INTO public.test_repositories ("name", "order", active) VALUES('Testlink', 5, true);
  
    INSERT INTO public.client_test_repos (client_id, test_repo_id, url, "user", "password") VALUES(1, 2, 'https://your-company.atlassian.net/', 'my-user', 'my-pass');
    INSERT INTO public.client_test_repos (client_id, test_repo_id, url, "user", "password") VALUES(1, 5, 'https://testlink.your-company.com', 'my-pass', 'my-pass');
  
    INSERT INTO public.timeouts (timeout_id, active) VALUES(5, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(10, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(20, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(30, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(40, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(50, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(60, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(90, true);
    INSERT INTO public.timeouts (timeout_id, active) VALUES(120, true);
  
    INSERT INTO public.client_timeouts (client_id, timeout_id) VALUES(1, 120);
  
    INSERT INTO public.configurations ("name", process_id, retry_id, timeout_id, environment_id, upload_results, evi_case_id, active) VALUES('Config example', 1, 0, 5, 2, false, 1, true);
  
    INSERT INTO public.configurations_test_repositories (configuration_id, test_repo_id) VALUES(1, 5);
  
    INSERT INTO public.configurations_evidence_types (configuration_id, evi_type_id) VALUES(1, 1);
    INSERT INTO public.configurations_evidence_types (configuration_id, evi_type_id) VALUES(1, 2);
    INSERT INTO public.configurations_evidence_types (configuration_id, evi_type_id) VALUES(1, 3);
    INSERT INTO public.configurations_evidence_types (configuration_id, evi_type_id) VALUES(1, 4);
  
    INSERT INTO public.customerconfig ("name") VALUES('config 1');
  
    INSERT INTO public.customer ("name", customerconfig_id) VALUES('Cliente 1', 1);
  
    INSERT INTO public.platforms (platform_name, "order", active) VALUES('desktop', 1, true);
    INSERT INTO public.platforms (platform_name, "order", active) VALUES('mobile', 2, true);
  
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('desktop', 'chrome', 'latest');
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('desktop', 'firefox', '81.0');
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('desktop', 'chrome', ' 86.0');
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('desktop', 'edge', 'latest');
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('mobile', 'chrome', 'latest');
    INSERT INTO public.platform_browsers_versions (platform_name, browser_name, browser_version) VALUES('mobile', 'chrome', ' 86.0');
  
  
  V0.1.1.1__schema.sql: |+
    DROP TABLE public.configurations_test_repositories;
  
    ALTER TABLE public.configurations ADD test_repo_id int8 NULL;
    ALTER TABLE public.configurations ADD CONSTRAINT test_repositories_fk FOREIGN KEY (test_repo_id) REFERENCES public.test_repositories(test_repo_id);
  
    ALTER TABLE public.client_test_repos ADD active bool NOT NULL DEFAULT true;
  
  V0.1.1.2__data.sql: |
    UPDATE public.client_environments SET url = 'https://wikipedia.org' WHERE environment_id = 1;
    UPDATE public.client_environments SET url = 'https://wikipedia.org' WHERE environment_id = 2;
  
    UPDATE public.evidence_types SET name = 'HAR' WHERE evi_type_id = 5;
  
    UPDATE public.configurations SET timeout_id = 20 WHERE process_id = 1;
  
    DELETE FROM public.configurations_evidence_types WHERE configuration_id = 1 AND evi_type_id = 3;
    DELETE FROM public.configurations_evidence_types WHERE configuration_id = 1 AND evi_type_id = 4;
  
    UPDATE public.evidence_cases SET name = 'Sí' WHERE evi_case_id = 1;
    UPDATE public.evidence_cases SET name = 'No' WHERE evi_case_id = 2;
    UPDATE public.evidence_cases SET name = 'Sólo si el caso falla' WHERE evi_case_id = 3;
    DELETE FROM public.evidence_cases WHERE evi_case_id = 4;
  V0.1.1.3__update_browser_versions.sql: |+
    UPDATE public.browsers SET default_version = '91.0' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '90.0' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '91.0' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '14.0' WHERE browser_name = 'safari';
    UPDATE public.browsers SET default_version = '77.0' WHERE browser_name = 'opera';
  
  V0.1.1.4__case_executions_attachments.sql: "CREATE TABLE public.cases_executions_attachments
    (\n    attachment_id serial NOT NULL,\n\t\"path\" varchar NULL,\n\tcase_execution_id
    int8 NOT NULL,\n\tCONSTRAINT attachments_pk PRIMARY KEY (attachment_id),\n\tCONSTRAINT
    attachments_fk FOREIGN KEY (case_execution_id) REFERENCES public.cases_executions(case_execution_id)\n);\n\n--
    Permissions\nALTER TABLE public.cases_executions_attachments OWNER TO zahori;\nGRANT
    ALL ON TABLE public.cases_executions_attachments TO zahori;\n\n"
  V0.1.1.5__screen_resolutions.sql: "CREATE TABLE public.resolutions (\n    resolution_id
    serial NOT NULL,\n    client_id int8 NOT NULL,\n\tprocess_id int8 NOT NULL,\n    width
    int4 NOT NULL,\n    height int4 NOT NULL,\n    \"order\" int8 NOT NULL,\n    active
    bool NOT NULL DEFAULT true,\n    CONSTRAINT resolutions_pk PRIMARY KEY (resolution_id),\n
    \   CONSTRAINT resolutions_fk FOREIGN KEY (client_id) REFERENCES clients(client_id),\n\tCONSTRAINT
    resolutions_processes_fk FOREIGN KEY (process_id) REFERENCES processes(process_id)\n);\n\n--
    Permissions\nALTER TABLE public.resolutions OWNER TO ${zahori_db_user};\nGRANT ALL
    ON TABLE public.resolutions TO ${zahori_db_user};\n\n\nALTER TABLE public.cases_executions
    DROP CONSTRAINT cases_executions_unique;\nALTER TABLE public.cases_executions ADD
    CONSTRAINT cases_executions_unique UNIQUE (case_id, execution_id, browser_name,
    screen_resolution);\n\n"
  V0.1.1.6__update_browser_versions.sql: |+
    UPDATE public.browsers SET default_version = '97.0' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '96.0' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '97.0' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '15.0' WHERE browser_name = 'safari';
    UPDATE public.browsers SET default_version = '82.0' WHERE browser_name = 'opera';
  
  V0.1.1.7__update_browser_versions.sql: |+
    UPDATE public.browsers SET default_version = '99.0' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '98.0' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '99.0' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '15.0' WHERE browser_name = 'safari';
    UPDATE public.browsers SET default_version = '85.0' WHERE browser_name = 'opera';
  
  V0.1.14.sql: |2+
  
    ---------------- ADD XRAY SUPPORT ----------------
  
    -- Add field tmsExecutionId to executions
    ALTER TABLE public.executions ADD tms_test_execution_id varchar NULL;
  
    -- Remove duplicated XRAY test repository
    DELETE FROM public.test_repositories WHERE test_repo_id = 1;
    UPDATE public.test_repositories SET name = 'Jira Xray' WHERE test_repo_id = 2;
    UPDATE public.test_repositories SET name = 'TestLink' WHERE name = 'Testlink';
  
  
    ---------------- UPDATE BROWSER VERSIONS ----------------
    UPDATE public.browsers SET default_version = '105.0' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '105.0' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '104.0' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '90.0' WHERE browser_name = 'opera';
    UPDATE public.browsers SET default_version = '15.0' WHERE browser_name = 'safari';
  
  
    ---------------- ADD SCREEN RESOLUTION NAMES ----------------
    ALTER TABLE public.resolutions ADD name varchar NULL;
  
    -- Add default data to resolutions table
    INSERT INTO public.resolutions(client_id, process_id, width, height, "order", active, "name")
    VALUES(1, 1, 1920, 1080, 0, true, 'Full HD');
  
    INSERT INTO public.resolutions(client_id, process_id, width, height, "order", active, "name")
    VALUES(1, 1, 1280, 720, 0, true, 'HD');
  
    INSERT INTO public.resolutions(client_id, process_id, width, height, "order", active, "name")
    VALUES(1, 1, 810, 1080, 0, true, 'iPad');
  
  
  V0.1.15.sql: |2
  
    ---------------- UPDATE BROWSER VERSIONS ----------------
    UPDATE public.browsers SET default_version = '108.0' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '108.0' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '108.0' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '94.0' WHERE browser_name = 'opera';
    UPDATE public.browsers SET default_version = '15.0' WHERE browser_name = 'safari';
  V0.1.15_k8s.sql: |2
  
    ---------------- UPDATE BROWSER VERSIONS ----------------
    UPDATE public.browsers SET default_version = '109.0.5414.119-3' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '109.0.1518.70-3' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '109.0.1518.70-3' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '94.0.4606.76-4' WHERE browser_name = 'opera';
    UPDATE public.browsers SET default_version = '15.0-0' WHERE browser_name = 'safari';
  V0.1.16.sql: |2-
  
    ---------------- UPDATE BROWSER VERSIONS ----------------
    UPDATE public.browsers SET default_version = '110.0.5481.177-3' WHERE browser_name = 'chrome';
    UPDATE public.browsers SET default_version = '110.0.1587.57-3' WHERE browser_name = 'edge';
    UPDATE public.browsers SET default_version = '110.0.1-3' WHERE browser_name = 'firefox';
    UPDATE public.browsers SET default_version = '96.0.4693.20-4' WHERE browser_name = 'opera';
    UPDATE public.browsers SET default_version = '15.0-0' WHERE browser_name = 'safari';
  V0.1.17.sql: |-
    ---------------- PERIODIC EXECUTIONS ----------------
    ALTER TABLE public.periodic_executions ALTER COLUMN "time" TYPE varchar USING "time"::varchar;
    ALTER TABLE public.periodic_executions ALTER COLUMN days TYPE text[] USING days::text[];
    ALTER TABLE public.periodic_executions ADD uuid uuid NOT NULL;
    ALTER TABLE public.periodic_executions ADD execution_id int4 NULL;
    ALTER TABLE public.periodic_executions ADD CONSTRAINT rel_periodic_executions_executions_fk FOREIGN KEY (execution_id) REFERENCES public.executions(execution_id);
  
    ---------------- EXECUTIONS ----------------
    ALTER TABLE public.executions ADD "trigger" varchar NULL;
    UPDATE public.executions SET trigger = 'Manual';
    ALTER TABLE public.executions DROP CONSTRAINT rel_periodic_executions_executions_fk;
    ALTER TABLE public.executions DROP COLUMN periodic_execution_id;
---
# Source: zahori-server/templates/configmaps.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: zahori-server
  name: zahori-server-config
  namespace: zahori
data:
  ZAHORI_CONSUL_PORT: "80"
  ZAHORI_DB_NAME: "zahori"
  ZAHORI_DB_PORT: "5432"
  ZAHORI_DB_SCHEMA: "public"
  ZAHORI_DB_USER: "zahori"
  ZAHORI_SELENOID_PORT: "4444"
  ZAHORI_SELENOID_UI_EXTERNAL_HOST: "http://moon.test"
  ZAHORI_SELENOID_UI_EXTERNAL_PORT: "80"
  ZAHORI_SELENOID_UI_INTERNAL_PORT: "8080"
  ZAHORI_SERVER_PORT: "9090"
---
# Source: zahori-server/templates/persistentvolumeclaim.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    app: zahori-server
  name: zahori-server-claim
  namespace: zahori
  annotations:
    {}  
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
  storageClassName: local-path
---
# Source: zahori-server/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: zahori-server
  name: zahori-server-service
  namespace: zahori
  annotations:
    {}
spec:
  type: ClusterIP
  ports:
  - name: portServer
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app: zahori-server
---
# Source: zahori-server/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: zahori-server
  name: zahori-server-deployment
  namespace: zahori
spec:
  replicas: 1
  selector:
    matchLabels:
      app: zahori-server
  strategy: {}
  template:
    metadata:
      annotations:
        {}    
      labels:
        app: zahori-server
    spec:
      containers:
      - env:
        - name: ZAHORI_DB_HOST
          value: zahori-postgresql-service
        - name: ZAHORI_CONSUL_HOST
          value: consul-ui
        - name: ZAHORI_SELENOID_UI_INTERNAL_HOST
          value: moon.moon.svc.cluster.local
        - name: ZAHORI_DB_PASS
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: zahori-server-secret
        envFrom:
        - configMapRef:
            name: zahori-server-config
        image: zahoriaut/zahori-server:0.1.17
        imagePullPolicy: IfNotPresent
        lifecycle:
          preStop:
            exec:
              command:
              - sh
              - -c
              - sleep 10
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /zahori/actuator/health/liveness
            port: 9090
            scheme: HTTP
          initialDelaySeconds: 120
          successThreshold: 1
        name: zahori
        ports:
        - containerPort: 9090
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /zahori/actuator/health/readiness
            port: 9090
            scheme: HTTP
          initialDelaySeconds: 20
          successThreshold: 1
        resources:
          limits:
            cpu: 1000m
            memory: 500Mi
          requests:
            cpu: 300m
            memory: 256Mi
        volumeMounts:
        - mountPath: /usr/app/evidences
          name: zahori-data
      initContainers:
      - command:
        - flyway
        - migrate
        env:
        - name: FLYWAY_URL
          value: jdbc:postgresql://zahori-postgresql-service:5432/zahori
        - name: FLYWAY_USER
          valueFrom:
            configMapKeyRef:
              key: ZAHORI_DB_USER
              name: zahori-server-config
        - name: FLYWAY_PASSWORD
          valueFrom:
            secretKeyRef:
              key: POSTGRES_PASSWORD
              name: zahori-server-secret
        - name: FLYWAY_PLACEHOLDER_REPLACEMENT
          value: "true"
        - name: FLYWAY_PLACEHOLDERS_ZAHORI_DB_USER
          valueFrom:
            configMapKeyRef:
              key: ZAHORI_DB_USER
              name:  zahori-server-config
        image: "flyway/flyway:9.14.1-alpine"
        name: flyway
        volumeMounts:
        - mountPath: /flyway/sql
          name: postgres-initdb
      volumes:
      - name: zahori-data
        persistentVolumeClaim:
          claimName: zahori-server-claim
      - configMap:
          name: zahori-server-scripts
        name: postgres-initdb
status: {}
---
# Source: zahori-server/templates/traefik.yaml
apiVersion: traefik.containo.us/v1alpha1
kind: IngressRoute
metadata:
  name: zahori-server-traefik
  namespace: zahori
  annotations:
    {}  
spec:
  entryPoints:
  - web
  routes:
      - match: Host(`server.test`) && PathPrefix(`/zahori`)
        kind: Rule
        services:
          - name: zahori-server-service
            port: 9090
